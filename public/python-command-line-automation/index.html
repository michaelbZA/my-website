<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Part 9: Command-Line Tools & Automation with Python | Michael Brunger</title>
<meta name=keywords content="python,cli,argparse,automation,pyautogui,os,shutil,scripting"><meta name=description content="Build command-line interfaces with argparse, create installable CLI tools, automate file operations, control GUI applications, and develop practical automation projects."><meta name=author content="Michael Brunger"><link rel=canonical href=http://localhost:1313/python-command-line-automation/><link crossorigin=anonymous href=http://localhost:1313/assets/css/stylesheet.c4cc1e21a445bb0fda61df68a1d9b952b1dcb9bd38d5ca41d3ba642d5b5c1607.css integrity="sha256-xMweIaRFuw/aYd9oodm5UrHcub041cpB07pkLVtcFgc=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/python-command-line-automation/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=text/javascript src='https://app.cookieyes.com/mAsBCNFb37oPK_4XJgj7kpxbljvjKgiPcLeSeiRyslQSWcJQA0P7w_nb-e_NfuwZCdsSDi_gh_1zVLQNUSNV8A=='></script><script id=cookieyes type=text/javascript src=https://cdn-cookieyes.com/client_data/8dbaf9037ea60d809e6f1613/script.js></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Orbitron:wght@400..900&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-XJJLP6S9JL" data-cookieyes=cookieyes-analytics></script><script data-cookieyes=cookieyes-analytics>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XJJLP6S9JL")</script><script src=http://localhost:1313/js/extended/back-to-top.min.js defer></script><script src=http://localhost:1313/js/extended/sticky-header.min.js defer></script><script src=http://localhost:1313/js/extended/menu-trigger.min.js defer></script><meta property="og:url" content="http://localhost:1313/python-command-line-automation/"><meta property="og:site_name" content="Michael Brunger"><meta property="og:title" content="Part 9: Command-Line Tools & Automation with Python"><meta property="og:description" content="Build command-line interfaces with argparse, create installable CLI tools, automate file operations, control GUI applications, and develop practical automation projects."><meta property="og:locale" content="en-GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-09T14:44:55+01:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Cli"><meta property="article:tag" content="Argparse"><meta property="article:tag" content="Automation"><meta property="article:tag" content="Pyautogui"><meta property="article:tag" content="Os"><meta property="og:image" content="http://localhost:1313/site-feature-image.jpg"><meta property="og:see_also" content="http://localhost:1313/python-next-steps-advanced-topics/"><meta property="og:see_also" content="http://localhost:1313/simple-gui-applications-tkinter/"><meta property="og:see_also" content="http://localhost:1313/python-web-development-foundations/"><meta property="og:see_also" content="http://localhost:1313/introduction-object-oriented-programming-python/"><meta property="og:see_also" content="http://localhost:1313/python-data-visualisation-basics/"><meta property="og:see_also" content="http://localhost:1313/data-analysis-with-pandas/"><meta property="og:see_also" content="http://localhost:1313/numpy-fundamentals-numerical-data/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/site-feature-image.jpg"><meta name=twitter:title content="Part 9: Command-Line Tools & Automation with Python"><meta name=twitter:description content="Build command-line interfaces with argparse, create installable CLI tools, automate file operations, control GUI applications, and develop practical automation projects."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Python Series","item":"http://localhost:1313/posts/python-series/"},{"@type":"ListItem","position":3,"name":"Part 9: Command-Line Tools \u0026 Automation with Python","item":"http://localhost:1313/python-command-line-automation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Part 9: Command-Line Tools \u0026 Automation with Python","name":"Part 9: Command-Line Tools \u0026 Automation with Python","description":"Build command-line interfaces with argparse, create installable CLI tools, automate file operations, control GUI applications, and develop practical automation projects.","keywords":["python","cli","argparse","automation","pyautogui","os","shutil","scripting"],"articleBody":"Command-Line Tools \u0026 Automation in Python As a finance professional learning to code, I’ve discovered that some of the most practical Python applications aren’t fancy data visualizations or machine learning models, but rather simple automation scripts that save time on repetitive tasks. In this post, I’ll walk through how to build command-line tools and automate everyday processes using Python.\nBuilding Command-Line Scripts with argparse When you’re working with financial data, you often need flexible tools that can handle different inputs. The argparse module lets you build command-line scripts that accept various arguments and options.\nBasic argparse Structure First, let’s create a simple script that calculates compound interest:\nimport argparse def calculate_compound_interest(principal, rate, time, compounds_per_year=1): \"\"\"Calculate compound interest. Args: principal: Initial investment amount rate: Annual interest rate (decimal) time: Time in years compounds_per_year: Number of times interest compounds per year Returns: Final amount after compound interest \"\"\" return principal * (1 + rate/compounds_per_year)**(compounds_per_year*time) def main(): # Create argument parser parser = argparse.ArgumentParser(description='Calculate compound interest') # Add arguments parser.add_argument('principal', type=float, help='Initial investment amount') parser.add_argument('rate', type=float, help='Annual interest rate (decimal)') parser.add_argument('time', type=float, help='Time in years') parser.add_argument('--compounds', type=int, default=1, help='Number of times interest compounds per year (default: 1)') # Parse arguments args = parser.parse_args() # Calculate result result = calculate_compound_interest( args.principal, args.rate, args.time, args.compounds ) # Print result print(f\"Initial principal: ${args.principal:.2f}\") print(f\"Annual rate: {args.rate:.2%}\") print(f\"Time: {args.time} years\") print(f\"Compounds per year: {args.compounds}\") print(f\"Final amount: ${result:.2f}\") print(f\"Interest earned: ${result - args.principal:.2f}\") if __name__ == \"__main__\": main() Save this script as compound_interest.py and run it from the command line:\npython compound_interest.py 10000 0.05 5 --compounds 12 This would calculate the compound interest on $10,000 at 5% annual interest for 5 years, compounded monthly.\nUnderstanding argparse Components Let’s break down what’s happening in our script:\nWe create an ArgumentParser object with a description We add arguments with add_argument(): Positional arguments (principal, rate, time) are required Optional arguments (like --compounds) start with -- and have default values We parse the command-line arguments with parse_args() We access the values via args.parameter_name Adding Help Text One of the best features of argparse is automatic help text generation. Users can run your script with -h or --help to see instructions:\npython compound_interest.py --help Which produces:\nusage: compound_interest.py [-h] [--compounds COMPOUNDS] principal rate time\rCalculate compound interest\rpositional arguments:\rprincipal Initial investment amount\rrate Annual interest rate (decimal)\rtime Time in years\roptional arguments:\r-h, --help show this help message and exit\r--compounds COMPOUNDS Number of times interest compounds per year (default: 1) More argparse Features For financial applications, you might want to add more sophisticated options:\nparser.add_argument('--currency', default='$', help='Currency symbol to display') parser.add_argument('--output-file', help='Save results to a file') parser.add_argument('--verbose', '-v', action='store_true', help='Display additional information') The action='store_true' creates a flag that’s either True or False depending on whether it’s included.\nPackaging Entry Points for Installable Commands If you find yourself using the same script frequently, you can package it so it’s available as a system-wide command.\nCreating a Package Structure First, organize your files like this:\nfinance_tools/\r├── finance_tools/\r│ ├── __init__.py\r│ ├── compound_interest.py\r│ └── other_modules.py\r├── README.md\r└── pyproject.toml Setting Up pyproject.toml Create a pyproject.toml file:\n[build-system] requires = [\"setuptools\u003e=42\", \"wheel\"] build-backend = \"setuptools.build_meta\" [project] name = \"finance_tools\" version = \"0.1.0\" description = \"Financial calculation tools\" readme = \"README.md\" authors = [{name = \"Your Name\", email = \"your.email@example.com\"}] license = {text = \"MIT\"} requires-python = \"\u003e=3.6\" [project.scripts] compound-interest = \"finance_tools.compound_interest:main\" The [project.scripts] section is what creates the entry point. After installing this package, you’ll be able to run compound-interest directly from your command line without typing python first.\nInstalling Your Package Install your package in development mode:\npip install -e . Now you can run:\ncompound-interest 10000 0.05 5 --compounds 12 Automating File and Folder Tasks As a finance professional, you probably deal with lots of reports, spreadsheets, and data files. Python can help automate file handling tasks.\nBasic File Operations with os and shutil Here’s a script that organizes financial statements by month and type:\nimport os import shutil import re import argparse from datetime import datetime def organize_financial_statements(source_dir, target_dir): \"\"\"Organize financial statements into folders by month and type. Assumes filenames like: 'Income_Statement_2023-05-15.xlsx' or 'Balance_Sheet_05_15_2023.pdf' \"\"\" # Create target directory if it doesn't exist os.makedirs(target_dir, exist_ok=True) # Regular expressions for date patterns patterns = [ r'(\\d{4})-(\\d{2})-\\d{2}', # YYYY-MM-DD r'(\\d{2})_\\d{2}_(\\d{4})', # MM_DD_YYYY r'(\\d{2})-\\d{2}-(\\d{4})' # MM-DD-YYYY ] # Document types to look for doc_types = ['Income_Statement', 'Balance_Sheet', 'Cash_Flow', 'Trial_Balance'] # Process each file in the source directory for filename in os.listdir(source_dir): file_path = os.path.join(source_dir, filename) # Skip directories if os.path.isdir(file_path): continue # Try to extract date date_found = False for pattern in patterns: match = re.search(pattern, filename) if match: # Extract year and month if len(match.group(1)) == 4: # If first group is year (YYYY-MM-DD) year, month = match.group(1), match.group(2) else: # If first group is month (MM_DD_YYYY) month, year = match.group(1), match.group(2) month_name = datetime.strptime(month, \"%m\").strftime(\"%B\") date_found = True break if not date_found: # If no date pattern found, put in 'Unsorted' year, month_name = 'Unsorted', 'Unsorted' # Try to match document type doc_type = 'Other' for dtype in doc_types: if dtype in filename: doc_type = dtype break # Create year and month folders if they don't exist year_dir = os.path.join(target_dir, year) os.makedirs(year_dir, exist_ok=True) month_dir = os.path.join(year_dir, month_name) os.makedirs(month_dir, exist_ok=True) # Create document type folder if it doesn't exist doc_type_dir = os.path.join(month_dir, doc_type) os.makedirs(doc_type_dir, exist_ok=True) # Copy the file to its destination dest_path = os.path.join(doc_type_dir, filename) shutil.copy2(file_path, dest_path) print(f\"Copied {filename} to {dest_path}\") def main(): parser = argparse.ArgumentParser(description='Organize financial statements by date and type') parser.add_argument('source_dir', help='Directory containing financial statements') parser.add_argument('--target-dir', default='./Organized_Statements', help='Target directory for organized files (default: ./Organized_Statements)') args = parser.parse_args() organize_financial_statements(args.source_dir, args.target_dir) print(\"Financial statement organization complete!\") if __name__ == \"__main__\": main() This script:\nScans a directory for financial documents Extracts dates and document types from filenames Creates an organized folder structure by year, month, and document type Copies files to the appropriate locations Understanding Key File Operations os.path.join(): Combines path components correctly for your operating system os.makedirs(): Creates directories recursively with exist_ok=True to avoid errors os.listdir(): Lists files and directories in a path shutil.copy2(): Copies files while preserving metadata Automating Financial Report Backups Here’s another practical example that creates date-stamped backups of your financial reports:\nimport os import shutil import datetime import argparse import zipfile def backup_financial_reports(reports_dir, backup_dir=None): \"\"\"Create a date-stamped ZIP backup of financial reports.\"\"\" # Set default backup directory if none provided if backup_dir is None: backup_dir = os.path.join(os.path.dirname(reports_dir), 'Backups') # Create backup directory if it doesn't exist os.makedirs(backup_dir, exist_ok=True) # Create timestamp for backup filename timestamp = datetime.datetime.now().strftime('%Y%m%d_%H%M%S') backup_filename = f\"Financial_Reports_Backup_{timestamp}.zip\" backup_path = os.path.join(backup_dir, backup_filename) # Create ZIP file with zipfile.ZipFile(backup_path, 'w', zipfile.ZIP_DEFLATED) as zipf: # Walk through all files in the reports directory for root, _, files in os.walk(reports_dir): for file in files: file_path = os.path.join(root, file) # Calculate path relative to reports_dir for ZIP structure rel_path = os.path.relpath(file_path, reports_dir) zipf.write(file_path, rel_path) print(f\"Added {rel_path} to backup\") print(f\"Backup created at: {backup_path}\") print(f\"Total size: {os.path.getsize(backup_path) / (1024*1024):.2f} MB\") return backup_path def main(): parser = argparse.ArgumentParser(description='Create a backup of financial reports') parser.add_argument('reports_dir', help='Directory containing financial reports') parser.add_argument('--backup-dir', help='Target directory for backups') args = parser.parse_args() backup_financial_reports(args.reports_dir, args.backup_dir) if __name__ == \"__main__\": main() Automating GUI Interactions with PyAutoGUI Sometimes you need to automate interactions with desktop applications that don’t have APIs. For example, maybe you need to extract data from an older accounting system that can only export data through its GUI. PyAutoGUI can help automate these interactions.\nInstalling and Setting Up PyAutoGUI pip install pyautogui Safety Features PyAutoGUI has a fail-safe feature - quickly move your mouse to any corner of the screen to abort the script. This is crucial when you’re testing automation that controls your mouse!\nBasic PyAutoGUI Example Here’s a simple script that could help export a monthly report from a financial application:\nimport pyautogui import time import argparse from datetime import datetime # Safety delay - gives you time to switch to the target application SAFETY_DELAY = 5 def export_monthly_report(year, month): \"\"\"Automate exporting a monthly report from a financial application. Args: year: Year for the report month: Month number (1-12) for the report \"\"\" # Convert month number to name for the filename month_name = datetime.strptime(f\"{month}\", \"%m\").strftime(\"%B\") print(f\"Preparing to export {month_name} {year} report...\") print(f\"Switch to your financial application within {SAFETY_DELAY} seconds!\") time.sleep(SAFETY_DELAY) # Click on 'Reports' menu pyautogui.click(x=100, y=20) # Adjust coordinates based on your application time.sleep(1) # Click on 'Monthly' option pyautogui.click(x=100, y=50) # Adjust coordinates based on your application time.sleep(1) # Fill in date fields pyautogui.typewrite(str(year)) pyautogui.press('tab') pyautogui.typewrite(str(month).zfill(2)) pyautogui.press('tab') # Click 'Generate Report' button pyautogui.click(x=200, y=300) # Adjust coordinates based on your application time.sleep(3) # Wait for report to generate # Save the report pyautogui.hotkey('ctrl', 's') # Press Ctrl+S to save time.sleep(1) # Type the filename filename = f\"Financial_Report_{year}_{month_name}.xlsx\" pyautogui.typewrite(filename) pyautogui.press('enter') time.sleep(2) print(f\"Report exported as {filename}\") def main(): parser = argparse.ArgumentParser(description='Automate monthly report export') parser.add_argument('--year', type=int, default=datetime.now().year, help='Year for the report (default: current year)') parser.add_argument('--month', type=int, default=datetime.now().month - 1 or 12, help='Month for the report (1-12, default: previous month)') args = parser.parse_args() # Validate month if not 1 \u003c= args.month \u003c= 12: print(\"Error: Month must be between 1 and 12\") return export_monthly_report(args.year, args.month) if __name__ == \"__main__\": main() Important note: The coordinates in this script (e.g., pyautogui.click(x=100, y=20)) need to be adjusted for your specific application. Use pyautogui.position() to get the coordinates of your mouse pointer.\nPyAutoGUI Key Functions pyautogui.click(x, y): Move mouse to coordinates and click pyautogui.typewrite('text'): Type text pyautogui.press('key'): Press a single key pyautogui.hotkey('ctrl', 's'): Press multiple keys simultaneously pyautogui.screenshot(): Take a screenshot pyautogui.locateOnScreen('image.png'): Find an image on screen Putting It All Together: Sample Financial Automation Project Let’s build a financial quarter-end automation tool that:\nCreates organized backup of last quarter’s data Generates reports using a GUI application Organizes the reports into the correct folders import os import argparse import time import datetime import pyautogui import shutil import zipfile def get_last_quarter(reference_date=None): \"\"\"Calculate the previous quarter based on a reference date.\"\"\" if reference_date is None: reference_date = datetime.datetime.now() current_month = reference_date.month current_year = reference_date.year # Calculate previous quarter end month (3, 6, 9, or 12) last_quarter_month = ((current_month - 1) // 3) * 3 if last_quarter_month == 0: last_quarter_month = 12 last_quarter_year = current_year - 1 else: last_quarter_year = current_year return last_quarter_year, last_quarter_month def create_backup(data_dir, backup_dir=None): \"\"\"Create a date-stamped ZIP backup.\"\"\" if backup_dir is None: backup_dir = os.path.join(os.path.dirname(data_dir), 'Quarterly_Backups') os.makedirs(backup_dir, exist_ok=True) timestamp = datetime.datetime.now().strftime('%Y%m%d_%H%M%S') backup_filename = f\"Financial_Data_Backup_{timestamp}.zip\" backup_path = os.path.join(backup_dir, backup_filename) with zipfile.ZipFile(backup_path, 'w', zipfile.ZIP_DEFLATED) as zipf: for root, _, files in os.walk(data_dir): for file in files: file_path = os.path.join(root, file) rel_path = os.path.relpath(file_path, data_dir) zipf.write(file_path, rel_path) print(f\"Added {rel_path} to backup\") print(f\"Backup created at: {backup_path}\") return backup_path def generate_quarterly_reports(year, quarter, output_dir): \"\"\"Automate generating quarterly reports using PyAutoGUI.\"\"\" os.makedirs(output_dir, exist_ok=True) # Calculate quarter end month end_month = quarter * 3 # Quarter name for folder organization quarter_name = f\"Q{quarter}_{year}\" print(f\"Preparing to generate {quarter_name} reports...\") print(\"Switch to your financial application within 5 seconds!\") time.sleep(5) # This is a simplified example - you would need to adjust coordinates # and actions based on your specific application # Click on Reports menu pyautogui.click(x=100, y=20) time.sleep(1) # Click on Quarterly Reports pyautogui.click(x=100, y=80) time.sleep(1) # Enter year and quarter pyautogui.typewrite(str(year)) pyautogui.press('tab') pyautogui.typewrite(str(quarter)) pyautogui.press('tab') # Generate reports report_types = [ \"Income_Statement\", \"Balance_Sheet\", \"Cash_Flow\", \"Accounts_Receivable\" ] for report_type in report_types: # Select report type from dropdown pyautogui.press('down', presses=report_types.index(report_type) + 1) pyautogui.press('enter') time.sleep(1) # Click Generate button pyautogui.click(x=200, y=300) time.sleep(3) # Wait for report to generate # Save report pyautogui.hotkey('ctrl', 's') time.sleep(1) # Type filename and save to output directory filename = f\"{report_type}_{quarter_name}.xlsx\" filepath = os.path.join(output_dir, filename) pyautogui.typewrite(filepath) pyautogui.press('enter') time.sleep(2) print(f\"Generated {filename}\") # Return to report selection pyautogui.click(x=150, y=150) time.sleep(1) return output_dir def organize_reports(reports_dir, organized_dir=None): \"\"\"Organize reports into a structured folder system.\"\"\" if organized_dir is None: organized_dir = os.path.join(os.path.dirname(reports_dir), 'Organized_Reports') os.makedirs(organized_dir, exist_ok=True) # Process each file in the reports directory for filename in os.listdir(reports_dir): file_path = os.path.join(reports_dir, filename) # Skip directories if os.path.isdir(file_path): continue # Extract information from filename parts = filename.split('_') if len(parts) \u003e= 3: report_type = parts[0] quarter_info = parts[1] # e.g., \"Q1\" year = parts[2].split('.')[0] # Remove file extension # Create folders if they don't exist year_dir = os.path.join(organized_dir, year) os.makedirs(year_dir, exist_ok=True) quarter_dir = os.path.join(year_dir, quarter_info) os.makedirs(quarter_dir, exist_ok=True) # Copy the file to its destination dest_path = os.path.join(quarter_dir, filename) shutil.copy2(file_path, dest_path) print(f\"Organized {filename} to {dest_path}\") return organized_dir def main(): parser = argparse.ArgumentParser(description='Automate quarterly financial processes') parser.add_argument('--data-dir', default='./Financial_Data', help='Directory containing financial data') parser.add_argument('--year', type=int, help='Year for processing (default: previous quarter\\'s year)') parser.add_argument('--quarter', type=int, help='Quarter for processing (1-4, default: previous quarter)') args = parser.parse_args() # Determine year and quarter if not specified if args.year is None or args.quarter is None: calc_year, calc_month = get_last_quarter() # Map month to quarter calc_quarter = (calc_month + 2) // 3 if args.year is None: args.year = calc_year if args.quarter is None: args.quarter = calc_quarter # Validate quarter if not 1 \u003c= args.quarter \u003c= 4: print(\"Error: Quarter must be between 1 and 4\") return print(f\"=== Starting Quarter-End Process for Q{args.quarter} {args.year} ===\") # Step 1: Create backup print(\"\\n-- Step 1: Creating Data Backup --\") backup_path = create_backup(args.data_dir) # Step 2: Generate reports print(\"\\n-- Step 2: Generating Quarterly Reports --\") reports_dir = f\"./Reports_Q{args.quarter}_{args.year}\" reports_path = generate_quarterly_reports(args.year, args.quarter, reports_dir) # Step 3: Organize reports print(\"\\n-- Step 3: Organizing Reports --\") organized_dir = organize_reports(reports_path) print(\"\\n=== Quarter-End Process Complete ===\") print(f\"Data backup: {backup_path}\") print(f\"Reports directory: {reports_path}\") print(f\"Organized reports: {organized_dir}\") if __name__ == \"__main__\": main() Conclusion Automation is where Python really shines for finance professionals. Even if you never build a complex data model or web application, these automation tools can save you hours of repetitive work each week:\nCLI tools with argparse help you build flexible, reusable scripts Package entry points let you install your tools system-wide File operations with os and shutil organize your financial documents PyAutoGUI can automate interactions with desktop financial applications As you build your automation toolkit, start small with scripts that solve specific pain points in your workflow. Over time, you’ll develop a collection of tools that dramatically increase your productivity.\nNext Steps Try automating a simple task you perform regularly Build a command-line tool for a financial calculation you frequently need Create a script to organize a messy folder of financial documents Consider which parts of your quarter-end process could be automated Remember that the best automations are the ones that solve your specific problems. The scripts in this post are just starting points - customize them to fit your unique workflow needs.\nResources argparse documentation PyAutoGUI documentation Python Packaging User Guide shutil documentation Real Python: Command-Line Apps with argparse ","wordCount":"2397","inLanguage":"en","image":"http://localhost:1313/site-feature-image.jpg","datePublished":"2025-06-26T00:00:00Z","dateModified":"2025-05-09T14:44:55+01:00","author":{"@type":"Person","name":"Michael Brunger"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/python-command-line-automation/"},"publisher":{"@type":"Organization","name":"Michael Brunger","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Michael Brunger (Alt + H)">Michael Brunger</a><div class=logo-switches></div></div><ul class="menu desktop-menu"><li><a href=http://localhost:1313/ title=Home><span>Home</span></a></li><li><a href=http://localhost:1313/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/links/ title=Links><span>Links</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/contact/ title=Contact><span>Contact</span></a></li></ul><button id=menu-trigger class=hamburger-menu aria-haspopup=menu aria-label="Menu Button"><div class=hamburger-icon><span></span>
<span></span>
<span></span>
<span></span></div></button></nav></header><div class=mobile-menu-overlay><ul class=mobile-menu><li><a href=http://localhost:1313/>Home</a></li><li><a href=http://localhost:1313/posts/>Posts</a></li><li><a href=http://localhost:1313/about/>About</a></li><li><a href=http://localhost:1313/links/>Links</a></li><li><a href=http://localhost:1313/search/>Search</a></li><li><a href=http://localhost:1313/contact/>Contact</a></li></ul></div><main class=main><div class=reading-progress-container><div class=reading-progress-bar></div></div><script>console.log("Reading progress script loaded"),document.addEventListener("DOMContentLoaded",function(){console.log("DOM Content Loaded");const e=document.querySelector(".reading-progress-bar");if(console.log("Progress bar element:",e),!e){console.log("No progress bar found");return}window.addEventListener("scroll",function(){const n=window.innerHeight,s=document.documentElement.scrollHeight-n,o=window.scrollY,t=o/s*100;e.style.width=t+"%",console.log("Progress:",t+"%")})})</script><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Part 9: Command-Line Tools & Automation with Python</h1><div class=post-description>Build command-line interfaces with argparse, create installable CLI tools, automate file operations, control GUI applications, and develop practical automation projects.</div><div class=post-meta><span class=post-date><i class="far fa-calendar-alt"></i>
June 26, 2025
</span><span class=post-lastmod><i class="fas fa-edit"></i>
Last modified: May 9, 2025
</span><span class=post-reading-time><i class="far fa-clock"></i>
12 min read</span></div></header><div class=toc><details><summary>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#building-command-line-scripts-with-argparse>Building Command-Line Scripts with argparse</a><ul><li><a href=#basic-argparse-structure>Basic argparse Structure</a></li><li><a href=#understanding-argparse-components>Understanding argparse Components</a></li><li><a href=#adding-help-text>Adding Help Text</a></li><li><a href=#more-argparse-features>More argparse Features</a></li></ul></li><li><a href=#packaging-entry-points-for-installable-commands>Packaging Entry Points for Installable Commands</a><ul><li><a href=#creating-a-package-structure>Creating a Package Structure</a></li><li><a href=#setting-up-pyprojecttoml>Setting Up pyproject.toml</a></li><li><a href=#installing-your-package>Installing Your Package</a></li></ul></li><li><a href=#automating-file-and-folder-tasks>Automating File and Folder Tasks</a><ul><li><a href=#basic-file-operations-with-os-and-shutil>Basic File Operations with os and shutil</a></li><li><a href=#understanding-key-file-operations>Understanding Key File Operations</a></li><li><a href=#automating-financial-report-backups>Automating Financial Report Backups</a></li></ul></li><li><a href=#automating-gui-interactions-with-pyautogui>Automating GUI Interactions with PyAutoGUI</a><ul><li><a href=#installing-and-setting-up-pyautogui>Installing and Setting Up PyAutoGUI</a></li><li><a href=#safety-features>Safety Features</a></li><li><a href=#basic-pyautogui-example>Basic PyAutoGUI Example</a></li><li><a href=#pyautogui-key-functions>PyAutoGUI Key Functions</a></li></ul></li><li><a href=#putting-it-all-together-sample-financial-automation-project>Putting It All Together: Sample Financial Automation Project</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#next-steps>Next Steps</a></li><li><a href=#resources>Resources</a></li></ul></nav></details></div><div class=post-content><h1 id=command-line-tools--automation-in-python>Command-Line Tools & Automation in Python<a hidden class=anchor aria-hidden=true href=#command-line-tools--automation-in-python>#</a></h1><p>As a finance professional learning to code, I&rsquo;ve discovered that some of the most practical Python applications aren&rsquo;t fancy data visualizations or machine learning models, but rather simple automation scripts that save time on repetitive tasks. In this post, I&rsquo;ll walk through how to build command-line tools and automate everyday processes using Python.</p><h2 id=building-command-line-scripts-with-argparse>Building Command-Line Scripts with argparse<a hidden class=anchor aria-hidden=true href=#building-command-line-scripts-with-argparse>#</a></h2><p>When you&rsquo;re working with financial data, you often need flexible tools that can handle different inputs. The <code>argparse</code> module lets you build command-line scripts that accept various arguments and options.</p><h3 id=basic-argparse-structure>Basic argparse Structure<a hidden class=anchor aria-hidden=true href=#basic-argparse-structure>#</a></h3><p>First, let&rsquo;s create a simple script that calculates compound interest:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> argparse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_compound_interest</span>(principal, rate, time, compounds_per_year<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Calculate compound interest.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Args:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        principal: Initial investment amount
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        rate: Annual interest rate (decimal)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        time: Time in years
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        compounds_per_year: Number of times interest compounds per year
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Final amount after compound interest
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> principal <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> rate<span style=color:#f92672>/</span>compounds_per_year)<span style=color:#f92672>**</span>(compounds_per_year<span style=color:#f92672>*</span>time)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create argument parser</span>
</span></span><span style=display:flex><span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Calculate compound interest&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Add arguments</span>
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;principal&#39;</span>, type<span style=color:#f92672>=</span>float, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Initial investment amount&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;rate&#39;</span>, type<span style=color:#f92672>=</span>float, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Annual interest rate (decimal)&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;time&#39;</span>, type<span style=color:#f92672>=</span>float, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Time in years&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--compounds&#39;</span>, type<span style=color:#f92672>=</span>int, default<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, 
</span></span><span style=display:flex><span>                        help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Number of times interest compounds per year (default: 1)&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Parse arguments</span>
</span></span><span style=display:flex><span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Calculate result</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> calculate_compound_interest(
</span></span><span style=display:flex><span>        args<span style=color:#f92672>.</span>principal, 
</span></span><span style=display:flex><span>        args<span style=color:#f92672>.</span>rate, 
</span></span><span style=display:flex><span>        args<span style=color:#f92672>.</span>time, 
</span></span><span style=display:flex><span>        args<span style=color:#f92672>.</span>compounds
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Print result</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Initial principal: $</span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>principal<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Annual rate: </span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>rate<span style=color:#e6db74>:</span><span style=color:#e6db74>.2%</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Time: </span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>time<span style=color:#e6db74>}</span><span style=color:#e6db74> years&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Compounds per year: </span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>compounds<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Final amount: $</span><span style=color:#e6db74>{</span>result<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Interest earned: $</span><span style=color:#e6db74>{</span>result <span style=color:#f92672>-</span> args<span style=color:#f92672>.</span>principal<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>Save this script as <code>compound_interest.py</code> and run it from the command line:</p><pre tabindex=0><code>python compound_interest.py 10000 0.05 5 --compounds 12
</code></pre><p>This would calculate the compound interest on $10,000 at 5% annual interest for 5 years, compounded monthly.</p><h3 id=understanding-argparse-components>Understanding argparse Components<a hidden class=anchor aria-hidden=true href=#understanding-argparse-components>#</a></h3><p>Let&rsquo;s break down what&rsquo;s happening in our script:</p><ol><li>We create an <code>ArgumentParser</code> object with a description</li><li>We add arguments with <code>add_argument()</code>:<ul><li>Positional arguments (<code>principal</code>, <code>rate</code>, <code>time</code>) are required</li><li>Optional arguments (like <code>--compounds</code>) start with <code>--</code> and have default values</li></ul></li><li>We parse the command-line arguments with <code>parse_args()</code></li><li>We access the values via <code>args.parameter_name</code></li></ol><h3 id=adding-help-text>Adding Help Text<a hidden class=anchor aria-hidden=true href=#adding-help-text>#</a></h3><p>One of the best features of <code>argparse</code> is automatic help text generation. Users can run your script with <code>-h</code> or <code>--help</code> to see instructions:</p><pre tabindex=0><code>python compound_interest.py --help
</code></pre><p>Which produces:</p><pre tabindex=0><code>usage: compound_interest.py [-h] [--compounds COMPOUNDS] principal rate time

Calculate compound interest

positional arguments:
  principal             Initial investment amount
  rate                  Annual interest rate (decimal)
  time                  Time in years

optional arguments:
  -h, --help            show this help message and exit
  --compounds COMPOUNDS Number of times interest compounds per year (default: 1)
</code></pre><h3 id=more-argparse-features>More argparse Features<a hidden class=anchor aria-hidden=true href=#more-argparse-features>#</a></h3><p>For financial applications, you might want to add more sophisticated options:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--currency&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;$&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Currency symbol to display&#39;</span>)
</span></span><span style=display:flex><span>parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--output-file&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Save results to a file&#39;</span>)
</span></span><span style=display:flex><span>parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--verbose&#39;</span>, <span style=color:#e6db74>&#39;-v&#39;</span>, action<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;store_true&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Display additional information&#39;</span>)
</span></span></code></pre></div><p>The <code>action='store_true'</code> creates a flag that&rsquo;s either True or False depending on whether it&rsquo;s included.</p><h2 id=packaging-entry-points-for-installable-commands>Packaging Entry Points for Installable Commands<a hidden class=anchor aria-hidden=true href=#packaging-entry-points-for-installable-commands>#</a></h2><p>If you find yourself using the same script frequently, you can package it so it&rsquo;s available as a system-wide command.</p><h3 id=creating-a-package-structure>Creating a Package Structure<a hidden class=anchor aria-hidden=true href=#creating-a-package-structure>#</a></h3><p>First, organize your files like this:</p><pre tabindex=0><code>finance_tools/
├── finance_tools/
│   ├── __init__.py
│   ├── compound_interest.py
│   └── other_modules.py
├── README.md
└── pyproject.toml
</code></pre><h3 id=setting-up-pyprojecttoml>Setting Up pyproject.toml<a hidden class=anchor aria-hidden=true href=#setting-up-pyprojecttoml>#</a></h3><p>Create a <code>pyproject.toml</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>build-system</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>requires</span> = [<span style=color:#e6db74>&#34;setuptools&gt;=42&#34;</span>, <span style=color:#e6db74>&#34;wheel&#34;</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>build-backend</span> = <span style=color:#e6db74>&#34;setuptools.build_meta&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>project</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>name</span> = <span style=color:#e6db74>&#34;finance_tools&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>version</span> = <span style=color:#e6db74>&#34;0.1.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>description</span> = <span style=color:#e6db74>&#34;Financial calculation tools&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>readme</span> = <span style=color:#e6db74>&#34;README.md&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>authors</span> = [{<span style=color:#a6e22e>name</span> = <span style=color:#e6db74>&#34;Your Name&#34;</span>, <span style=color:#a6e22e>email</span> = <span style=color:#e6db74>&#34;your.email@example.com&#34;</span>}]
</span></span><span style=display:flex><span><span style=color:#a6e22e>license</span> = {<span style=color:#a6e22e>text</span> = <span style=color:#e6db74>&#34;MIT&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>requires-python</span> = <span style=color:#e6db74>&#34;&gt;=3.6&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>project</span>.<span style=color:#a6e22e>scripts</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>compound-interest</span> = <span style=color:#e6db74>&#34;finance_tools.compound_interest:main&#34;</span>
</span></span></code></pre></div><p>The <code>[project.scripts]</code> section is what creates the entry point. After installing this package, you&rsquo;ll be able to run <code>compound-interest</code> directly from your command line without typing <code>python</code> first.</p><h3 id=installing-your-package>Installing Your Package<a hidden class=anchor aria-hidden=true href=#installing-your-package>#</a></h3><p>Install your package in development mode:</p><pre tabindex=0><code>pip install -e .
</code></pre><p>Now you can run:</p><pre tabindex=0><code>compound-interest 10000 0.05 5 --compounds 12
</code></pre><h2 id=automating-file-and-folder-tasks>Automating File and Folder Tasks<a hidden class=anchor aria-hidden=true href=#automating-file-and-folder-tasks>#</a></h2><p>As a finance professional, you probably deal with lots of reports, spreadsheets, and data files. Python can help automate file handling tasks.</p><h3 id=basic-file-operations-with-os-and-shutil>Basic File Operations with os and shutil<a hidden class=anchor aria-hidden=true href=#basic-file-operations-with-os-and-shutil>#</a></h3><p>Here&rsquo;s a script that organizes financial statements by month and type:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>organize_financial_statements</span>(source_dir, target_dir):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Organize financial statements into folders by month and type.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Assumes filenames like: &#39;Income_Statement_2023-05-15.xlsx&#39; or &#39;Balance_Sheet_05_15_2023.pdf&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create target directory if it doesn&#39;t exist</span>
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(target_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Regular expressions for date patterns</span>
</span></span><span style=display:flex><span>    patterns <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;(\d</span><span style=color:#e6db74>{4}</span><span style=color:#e6db74>)-(\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>)-\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>&#39;</span>,  <span style=color:#75715e># YYYY-MM-DD</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;(\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>)_\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>_(\d</span><span style=color:#e6db74>{4}</span><span style=color:#e6db74>)&#39;</span>,  <span style=color:#75715e># MM_DD_YYYY</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;(\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>)-\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>-(\d</span><span style=color:#e6db74>{4}</span><span style=color:#e6db74>)&#39;</span>   <span style=color:#75715e># MM-DD-YYYY</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Document types to look for</span>
</span></span><span style=display:flex><span>    doc_types <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Income_Statement&#39;</span>, <span style=color:#e6db74>&#39;Balance_Sheet&#39;</span>, <span style=color:#e6db74>&#39;Cash_Flow&#39;</span>, <span style=color:#e6db74>&#39;Trial_Balance&#39;</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process each file in the source directory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> filename <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(source_dir):
</span></span><span style=display:flex><span>        file_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(source_dir, filename)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Skip directories</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isdir(file_path):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#75715e># Try to extract date</span>
</span></span><span style=display:flex><span>        date_found <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pattern <span style=color:#f92672>in</span> patterns:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>match</span> <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>search(pattern, filename)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>match</span>:
</span></span><span style=display:flex><span>                <span style=color:#75715e># Extract year and month</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> len(<span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>group(<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>:  <span style=color:#75715e># If first group is year (YYYY-MM-DD)</span>
</span></span><span style=display:flex><span>                    year, month <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>group(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>group(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:  <span style=color:#75715e># If first group is month (MM_DD_YYYY)</span>
</span></span><span style=display:flex><span>                    month, year <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>group(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>group(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                month_name <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>strptime(month, <span style=color:#e6db74>&#34;%m&#34;</span>)<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%B&#34;</span>)
</span></span><span style=display:flex><span>                date_found <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> date_found:
</span></span><span style=display:flex><span>            <span style=color:#75715e># If no date pattern found, put in &#39;Unsorted&#39;</span>
</span></span><span style=display:flex><span>            year, month_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Unsorted&#39;</span>, <span style=color:#e6db74>&#39;Unsorted&#39;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Try to match document type</span>
</span></span><span style=display:flex><span>        doc_type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Other&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> dtype <span style=color:#f92672>in</span> doc_types:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> dtype <span style=color:#f92672>in</span> filename:
</span></span><span style=display:flex><span>                doc_type <span style=color:#f92672>=</span> dtype
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Create year and month folders if they don&#39;t exist</span>
</span></span><span style=display:flex><span>        year_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(target_dir, year)
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>makedirs(year_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        month_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(year_dir, month_name)
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>makedirs(month_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Create document type folder if it doesn&#39;t exist</span>
</span></span><span style=display:flex><span>        doc_type_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(month_dir, doc_type)
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>makedirs(doc_type_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Copy the file to its destination</span>
</span></span><span style=display:flex><span>        dest_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(doc_type_dir, filename)
</span></span><span style=display:flex><span>        shutil<span style=color:#f92672>.</span>copy2(file_path, dest_path)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Copied </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74> to </span><span style=color:#e6db74>{</span>dest_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Organize financial statements by date and type&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;source_dir&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Directory containing financial statements&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--target-dir&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;./Organized_Statements&#39;</span>,
</span></span><span style=display:flex><span>                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Target directory for organized files (default: ./Organized_Statements)&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>    organize_financial_statements(args<span style=color:#f92672>.</span>source_dir, args<span style=color:#f92672>.</span>target_dir)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Financial statement organization complete!&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>This script:</p><ol><li>Scans a directory for financial documents</li><li>Extracts dates and document types from filenames</li><li>Creates an organized folder structure by year, month, and document type</li><li>Copies files to the appropriate locations</li></ol><h3 id=understanding-key-file-operations>Understanding Key File Operations<a hidden class=anchor aria-hidden=true href=#understanding-key-file-operations>#</a></h3><ul><li><code>os.path.join()</code>: Combines path components correctly for your operating system</li><li><code>os.makedirs()</code>: Creates directories recursively with <code>exist_ok=True</code> to avoid errors</li><li><code>os.listdir()</code>: Lists files and directories in a path</li><li><code>shutil.copy2()</code>: Copies files while preserving metadata</li></ul><h3 id=automating-financial-report-backups>Automating Financial Report Backups<a hidden class=anchor aria-hidden=true href=#automating-financial-report-backups>#</a></h3><p>Here&rsquo;s another practical example that creates date-stamped backups of your financial reports:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>backup_financial_reports</span>(reports_dir, backup_dir<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Create a date-stamped ZIP backup of financial reports.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Set default backup directory if none provided</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> backup_dir <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        backup_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(reports_dir), <span style=color:#e6db74>&#39;Backups&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create backup directory if it doesn&#39;t exist</span>
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(backup_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create timestamp for backup filename</span>
</span></span><span style=display:flex><span>    timestamp <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y%m</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>_%H%M%S&#39;</span>)
</span></span><span style=display:flex><span>    backup_filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Financial_Reports_Backup_</span><span style=color:#e6db74>{</span>timestamp<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>
</span></span><span style=display:flex><span>    backup_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(backup_dir, backup_filename)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create ZIP file</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(backup_path, <span style=color:#e6db74>&#39;w&#39;</span>, zipfile<span style=color:#f92672>.</span>ZIP_DEFLATED) <span style=color:#66d9ef>as</span> zipf:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Walk through all files in the reports directory</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> root, _, files <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>walk(reports_dir):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> files:
</span></span><span style=display:flex><span>                file_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(root, file)
</span></span><span style=display:flex><span>                <span style=color:#75715e># Calculate path relative to reports_dir for ZIP structure</span>
</span></span><span style=display:flex><span>                rel_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>relpath(file_path, reports_dir)
</span></span><span style=display:flex><span>                zipf<span style=color:#f92672>.</span>write(file_path, rel_path)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Added </span><span style=color:#e6db74>{</span>rel_path<span style=color:#e6db74>}</span><span style=color:#e6db74> to backup&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Backup created at: </span><span style=color:#e6db74>{</span>backup_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total size: </span><span style=color:#e6db74>{</span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>getsize(backup_path) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1024</span><span style=color:#f92672>*</span><span style=color:#ae81ff>1024</span>)<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> MB&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> backup_path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Create a backup of financial reports&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;reports_dir&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Directory containing financial reports&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--backup-dir&#39;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Target directory for backups&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>    backup_financial_reports(args<span style=color:#f92672>.</span>reports_dir, args<span style=color:#f92672>.</span>backup_dir)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h2 id=automating-gui-interactions-with-pyautogui>Automating GUI Interactions with PyAutoGUI<a hidden class=anchor aria-hidden=true href=#automating-gui-interactions-with-pyautogui>#</a></h2><p>Sometimes you need to automate interactions with desktop applications that don&rsquo;t have APIs. For example, maybe you need to extract data from an older accounting system that can only export data through its GUI. PyAutoGUI can help automate these interactions.</p><h3 id=installing-and-setting-up-pyautogui>Installing and Setting Up PyAutoGUI<a hidden class=anchor aria-hidden=true href=#installing-and-setting-up-pyautogui>#</a></h3><pre tabindex=0><code>pip install pyautogui
</code></pre><h3 id=safety-features>Safety Features<a hidden class=anchor aria-hidden=true href=#safety-features>#</a></h3><p>PyAutoGUI has a fail-safe feature - quickly move your mouse to any corner of the screen to abort the script. This is crucial when you&rsquo;re testing automation that controls your mouse!</p><h3 id=basic-pyautogui-example>Basic PyAutoGUI Example<a hidden class=anchor aria-hidden=true href=#basic-pyautogui-example>#</a></h3><p>Here&rsquo;s a simple script that could help export a monthly report from a financial application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pyautogui
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Safety delay - gives you time to switch to the target application</span>
</span></span><span style=display:flex><span>SAFETY_DELAY <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>export_monthly_report</span>(year, month):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Automate exporting a monthly report from a financial application.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Args:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        year: Year for the report
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        month: Month number (1-12) for the report
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Convert month number to name for the filename</span>
</span></span><span style=display:flex><span>    month_name <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>strptime(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>month<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;%m&#34;</span>)<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%B&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Preparing to export </span><span style=color:#e6db74>{</span>month_name<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{</span>year<span style=color:#e6db74>}</span><span style=color:#e6db74> report...&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Switch to your financial application within </span><span style=color:#e6db74>{</span>SAFETY_DELAY<span style=color:#e6db74>}</span><span style=color:#e6db74> seconds!&#34;</span>)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(SAFETY_DELAY)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Click on &#39;Reports&#39; menu</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>)  <span style=color:#75715e># Adjust coordinates based on your application</span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Click on &#39;Monthly&#39; option</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>)  <span style=color:#75715e># Adjust coordinates based on your application</span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Fill in date fields</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>typewrite(str(year))
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;tab&#39;</span>)
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>typewrite(str(month)<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>2</span>))
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;tab&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Click &#39;Generate Report&#39; button</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>200</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>)  <span style=color:#75715e># Adjust coordinates based on your application</span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>3</span>)  <span style=color:#75715e># Wait for report to generate</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Save the report</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>hotkey(<span style=color:#e6db74>&#39;ctrl&#39;</span>, <span style=color:#e6db74>&#39;s&#39;</span>)  <span style=color:#75715e># Press Ctrl+S to save</span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Type the filename</span>
</span></span><span style=display:flex><span>    filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Financial_Report_</span><span style=color:#e6db74>{</span>year<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>month_name<span style=color:#e6db74>}</span><span style=color:#e6db74>.xlsx&#34;</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>typewrite(filename)
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;enter&#39;</span>)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Report exported as </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Automate monthly report export&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--year&#39;</span>, type<span style=color:#f92672>=</span>int, default<span style=color:#f92672>=</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>year, 
</span></span><span style=display:flex><span>                        help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Year for the report (default: current year)&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--month&#39;</span>, type<span style=color:#f92672>=</span>int, default<span style=color:#f92672>=</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>month <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>or</span> <span style=color:#ae81ff>12</span>,
</span></span><span style=display:flex><span>                        help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Month for the report (1-12, default: previous month)&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Validate month</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;=</span> args<span style=color:#f92672>.</span>month <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>12</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Error: Month must be between 1 and 12&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    export_monthly_report(args<span style=color:#f92672>.</span>year, args<span style=color:#f92672>.</span>month)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p><strong>Important note</strong>: The coordinates in this script (e.g., <code>pyautogui.click(x=100, y=20)</code>) need to be adjusted for your specific application. Use <code>pyautogui.position()</code> to get the coordinates of your mouse pointer.</p><h3 id=pyautogui-key-functions>PyAutoGUI Key Functions<a hidden class=anchor aria-hidden=true href=#pyautogui-key-functions>#</a></h3><ul><li><code>pyautogui.click(x, y)</code>: Move mouse to coordinates and click</li><li><code>pyautogui.typewrite('text')</code>: Type text</li><li><code>pyautogui.press('key')</code>: Press a single key</li><li><code>pyautogui.hotkey('ctrl', 's')</code>: Press multiple keys simultaneously</li><li><code>pyautogui.screenshot()</code>: Take a screenshot</li><li><code>pyautogui.locateOnScreen('image.png')</code>: Find an image on screen</li></ul><h2 id=putting-it-all-together-sample-financial-automation-project>Putting It All Together: Sample Financial Automation Project<a hidden class=anchor aria-hidden=true href=#putting-it-all-together-sample-financial-automation-project>#</a></h2><p>Let&rsquo;s build a financial quarter-end automation tool that:</p><ol><li>Creates organized backup of last quarter&rsquo;s data</li><li>Generates reports using a GUI application</li><li>Organizes the reports into the correct folders</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pyautogui
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_last_quarter</span>(reference_date<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Calculate the previous quarter based on a reference date.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> reference_date <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        reference_date <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    current_month <span style=color:#f92672>=</span> reference_date<span style=color:#f92672>.</span>month
</span></span><span style=display:flex><span>    current_year <span style=color:#f92672>=</span> reference_date<span style=color:#f92672>.</span>year
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Calculate previous quarter end month (3, 6, 9, or 12)</span>
</span></span><span style=display:flex><span>    last_quarter_month <span style=color:#f92672>=</span> ((current_month <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>//</span> <span style=color:#ae81ff>3</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> last_quarter_month <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        last_quarter_month <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>        last_quarter_year <span style=color:#f92672>=</span> current_year <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        last_quarter_year <span style=color:#f92672>=</span> current_year
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> last_quarter_year, last_quarter_month
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_backup</span>(data_dir, backup_dir<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Create a date-stamped ZIP backup.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> backup_dir <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        backup_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(data_dir), <span style=color:#e6db74>&#39;Quarterly_Backups&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(backup_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    timestamp <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>now()<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y%m</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>_%H%M%S&#39;</span>)
</span></span><span style=display:flex><span>    backup_filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Financial_Data_Backup_</span><span style=color:#e6db74>{</span>timestamp<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>
</span></span><span style=display:flex><span>    backup_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(backup_dir, backup_filename)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> zipfile<span style=color:#f92672>.</span>ZipFile(backup_path, <span style=color:#e6db74>&#39;w&#39;</span>, zipfile<span style=color:#f92672>.</span>ZIP_DEFLATED) <span style=color:#66d9ef>as</span> zipf:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> root, _, files <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>walk(data_dir):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> files:
</span></span><span style=display:flex><span>                file_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(root, file)
</span></span><span style=display:flex><span>                rel_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>relpath(file_path, data_dir)
</span></span><span style=display:flex><span>                zipf<span style=color:#f92672>.</span>write(file_path, rel_path)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Added </span><span style=color:#e6db74>{</span>rel_path<span style=color:#e6db74>}</span><span style=color:#e6db74> to backup&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Backup created at: </span><span style=color:#e6db74>{</span>backup_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> backup_path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_quarterly_reports</span>(year, quarter, output_dir):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Automate generating quarterly reports using PyAutoGUI.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(output_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Calculate quarter end month</span>
</span></span><span style=display:flex><span>    end_month <span style=color:#f92672>=</span> quarter <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Quarter name for folder organization</span>
</span></span><span style=display:flex><span>    quarter_name <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Q</span><span style=color:#e6db74>{</span>quarter<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>year<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Preparing to generate </span><span style=color:#e6db74>{</span>quarter_name<span style=color:#e6db74>}</span><span style=color:#e6db74> reports...&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Switch to your financial application within 5 seconds!&#34;</span>)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># This is a simplified example - you would need to adjust coordinates</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># and actions based on your specific application</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Click on Reports menu</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Click on Quarterly Reports</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>80</span>)
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Enter year and quarter</span>
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>typewrite(str(year))
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;tab&#39;</span>)
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>typewrite(str(quarter))
</span></span><span style=display:flex><span>    pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;tab&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Generate reports</span>
</span></span><span style=display:flex><span>    report_types <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Income_Statement&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Balance_Sheet&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Cash_Flow&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Accounts_Receivable&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> report_type <span style=color:#f92672>in</span> report_types:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Select report type from dropdown</span>
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;down&#39;</span>, presses<span style=color:#f92672>=</span>report_types<span style=color:#f92672>.</span>index(report_type) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;enter&#39;</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Click Generate button</span>
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>200</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>3</span>)  <span style=color:#75715e># Wait for report to generate</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Save report</span>
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>hotkey(<span style=color:#e6db74>&#39;ctrl&#39;</span>, <span style=color:#e6db74>&#39;s&#39;</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Type filename and save to output directory</span>
</span></span><span style=display:flex><span>        filename <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>report_type<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>quarter_name<span style=color:#e6db74>}</span><span style=color:#e6db74>.xlsx&#34;</span>
</span></span><span style=display:flex><span>        filepath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(output_dir, filename)
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>typewrite(filepath)
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>press(<span style=color:#e6db74>&#39;enter&#39;</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Generated </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Return to report selection</span>
</span></span><span style=display:flex><span>        pyautogui<span style=color:#f92672>.</span>click(x<span style=color:#f92672>=</span><span style=color:#ae81ff>150</span>, y<span style=color:#f92672>=</span><span style=color:#ae81ff>150</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> output_dir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>organize_reports</span>(reports_dir, organized_dir<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Organize reports into a structured folder system.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> organized_dir <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        organized_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(reports_dir), <span style=color:#e6db74>&#39;Organized_Reports&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>makedirs(organized_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process each file in the reports directory</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> filename <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(reports_dir):
</span></span><span style=display:flex><span>        file_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(reports_dir, filename)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Skip directories</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isdir(file_path):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#75715e># Extract information from filename</span>
</span></span><span style=display:flex><span>        parts <span style=color:#f92672>=</span> filename<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;_&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(parts) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>3</span>:
</span></span><span style=display:flex><span>            report_type <span style=color:#f92672>=</span> parts[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>            quarter_info <span style=color:#f92672>=</span> parts[<span style=color:#ae81ff>1</span>]  <span style=color:#75715e># e.g., &#34;Q1&#34;</span>
</span></span><span style=display:flex><span>            year <span style=color:#f92672>=</span> parts[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>0</span>]  <span style=color:#75715e># Remove file extension</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Create folders if they don&#39;t exist</span>
</span></span><span style=display:flex><span>            year_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(organized_dir, year)
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>makedirs(year_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            quarter_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(year_dir, quarter_info)
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>makedirs(quarter_dir, exist_ok<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Copy the file to its destination</span>
</span></span><span style=display:flex><span>            dest_path <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(quarter_dir, filename)
</span></span><span style=display:flex><span>            shutil<span style=color:#f92672>.</span>copy2(file_path, dest_path)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Organized </span><span style=color:#e6db74>{</span>filename<span style=color:#e6db74>}</span><span style=color:#e6db74> to </span><span style=color:#e6db74>{</span>dest_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> organized_dir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Automate quarterly financial processes&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--data-dir&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;./Financial_Data&#39;</span>,
</span></span><span style=display:flex><span>                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Directory containing financial data&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--year&#39;</span>, type<span style=color:#f92672>=</span>int, 
</span></span><span style=display:flex><span>                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Year for processing (default: previous quarter</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>s year)&#39;</span>)
</span></span><span style=display:flex><span>    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--quarter&#39;</span>, type<span style=color:#f92672>=</span>int,
</span></span><span style=display:flex><span>                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Quarter for processing (1-4, default: previous quarter)&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Determine year and quarter if not specified</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>year <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>or</span> args<span style=color:#f92672>.</span>quarter <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        calc_year, calc_month <span style=color:#f92672>=</span> get_last_quarter()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Map month to quarter</span>
</span></span><span style=display:flex><span>        calc_quarter <span style=color:#f92672>=</span> (calc_month <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>//</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>year <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            args<span style=color:#f92672>.</span>year <span style=color:#f92672>=</span> calc_year
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>quarter <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            args<span style=color:#f92672>.</span>quarter <span style=color:#f92672>=</span> calc_quarter
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Validate quarter</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;=</span> args<span style=color:#f92672>.</span>quarter <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>4</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Error: Quarter must be between 1 and 4&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;=== Starting Quarter-End Process for Q</span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>quarter<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>year<span style=color:#e6db74>}</span><span style=color:#e6db74> ===&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Step 1: Create backup</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>-- Step 1: Creating Data Backup --&#34;</span>)
</span></span><span style=display:flex><span>    backup_path <span style=color:#f92672>=</span> create_backup(args<span style=color:#f92672>.</span>data_dir)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Step 2: Generate reports</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>-- Step 2: Generating Quarterly Reports --&#34;</span>)
</span></span><span style=display:flex><span>    reports_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;./Reports_Q</span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>quarter<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>args<span style=color:#f92672>.</span>year<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    reports_path <span style=color:#f92672>=</span> generate_quarterly_reports(args<span style=color:#f92672>.</span>year, args<span style=color:#f92672>.</span>quarter, reports_dir)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Step 3: Organize reports</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>-- Step 3: Organizing Reports --&#34;</span>)
</span></span><span style=display:flex><span>    organized_dir <span style=color:#f92672>=</span> organize_reports(reports_path)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>=== Quarter-End Process Complete ===&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Data backup: </span><span style=color:#e6db74>{</span>backup_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Reports directory: </span><span style=color:#e6db74>{</span>reports_path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Organized reports: </span><span style=color:#e6db74>{</span>organized_dir<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Automation is where Python really shines for finance professionals. Even if you never build a complex data model or web application, these automation tools can save you hours of repetitive work each week:</p><ul><li>CLI tools with <code>argparse</code> help you build flexible, reusable scripts</li><li>Package entry points let you install your tools system-wide</li><li>File operations with <code>os</code> and <code>shutil</code> organize your financial documents</li><li>PyAutoGUI can automate interactions with desktop financial applications</li></ul><p>As you build your automation toolkit, start small with scripts that solve specific pain points in your workflow. Over time, you&rsquo;ll develop a collection of tools that dramatically increase your productivity.</p><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><ul><li>Try automating a simple task you perform regularly</li><li>Build a command-line tool for a financial calculation you frequently need</li><li>Create a script to organize a messy folder of financial documents</li><li>Consider which parts of your quarter-end process could be automated</li></ul><p>Remember that the best automations are the ones that solve your specific problems. The scripts in this post are just starting points - customize them to fit your unique workflow needs.</p><h2 id=resources>Resources<a hidden class=anchor aria-hidden=true href=#resources>#</a></h2><ul><li><a href=https://docs.python.org/3/library/argparse.html>argparse documentation</a></li><li><a href=https://pyautogui.readthedocs.io/en/latest/>PyAutoGUI documentation</a></li><li><a href=https://packaging.python.org/en/latest/>Python Packaging User Guide</a></li><li><a href=https://docs.python.org/3/library/shutil.html>shutil documentation</a></li><li><a href=https://realpython.com/command-line-interfaces-python-argparse/>Real Python: Command-Line Apps with argparse</a></li></ul></div><div class=related-posts><h2>Related Posts</h2><div class=related-posts-grid><article class=related-post><a href=http://localhost:1313/python-next-steps-advanced-topics/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 17: Next Steps & Advanced Python Topics</h3><p class=related-post-description>Explore advanced Python topics including concurrency, asyncio, and complete an end-to-end project. Discover resources for further learning and tips for continuing your Python journey.</p><div class=related-post-meta><time datetime=2025-08-21>August 21, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=http://localhost:1313/simple-gui-applications-tkinter/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 16: Building Simple GUI Applications with Tkinter</h3><p class=related-post-description>Create desktop applications with Python's built-in Tkinter library. Learn about widgets, layout managers, and build a practical mini-project with a graphical user interface.</p><div class=related-post-meta><time datetime=2025-08-14>August 14, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=http://localhost:1313/python-web-development-foundations/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 15: Web Development Foundations with Python</h3><p class=related-post-description>Explore web development options in Python. Learn Flask for lightweight applications, Django for full-featured sites, or web scraping with requests and BeautifulSoup. Deploy your first web app.</p><div class=related-post-meta><time datetime=2025-08-07>August 7, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/python>python</a></li><li><a href=http://localhost:1313/tags/cli>cli</a></li><li><a href=http://localhost:1313/tags/argparse>argparse</a></li><li><a href=http://localhost:1313/tags/automation>automation</a></li><li><a href=http://localhost:1313/tags/pyautogui>pyautogui</a></li><li><a href=http://localhost:1313/tags/os>os</a></li><li><a href=http://localhost:1313/tags/shutil>shutil</a></li><li><a href=http://localhost:1313/tags/scripting>scripting</a></li></ul><div class=share-buttons><a href="https://twitter.com/intent/tweet?text=Part%209%3a%20Command-Line%20Tools%20%26%20Automation%20with%20Python&url=http%3a%2f%2flocalhost%3a1313%2fpython-command-line-automation%2f" target=_blank rel=noopener aria-label="Share on Twitter"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3a%2f%2flocalhost%3a1313%2fpython-command-line-automation%2f" target=_blank rel=noopener aria-label="Share on LinkedIn"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpython-command-line-automation%2f" target=_blank rel=noopener aria-label="Share on Facebook"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</a><a href="https://wa.me/?text=Part%209%3a%20Command-Line%20Tools%20%26%20Automation%20with%20Python%20http%3a%2f%2flocalhost%3a1313%2fpython-command-line-automation%2f" target=_blank rel=noopener aria-label="Share on WhatsApp"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17.498 14.382c-.301-.15-1.767-.867-2.04-.966-.273-.101-.473-.15-.673.15-.197.295-.771.964-.944 1.162-.175.195-.349.21-.646.075-.3-.15-1.263-.465-2.403-1.485-.888-.795-1.484-1.77-1.66-2.07-.174-.3-.019-.465.13-.615.136-.135.301-.345.451-.523.146-.181.194-.301.297-.496.1-.21.049-.375-.025-.524-.075-.15-.672-1.62-.922-2.206-.24-.584-.487-.51-.672-.51-.172-.015-.371-.015-.571-.015-.2.0-.523.074-.797.359-.273.3-1.045 1.02-1.045 2.475s1.07 2.865 1.219 3.075c.149.195 2.105 3.195 5.1 4.485.714.3 1.27.48 1.704.629.714.227 1.365.195 1.88.121.574-.091 1.767-.721 2.016-1.426.255-.705.255-1.29.18-1.425-.074-.135-.27-.21-.57-.345m-5.446 7.443h-.016c-1.77.0-3.524-.48-5.055-1.38l-.36-.214-3.75.975 1.005-3.645-.239-.375c-.99-1.576-1.516-3.391-1.516-5.26.0-5.445 4.455-9.885 9.942-9.885a9.865 9.865.0 017.021 2.91 9.788 9.788.0 012.909 6.99c-.004 5.444-4.46 9.885-9.935 9.885M20.52 3.449C18.24 1.245 15.24.0 12.045.0 5.463.0.104 5.334.101 11.893c0 2.096.549 4.14 1.595 5.945L0 24l6.335-1.652a12.062 12.062.0 005.71 1.447h.006c6.585.0 11.946-5.336 11.949-11.896.0-3.176-1.24-6.165-3.495-8.411"/></svg>
</a><a href="mailto:?subject=Part%209%3a%20Command-Line%20Tools%20%26%20Automation%20with%20Python&body=http%3a%2f%2flocalhost%3a1313%2fpython-command-line-automation%2f" aria-label="Share via Email"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Michael Brunger</a> |</span>
<span class=footer-links><a href=mailto:michaelbrunger@gmail.com rel="me noopener" target=_blank>Email</a> |
<a href=https://linkedin.com/in/michael-brunger rel="me noopener" target=_blank>LinkedIn</a> |
<a href=http://localhost:1313/terms/ rel=noopener>Terms</a> |
<a href=http://localhost:1313/privacy/ rel=noopener>Privacy</a></span></footer><div id=back-to-top-container><button id=back-to-top class=back-to-top aria-label="Back to top"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg></button></div><script language=javascript type=text/javascript src=http://localhost:1313/menu-trigger.min.1fdaaaa006c69ae56d0620f2af3adf4d9e797e66d323215185b85818508bac37.js></script></body></html>