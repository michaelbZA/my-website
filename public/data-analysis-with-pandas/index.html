<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Part 12: Data Analysis with pandas | Michael Brunger</title>
<meta name=keywords content="python,pandas,data analysis,dataframe,csv,excel,data manipulation,data cleaning"><meta name=description content="Master data analysis in Python using pandas. Learn to work with Series and DataFrame objects, import data from various sources, and perform essential data manipulation operations."><meta name=author content="Michael Brunger"><link rel=canonical href=https://michaelbrunger.com/data-analysis-with-pandas/><link crossorigin=anonymous href=https://michaelbrunger.com/assets/css/stylesheet.fe6c761872462f9cd1981cfb6f465116b134fa108e39a30a712e4999193453db.css integrity="sha256-/mx2GHJGL5zRmBz7b0ZRFrE0+hCOOaMKcS5JmRk0U9s=" rel="preload stylesheet" as=style><link rel=icon href=https://michaelbrunger.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michaelbrunger.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michaelbrunger.com/favicon-32x32.png><link rel=apple-touch-icon href=https://michaelbrunger.com/apple-touch-icon.png><link rel=mask-icon href=https://michaelbrunger.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://michaelbrunger.com/data-analysis-with-pandas/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=icon href=https://michaelbrunger.com/assets/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://michaelbrunger.com/assets/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://michaelbrunger.com/assets/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://michaelbrunger.com/assets/apple-touch-icon.png><link rel=manifest href=https://michaelbrunger.com/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><script type=text/javascript src='https://app.cookieyes.com/mAsBCNFb37oPK_4XJgj7kpxbljvjKgiPcLeSeiRyslQSWcJQA0P7w_nb-e_NfuwZCdsSDi_gh_1zVLQNUSNV8A=='></script><script id=cookieyes type=text/javascript src=https://cdn-cookieyes.com/client_data/8dbaf9037ea60d809e6f1613/script.js></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Orbitron:wght@400..900&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-XJJLP6S9JL" data-cookieyes=cookieyes-analytics></script><script data-cookieyes=cookieyes-analytics>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XJJLP6S9JL")</script><script src=https://michaelbrunger.com/js/extended/back-to-top.min.js defer></script><script src=https://michaelbrunger.com/js/extended/sticky-header.min.js defer></script><script src=https://michaelbrunger.com/js/extended/menu-trigger.min.js defer></script><meta property="og:url" content="https://michaelbrunger.com/data-analysis-with-pandas/"><meta property="og:site_name" content="Michael Brunger"><meta property="og:title" content="Part 12: Data Analysis with pandas"><meta property="og:description" content="Master data analysis in Python using pandas. Learn to work with Series and DataFrame objects, import data from various sources, and perform essential data manipulation operations."><meta property="og:locale" content="en-GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-12T11:13:25+01:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Pandas"><meta property="article:tag" content="Data Analysis"><meta property="article:tag" content="Dataframe"><meta property="article:tag" content="Csv"><meta property="article:tag" content="Excel"><meta property="og:image" content="https://michaelbrunger.com/site-feature-image.jpg"><meta property="og:see_also" content="https://michaelbrunger.com/python-next-steps-advanced-topics/"><meta property="og:see_also" content="https://michaelbrunger.com/simple-gui-applications-tkinter/"><meta property="og:see_also" content="https://michaelbrunger.com/python-web-development-foundations/"><meta property="og:see_also" content="https://michaelbrunger.com/introduction-object-oriented-programming-python/"><meta property="og:see_also" content="https://michaelbrunger.com/python-data-visualisation-basics/"><meta property="og:see_also" content="https://michaelbrunger.com/numpy-fundamentals-numerical-data/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://michaelbrunger.com/site-feature-image.jpg"><meta name=twitter:title content="Part 12: Data Analysis with pandas"><meta name=twitter:description content="Master data analysis in Python using pandas. Learn to work with Series and DataFrame objects, import data from various sources, and perform essential data manipulation operations."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michaelbrunger.com/posts/"},{"@type":"ListItem","position":2,"name":"Python Series","item":"https://michaelbrunger.com/posts/python-series/"},{"@type":"ListItem","position":3,"name":"Part 12: Data Analysis with pandas","item":"https://michaelbrunger.com/data-analysis-with-pandas/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Part 12: Data Analysis with pandas","name":"Part 12: Data Analysis with pandas","description":"Master data analysis in Python using pandas. Learn to work with Series and DataFrame objects, import data from various sources, and perform essential data manipulation operations.","keywords":["python","pandas","data analysis","dataframe","csv","excel","data manipulation","data cleaning"],"articleBody":"Data Analysis with pandas for Finance and Accounting Welcome to post #12 in our Python journey! In the previous post, we explored NumPy and its powerful numerical capabilities. Now we’re taking a step up to pandas, which builds on NumPy’s foundation to provide specialized tools for working with tabular and time series data—exactly the kind of data we deal with daily in finance and accounting.\nAs a finance professional, I’ve found pandas to be one of the most valuable tools in my Python toolkit. It’s transformed how I handle everything from financial statements to transaction records. Let’s dive in!\nWhy pandas for Finance? pandas is specifically designed for data analysis and manipulation, with particular strengths in:\nWorking with tabular data (like spreadsheets, CSV files, and SQL tables) Handling time series (perfect for financial data) Cleaning messy data (a constant challenge in real-world accounting) Joining and merging datasets (combining data from multiple sources) Advanced grouping and aggregation (similar to pivot tables in Excel) If you’ve spent hours manipulating data in Excel, pandas will feel both familiar yet incredibly more powerful—think Excel on steroids with the automation capabilities of Python.\nInstalling pandas Let’s start by installing pandas:\npip install pandas If you’re using Anaconda, pandas is already included in the distribution.\nLet’s verify the installation:\nimport pandas as pd print(pd.__version__) You should see the version number displayed (like 2.0.3 or similar). By convention, pandas is imported with the alias pd to make your code more readable.\nThe Core pandas Data Structures pandas provides two primary data structures:\nSeries: A one-dimensional labeled array (like a column in a spreadsheet) DataFrame: A two-dimensional labeled data structure with columns (like a spreadsheet or SQL table) Let’s explore both with financial examples.\nSeries: One-Dimensional Data A Series is essentially a column of data with labeled indices:\nimport pandas as pd import numpy as np # Create a Series of monthly expenses monthly_expenses = pd.Series([1200, 1500, 1100, 1800], index=['Rent', 'Payroll', 'Utilities', 'Inventory']) print(monthly_expenses) # Output: # Rent 1200 # Payroll 1500 # Utilities 1100 # Inventory 1800 # dtype: int64 # Access by label print(f\"Monthly rent: ${monthly_expenses['Rent']}\") # Output: Monthly rent: $1200 # Access by position print(f\"Second highest expense: ${monthly_expenses.iloc[1]}\") # Output: Second highest expense: $1500 # Perform calculations print(f\"Total monthly expenses: ${monthly_expenses.sum()}\") # Output: Total monthly expenses: $5600 print(f\"Average expense: ${monthly_expenses.mean()}\") # Output: Average expense: $1400 # Filter expenses greater than 1200 high_expenses = monthly_expenses[monthly_expenses \u003e 1200] print(high_expenses) # Output: # Payroll 1500 # Inventory 1800 # dtype: int64 Series are useful for representing:\nA single financial metric across multiple companies Monthly or yearly values for a specific account Daily stock prices DataFrame: Two-Dimensional Data DataFrames are where pandas really shines. Think of them as an Excel spreadsheet within Python:\n# Create a DataFrame representing a simplified income statement income_statement = pd.DataFrame({ 'Q1': [100000, 45000, 15000, 40000], 'Q2': [110000, 47000, 15000, 48000], 'Q3': [95000, 42000, 16000, 37000], 'Q4': [125000, 52000, 17000, 56000] }, index=['Revenue', 'COGS', 'Operating Expenses', 'Net Income']) print(income_statement) # Output: # Q1 Q2 Q3 Q4 # Revenue 100000 110000 95000 125000 # COGS 45000 47000 42000 52000 # Operating Expenses 15000 15000 16000 17000 # Net Income 40000 48000 37000 56000 # Or create the same DataFrame with a different orientation # (More commonly used format with rows as observations and columns as variables) income_statement_alt = pd.DataFrame({ 'Quarter': ['Q1', 'Q2', 'Q3', 'Q4'], 'Revenue': [100000, 110000, 95000, 125000], 'COGS': [45000, 47000, 42000, 52000], 'Operating_Expenses': [15000, 15000, 16000, 17000], 'Net_Income': [40000, 48000, 37000, 56000] }) print(income_statement_alt) # Output: # Quarter Revenue COGS Operating_Expenses Net_Income # 0 Q1 100000 45000 15000 40000 # 1 Q2 110000 47000 15000 48000 # 2 Q3 95000 42000 16000 37000 # 3 Q4 125000 52000 17000 56000 The orientation you choose often depends on your data and analysis goals. For financial data:\nUse index for time periods and columns for accounts when tracking few accounts over time Use rows for time periods and columns for accounts when tracking many accounts Reading Data from External Sources In real-world finance, data often comes from external files. pandas excels at importing from various sources:\nReading from CSV CSVs are common for exporting financial data:\n# Read a transaction register CSV file # transactions.csv contains: Date,Description,Category,Amount transactions = pd.read_csv('transactions.csv') # Preview the first 5 rows print(transactions.head()) # Output: # Date Description Category Amount # 0 2023-01-05 Office Supplies Expense -89.99 # 1 2023-01-07 Client Payment - ABC Inc Income 1250.00 # 2 2023-01-10 Payroll Expense -4500.00 # 3 2023-01-15 Software License Expense -199.99 # 4 2023-01-18 Bank Interest Income 2.13 Reading from Excel Excel files are ubiquitous in finance and accounting:\n# Install openpyxl first if you haven't: # pip install openpyxl # Read an Excel file, specifying the sheet financial_data = pd.read_excel('financial_model.xlsx', sheet_name='Income Statement') # Preview the data print(financial_data.head()) Connecting to Databases For more enterprise-level finance applications:\n# pip install sqlalchemy # pip install pymysql (or other database driver) from sqlalchemy import create_engine # Connect to database (example with MySQL) engine = create_engine('mysql+pymysql://username:password@localhost/finance_db') # Read data directly from SQL query sql_query = \"SELECT * FROM general_ledger WHERE account_type = 'Asset' AND transaction_date \u003e '2023-01-01'\" gl_data = pd.read_sql(sql_query, engine) print(gl_data.head()) Inspecting and Exploring Your Data When you receive a new financial dataset, your first step is usually to understand its structure:\n# Assuming we've loaded our transactions data print(f\"Data shape (rows, columns): {transactions.shape}\") print(\"\\nColumn names:\") print(transactions.columns.tolist()) print(\"\\nData types:\") print(transactions.dtypes) print(\"\\nSummary statistics:\") print(transactions.describe()) print(\"\\nMissing values:\") print(transactions.isnull().sum()) # Check for duplicates print(f\"\\nDuplicate rows: {transactions.duplicated().sum()}\") Data Selection and Filtering pandas offers powerful ways to select and filter data:\n# Select specific columns amounts_and_categories = transactions[['Category', 'Amount']] print(amounts_and_categories.head()) # Filter rows based on conditions expenses = transactions[transactions['Amount'] \u003c 0] income = transactions[transactions['Amount'] \u003e 0] print(f\"Total expenses: ${expenses['Amount'].sum():.2f}\") print(f\"Total income: ${income['Amount'].sum():.2f}\") # Filter with multiple conditions # Find large office expenses large_office_expenses = transactions[ (transactions['Category'] == 'Expense') \u0026 (transactions['Description'].str.contains('Office')) \u0026 (transactions['Amount'] \u003c -100) ] print(large_office_expenses) # Select data from a specific date range # First, ensure Date is a datetime type transactions['Date'] = pd.to_datetime(transactions['Date']) # Filter for Q1 data q1_data = transactions[(transactions['Date'] \u003e= '2023-01-01') \u0026 (transactions['Date'] \u003c= '2023-03-31')] print(f\"Q1 transaction count: {len(q1_data)}\") Handling Missing Data Missing data is a common challenge in financial datasets:\n# Check for missing values print(transactions.isnull().sum()) # Fill missing values in Amount column with 0 transactions['Amount'] = transactions['Amount'].fillna(0) # Fill missing categories with 'Uncategorized' transactions['Category'] = transactions['Category'].fillna('Uncategorized') # Drop rows with any remaining missing values transactions_clean = transactions.dropna() # Alternative: Only drop rows where specific columns are missing transactions_essential = transactions.dropna(subset=['Date', 'Amount']) Data Transformation and Feature Engineering Often, you’ll need to create new calculated fields for financial analysis:\n# Add a Month column for easier grouping transactions['Month'] = transactions['Date'].dt.strftime('%Y-%m') # Add an Absolute Amount column for analysis transactions['Abs_Amount'] = transactions['Amount'].abs() # Categorize transactions by size def categorize_amount(amount): if abs(amount) \u003c 100: return 'Small' elif abs(amount) \u003c 1000: return 'Medium' else: return 'Large' transactions['Size_Category'] = transactions['Amount'].apply(categorize_amount) # Create a new column indicating if it's end of quarter transactions['Is_Quarter_End'] = transactions['Date'].dt.is_quarter_end # Add a calculated running balance transactions = transactions.sort_values('Date') transactions['Running_Balance'] = transactions['Amount'].cumsum() print(transactions.head()) Grouping and Aggregation: The Heart of Financial Analysis Grouping operations are similar to Excel’s pivot tables and are perfect for financial reporting:\n# Group by Category and calculate sum, count, and average category_summary = transactions.groupby('Category').agg({ 'Amount': ['sum', 'count', 'mean'], 'Description': 'count' # count of transactions }) print(category_summary) # Group by Month and Category to see spending trends monthly_by_category = transactions.groupby(['Month', 'Category'])['Amount'].sum().unstack() print(monthly_by_category) # Calculate monthly totals monthly_totals = transactions.groupby('Month')['Amount'].sum() print(monthly_totals) # Find the month with the highest expenses monthly_expenses = transactions[transactions['Amount'] \u003c 0].groupby('Month')['Amount'].sum() highest_expense_month = monthly_expenses.idxmin() # min because expenses are negative print(f\"Month with highest expenses: {highest_expense_month}, Amount: ${monthly_expenses.min():.2f}\") Advanced Financial Calculations Let’s implement some practical financial calculations:\n# Monthly Profit and Loss Statement monthly_pl = transactions.pivot_table( index='Month', columns='Category', values='Amount', aggfunc='sum' ).fillna(0) # Add a Profit column monthly_pl['Profit'] = monthly_pl['Income'] + monthly_pl['Expense'] # Adding because expenses are negative print(monthly_pl) # Calculate running cash balance by date daily_net = transactions.groupby('Date')['Amount'].sum().reset_index() daily_net['Running_Balance'] = daily_net['Amount'].cumsum() print(daily_net.head()) # Calculate 30-day moving average of daily transaction amounts transactions_by_date = transactions.groupby('Date')['Amount'].sum() moving_avg_30d = transactions_by_date.rolling(window=30).mean() print(moving_avg_30d.tail()) Merging and Joining Datasets In finance, we often need to combine data from multiple sources:\n# Create a sample budget DataFrame budget = pd.DataFrame({ 'Category': ['Rent', 'Utilities', 'Payroll', 'Marketing', 'Software'], 'Budgeted_Amount': [1200, 300, 5000, 1000, 500] }) # Group actual expenses by category actual_expenses = transactions[transactions['Amount'] \u003c 0].groupby('Category')['Amount'].sum().abs().reset_index() actual_expenses.columns = ['Category', 'Actual_Amount'] # Merge the budget with actual expenses budget_vs_actual = pd.merge(budget, actual_expenses, on='Category', how='outer') # Calculate variance (negative means over budget) budget_vs_actual['Variance'] = budget_vs_actual['Budgeted_Amount'] - budget_vs_actual['Actual_Amount'] budget_vs_actual['Variance_Percent'] = (budget_vs_actual['Variance'] / budget_vs_actual['Budgeted_Amount']) * 100 print(budget_vs_actual) # Find categories that are over budget over_budget = budget_vs_actual[budget_vs_actual['Variance'] \u003c 0] print(\"\\nCategories over budget:\") print(over_budget) Time Series Analysis: Perfect for Financial Data pandas has exceptional support for time series data:\n# Convert Date to datetime if not already transactions['Date'] = pd.to_datetime(transactions['Date']) # Set Date as index for time series analysis ts_data = transactions.set_index('Date') # Resample to get monthly totals monthly_data = ts_data['Amount'].resample('M').sum() print(monthly_data) # Compute rolling average (e.g., 3-month rolling revenue) income_only = ts_data[ts_data['Amount'] \u003e 0] rolling_3m_revenue = income_only['Amount'].resample('M').sum().rolling(window=3).mean() print(rolling_3m_revenue) # Calculate percent change period-over-period monthly_growth = monthly_data.pct_change() * 100 print(f\"Monthly growth rates (%):\\n{monthly_growth}\") # Seasonal decomposition from statsmodels.tsa.seasonal import seasonal_decompose # Need 2+ years of data for proper decomposition, but here's the concept: # Assuming we have enough data: # decomposition = seasonal_decompose(monthly_data, model='additive', period=12) # fig = decomposition.plot() Handling Excel-Like Functionality with pandas If you’re transitioning from Excel, pandas offers similar functionality with more power:\n# VLOOKUP equivalent product_info = pd.DataFrame({ 'Product_ID': ['A001', 'B002', 'C003', 'D004'], 'Product_Name': ['Laptop', 'Monitor', 'Keyboard', 'Mouse'], 'Unit_Cost': [1200, 300, 80, 25] }) sales = pd.DataFrame({ 'Date': ['2023-01-15', '2023-01-20', '2023-01-22', '2023-01-25'], 'Product_ID': ['A001', 'C003', 'A001', 'B002'], 'Quantity': [2, 5, 1, 3] }) # Merge sales with product info (like VLOOKUP) sales_with_info = pd.merge(sales, product_info, on='Product_ID') # Calculate total sales amount sales_with_info['Total_Cost'] = sales_with_info['Quantity'] * sales_with_info['Unit_Cost'] print(sales_with_info) # Pivot tables pivot_sales = sales_with_info.pivot_table( index='Product_Name', values=['Quantity', 'Total_Cost'], aggfunc={'Quantity': 'sum', 'Total_Cost': 'sum'} ) print(pivot_sales) # Sort by total cost (descending) print(pivot_sales.sort_values('Total_Cost', ascending=False)) Exporting and Saving Your Analysis Once your analysis is complete, you’ll often need to export the results:\n# Export as CSV budget_vs_actual.to_csv('budget_analysis.csv', index=False) # Export to Excel with pd.ExcelWriter('financial_analysis.xlsx') as writer: budget_vs_actual.to_excel(writer, sheet_name='Budget Analysis', index=False) pivot_sales.to_excel(writer, sheet_name='Sales by Product') monthly_pl.to_excel(writer, sheet_name='Monthly P\u0026L') # Export specific results to JSON (useful for web applications) over_budget.to_json('over_budget_alert.json', orient='records') Case Study: Comprehensive Financial Analysis Let’s pull everything together in a finance-focused case study:\n# 1. Load and prepare data transactions = pd.read_csv('transactions.csv') transactions['Date'] = pd.to_datetime(transactions['Date']) transactions['Month'] = transactions['Date'].dt.strftime('%Y-%m') transactions['Quarter'] = transactions['Date'].dt.to_period('Q').astype(str) # 2. Clean data transactions['Category'] = transactions['Category'].fillna('Uncategorized') transactions['Amount'] = transactions['Amount'].fillna(0) # 3. Create income and expense dataframes income = transactions[transactions['Amount'] \u003e 0] expenses = transactions[transactions['Amount'] \u003c 0] expenses['Abs_Amount'] = expenses['Amount'].abs() # Make expenses positive for easier calculations # 4. Quarterly Financial Reports quarterly_summary = pd.DataFrame({ 'Total_Income': income.groupby('Quarter')['Amount'].sum(), 'Total_Expenses': expenses.groupby('Quarter')['Abs_Amount'].sum(), }) quarterly_summary['Net_Profit'] = quarterly_summary['Total_Income'] - quarterly_summary['Total_Expenses'] quarterly_summary['Profit_Margin'] = quarterly_summary['Net_Profit'] / quarterly_summary['Total_Income'] * 100 print(\"Quarterly Financial Summary:\") print(quarterly_summary) # 5. Top 5 expense categories top_expenses = expenses.groupby('Category')['Abs_Amount'].sum().sort_values(ascending=False).head(5) print(\"\\nTop 5 Expense Categories:\") print(top_expenses) # 6. Monthly trend analysis monthly_net = pd.DataFrame({ 'Income': income.groupby('Month')['Amount'].sum(), 'Expenses': expenses.groupby('Month')['Abs_Amount'].sum() * -1 # Make expenses negative again }) monthly_net['Net'] = monthly_net['Income'] + monthly_net['Expenses'] # Net will be positive or negative monthly_net['3M_Rolling_Avg'] = monthly_net['Net'].rolling(window=3).mean() print(\"\\nMonthly Trend Analysis:\") print(monthly_net) # 7. Cash flow analysis transactions = transactions.sort_values('Date') transactions['Running_Balance'] = transactions['Amount'].cumsum() # Find any days where cash balance went negative cash_issues = transactions[transactions['Running_Balance'] \u003c 0] if not cash_issues.empty: print(\"\\nCash Flow Alert - Negative Balance Detected:\") print(cash_issues[['Date', 'Running_Balance']].head()) # 8. Year-over-year comparison (assuming we have multiple years of data) transactions['Year'] = transactions['Date'].dt.year yoy_income = income.groupby(['Year', 'Quarter'])['Amount'].sum().unstack() print(\"\\nYear-over-Year Quarterly Income:\") print(yoy_income) # 9. Export key insights to Excel with pd.ExcelWriter('financial_insights.xlsx') as writer: quarterly_summary.to_excel(writer, sheet_name='Quarterly Summary') top_expenses.to_excel(writer, sheet_name='Top Expenses') monthly_net.to_excel(writer, sheet_name='Monthly Trends') print(\"\\nFinancial analysis complete! Results exported to 'financial_insights.xlsx'\") Key Takeaways from pandas for Finance Professionals For finance and accounting professionals, pandas offers several key advantages:\nAutomation: Automate repetitive data tasks that would take hours in Excel Scale: Handle much larger datasets than Excel can manage Reproducibility: Document your analysis as code for future reference or audit Flexibility: Customize your analysis beyond what Excel templates allow Integration: Connect directly to databases, APIs, and other data sources Analysis Power: Perform complex statistical operations with minimal code Next Steps Now that you understand the basics of pandas for financial data analysis, you’re ready to move on to data visualization in our next post. We’ll explore how to transform these financial insights into compelling visualizations using Matplotlib and Seaborn!\nExercise: Financial Data Analysis Before you go, try this exercise to practice your pandas skills:\nYou have a CSV file of transactions with columns for Date, Description, Category, and Amount. Using pandas:\nCalculate the monthly income, expenses, and net profit Find the top 3 expense categories by total amount Create a month-over-month percentage change analysis of your net profit Identify any expense categories that show an increasing trend over time Good luck, and feel free to share your solutions in the comments!\nThis post is part of my journey learning Python. I’m a chartered accountant exploring programming to enhance my financial analysis toolkit. Follow along as we discover together how Python can transform our work in finance and accounting!\n","wordCount":"2183","inLanguage":"en","image":"https://michaelbrunger.com/site-feature-image.jpg","datePublished":"2025-07-17T00:00:00Z","dateModified":"2025-05-12T11:13:25+01:00","author":{"@type":"Person","name":"Michael Brunger"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michaelbrunger.com/data-analysis-with-pandas/"},"publisher":{"@type":"Organization","name":"Michael Brunger","logo":{"@type":"ImageObject","url":"https://michaelbrunger.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michaelbrunger.com/ accesskey=h title="Michael Brunger (Alt + H)">Michael Brunger</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul class="menu desktop-menu"><li><a href=https://michaelbrunger.com/ title=Home><span>Home</span></a></li><li><a href=https://michaelbrunger.com/briefs/ title="Daily Briefs"><span>Daily Briefs</span></a></li><li><a href=https://michaelbrunger.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://michaelbrunger.com/about/ title=About><span>About</span></a></li><li><a href=https://michaelbrunger.com/links/ title=Links><span>Links</span></a></li><li><a href=https://michaelbrunger.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://michaelbrunger.com/contact/ title=Contact><span>Contact</span></a></li></ul><button id=menu-trigger class=hamburger-menu aria-haspopup=menu aria-label="Menu Button"><div class=hamburger-icon><span></span>
<span></span>
<span></span>
<span></span></div></button></nav></header><div class=mobile-menu-overlay><ul class=mobile-menu><li><a href=https://michaelbrunger.com/>Home</a></li><li><a href=https://michaelbrunger.com/briefs/>Daily Briefs</a></li><li><a href=https://michaelbrunger.com/posts/>Posts</a></li><li><a href=https://michaelbrunger.com/about/>About</a></li><li><a href=https://michaelbrunger.com/links/>Links</a></li><li><a href=https://michaelbrunger.com/search/>Search</a></li><li><a href=https://michaelbrunger.com/contact/>Contact</a></li></ul></div><main class=main><div class=reading-progress-container><div class=reading-progress-bar></div></div><script>console.log("Reading progress script loaded"),document.addEventListener("DOMContentLoaded",function(){console.log("DOM Content Loaded");const e=document.querySelector(".reading-progress-bar");if(console.log("Progress bar element:",e),!e){console.log("No progress bar found");return}window.addEventListener("scroll",function(){const n=window.innerHeight,s=document.documentElement.scrollHeight-n,o=window.scrollY,t=o/s*100;e.style.width=t+"%",console.log("Progress:",t+"%")})})</script><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Part 12: Data Analysis with pandas</h1><div class=post-description>Master data analysis in Python using pandas. Learn to work with Series and DataFrame objects, import data from various sources, and perform essential data manipulation operations.</div><div class=post-meta><span class=post-date><i class="far fa-calendar-alt"></i>
July 17, 2025
</span><span class=post-lastmod><i class="fas fa-edit"></i>
Last modified: May 12, 2025
</span><span class=post-reading-time><i class="far fa-clock"></i>
11 min read</span></div></header><div class=toc><details><summary>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#why-pandas-for-finance>Why pandas for Finance?</a></li><li><a href=#installing-pandas>Installing pandas</a></li><li><a href=#the-core-pandas-data-structures>The Core pandas Data Structures</a><ul><li><a href=#series-one-dimensional-data>Series: One-Dimensional Data</a></li><li><a href=#dataframe-two-dimensional-data>DataFrame: Two-Dimensional Data</a></li></ul></li><li><a href=#reading-data-from-external-sources>Reading Data from External Sources</a><ul><li><a href=#reading-from-csv>Reading from CSV</a></li><li><a href=#reading-from-excel>Reading from Excel</a></li><li><a href=#connecting-to-databases>Connecting to Databases</a></li></ul></li><li><a href=#inspecting-and-exploring-your-data>Inspecting and Exploring Your Data</a></li><li><a href=#data-selection-and-filtering>Data Selection and Filtering</a></li><li><a href=#handling-missing-data>Handling Missing Data</a></li><li><a href=#data-transformation-and-feature-engineering>Data Transformation and Feature Engineering</a></li><li><a href=#grouping-and-aggregation-the-heart-of-financial-analysis>Grouping and Aggregation: The Heart of Financial Analysis</a></li><li><a href=#advanced-financial-calculations>Advanced Financial Calculations</a></li><li><a href=#merging-and-joining-datasets>Merging and Joining Datasets</a></li><li><a href=#time-series-analysis-perfect-for-financial-data>Time Series Analysis: Perfect for Financial Data</a></li><li><a href=#handling-excel-like-functionality-with-pandas>Handling Excel-Like Functionality with pandas</a></li><li><a href=#exporting-and-saving-your-analysis>Exporting and Saving Your Analysis</a></li><li><a href=#case-study-comprehensive-financial-analysis>Case Study: Comprehensive Financial Analysis</a></li><li><a href=#key-takeaways-from-pandas-for-finance-professionals>Key Takeaways from pandas for Finance Professionals</a></li><li><a href=#next-steps>Next Steps</a></li><li><a href=#exercise-financial-data-analysis>Exercise: Financial Data Analysis</a></li></ul></nav></details></div><div class=post-content><h1 id=data-analysis-with-pandas-for-finance-and-accounting>Data Analysis with pandas for Finance and Accounting<a hidden class=anchor aria-hidden=true href=#data-analysis-with-pandas-for-finance-and-accounting>#</a></h1><p>Welcome to post #12 in our Python journey! In the previous post, we explored NumPy and its powerful numerical capabilities. Now we&rsquo;re taking a step up to pandas, which builds on NumPy&rsquo;s foundation to provide specialized tools for working with tabular and time series data—exactly the kind of data we deal with daily in finance and accounting.</p><p>As a finance professional, I&rsquo;ve found pandas to be one of the most valuable tools in my Python toolkit. It&rsquo;s transformed how I handle everything from financial statements to transaction records. Let&rsquo;s dive in!</p><h2 id=why-pandas-for-finance>Why pandas for Finance?<a hidden class=anchor aria-hidden=true href=#why-pandas-for-finance>#</a></h2><p>pandas is specifically designed for data analysis and manipulation, with particular strengths in:</p><ul><li>Working with tabular data (like spreadsheets, CSV files, and SQL tables)</li><li>Handling time series (perfect for financial data)</li><li>Cleaning messy data (a constant challenge in real-world accounting)</li><li>Joining and merging datasets (combining data from multiple sources)</li><li>Advanced grouping and aggregation (similar to pivot tables in Excel)</li></ul><p>If you&rsquo;ve spent hours manipulating data in Excel, pandas will feel both familiar yet incredibly more powerful—think Excel on steroids with the automation capabilities of Python.</p><h2 id=installing-pandas>Installing pandas<a hidden class=anchor aria-hidden=true href=#installing-pandas>#</a></h2><p>Let&rsquo;s start by installing pandas:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>pip install pandas
</span></span></code></pre></div><p>If you&rsquo;re using Anaconda, pandas is already included in the distribution.</p><p>Let&rsquo;s verify the installation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>print(pd<span style=color:#f92672>.</span>__version__)
</span></span></code></pre></div><p>You should see the version number displayed (like <code>2.0.3</code> or similar). By convention, pandas is imported with the alias <code>pd</code> to make your code more readable.</p><h2 id=the-core-pandas-data-structures>The Core pandas Data Structures<a hidden class=anchor aria-hidden=true href=#the-core-pandas-data-structures>#</a></h2><p>pandas provides two primary data structures:</p><ol><li><strong>Series</strong>: A one-dimensional labeled array (like a column in a spreadsheet)</li><li><strong>DataFrame</strong>: A two-dimensional labeled data structure with columns (like a spreadsheet or SQL table)</li></ol><p>Let&rsquo;s explore both with financial examples.</p><h3 id=series-one-dimensional-data>Series: One-Dimensional Data<a hidden class=anchor aria-hidden=true href=#series-one-dimensional-data>#</a></h3><p>A Series is essentially a column of data with labeled indices:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a Series of monthly expenses</span>
</span></span><span style=display:flex><span>monthly_expenses <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>Series([<span style=color:#ae81ff>1200</span>, <span style=color:#ae81ff>1500</span>, <span style=color:#ae81ff>1100</span>, <span style=color:#ae81ff>1800</span>], 
</span></span><span style=display:flex><span>                            index<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Rent&#39;</span>, <span style=color:#e6db74>&#39;Payroll&#39;</span>, <span style=color:#e6db74>&#39;Utilities&#39;</span>, <span style=color:#e6db74>&#39;Inventory&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(monthly_expenses)
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Rent         1200</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Payroll      1500</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Utilities    1100</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Inventory    1800</span>
</span></span><span style=display:flex><span><span style=color:#75715e># dtype: int64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Access by label</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Monthly rent: $</span><span style=color:#e6db74>{</span>monthly_expenses[<span style=color:#e6db74>&#39;Rent&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e># Output: Monthly rent: $1200</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Access by position</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Second highest expense: $</span><span style=color:#e6db74>{</span>monthly_expenses<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e># Output: Second highest expense: $1500</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Perform calculations</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total monthly expenses: $</span><span style=color:#e6db74>{</span>monthly_expenses<span style=color:#f92672>.</span>sum()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e># Output: Total monthly expenses: $5600</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Average expense: $</span><span style=color:#e6db74>{</span>monthly_expenses<span style=color:#f92672>.</span>mean()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e># Output: Average expense: $1400</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Filter expenses greater than 1200</span>
</span></span><span style=display:flex><span>high_expenses <span style=color:#f92672>=</span> monthly_expenses[monthly_expenses <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1200</span>]
</span></span><span style=display:flex><span>print(high_expenses)
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Payroll      1500</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Inventory    1800</span>
</span></span><span style=display:flex><span><span style=color:#75715e># dtype: int64</span>
</span></span></code></pre></div><p>Series are useful for representing:</p><ul><li>A single financial metric across multiple companies</li><li>Monthly or yearly values for a specific account</li><li>Daily stock prices</li></ul><h3 id=dataframe-two-dimensional-data>DataFrame: Two-Dimensional Data<a hidden class=anchor aria-hidden=true href=#dataframe-two-dimensional-data>#</a></h3><p>DataFrames are where pandas really shines. Think of them as an Excel spreadsheet within Python:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Create a DataFrame representing a simplified income statement</span>
</span></span><span style=display:flex><span>income_statement <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Q1&#39;</span>: [<span style=color:#ae81ff>100000</span>, <span style=color:#ae81ff>45000</span>, <span style=color:#ae81ff>15000</span>, <span style=color:#ae81ff>40000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Q2&#39;</span>: [<span style=color:#ae81ff>110000</span>, <span style=color:#ae81ff>47000</span>, <span style=color:#ae81ff>15000</span>, <span style=color:#ae81ff>48000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Q3&#39;</span>: [<span style=color:#ae81ff>95000</span>, <span style=color:#ae81ff>42000</span>, <span style=color:#ae81ff>16000</span>, <span style=color:#ae81ff>37000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Q4&#39;</span>: [<span style=color:#ae81ff>125000</span>, <span style=color:#ae81ff>52000</span>, <span style=color:#ae81ff>17000</span>, <span style=color:#ae81ff>56000</span>]
</span></span><span style=display:flex><span>}, index<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Revenue&#39;</span>, <span style=color:#e6db74>&#39;COGS&#39;</span>, <span style=color:#e6db74>&#39;Operating Expenses&#39;</span>, <span style=color:#e6db74>&#39;Net Income&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(income_statement)
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#                      Q1     Q2     Q3     Q4</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Revenue          100000 110000  95000 125000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># COGS              45000  47000  42000  52000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Operating Expenses 15000  15000  16000  17000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Net Income        40000  48000  37000  56000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or create the same DataFrame with a different orientation</span>
</span></span><span style=display:flex><span><span style=color:#75715e># (More commonly used format with rows as observations and columns as variables)</span>
</span></span><span style=display:flex><span>income_statement_alt <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Quarter&#39;</span>: [<span style=color:#e6db74>&#39;Q1&#39;</span>, <span style=color:#e6db74>&#39;Q2&#39;</span>, <span style=color:#e6db74>&#39;Q3&#39;</span>, <span style=color:#e6db74>&#39;Q4&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Revenue&#39;</span>: [<span style=color:#ae81ff>100000</span>, <span style=color:#ae81ff>110000</span>, <span style=color:#ae81ff>95000</span>, <span style=color:#ae81ff>125000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;COGS&#39;</span>: [<span style=color:#ae81ff>45000</span>, <span style=color:#ae81ff>47000</span>, <span style=color:#ae81ff>42000</span>, <span style=color:#ae81ff>52000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Operating_Expenses&#39;</span>: [<span style=color:#ae81ff>15000</span>, <span style=color:#ae81ff>15000</span>, <span style=color:#ae81ff>16000</span>, <span style=color:#ae81ff>17000</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Net_Income&#39;</span>: [<span style=color:#ae81ff>40000</span>, <span style=color:#ae81ff>48000</span>, <span style=color:#ae81ff>37000</span>, <span style=color:#ae81ff>56000</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(income_statement_alt)
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   Quarter  Revenue   COGS  Operating_Expenses  Net_Income</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0      Q1   100000  45000               15000       40000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1      Q2   110000  47000               15000       48000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2      Q3    95000  42000               16000       37000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3      Q4   125000  52000               17000       56000</span>
</span></span></code></pre></div><p>The orientation you choose often depends on your data and analysis goals. For financial data:</p><ul><li>Use index for time periods and columns for accounts when tracking few accounts over time</li><li>Use rows for time periods and columns for accounts when tracking many accounts</li></ul><h2 id=reading-data-from-external-sources>Reading Data from External Sources<a hidden class=anchor aria-hidden=true href=#reading-data-from-external-sources>#</a></h2><p>In real-world finance, data often comes from external files. pandas excels at importing from various sources:</p><h3 id=reading-from-csv>Reading from CSV<a hidden class=anchor aria-hidden=true href=#reading-from-csv>#</a></h3><p>CSVs are common for exporting financial data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Read a transaction register CSV file</span>
</span></span><span style=display:flex><span><span style=color:#75715e># transactions.csv contains: Date,Description,Category,Amount</span>
</span></span><span style=display:flex><span>transactions <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;transactions.csv&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Preview the first 5 rows</span>
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#         Date               Description    Category  Amount</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0  2023-01-05          Office Supplies    Expense   -89.99</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1  2023-01-07  Client Payment - ABC Inc     Income  1250.00</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2  2023-01-10                   Payroll    Expense -4500.00</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3  2023-01-15           Software License    Expense  -199.99</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4  2023-01-18            Bank Interest     Income     2.13</span>
</span></span></code></pre></div><h3 id=reading-from-excel>Reading from Excel<a hidden class=anchor aria-hidden=true href=#reading-from-excel>#</a></h3><p>Excel files are ubiquitous in finance and accounting:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Install openpyxl first if you haven&#39;t:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pip install openpyxl</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Read an Excel file, specifying the sheet</span>
</span></span><span style=display:flex><span>financial_data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_excel(<span style=color:#e6db74>&#39;financial_model.xlsx&#39;</span>, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Income Statement&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Preview the data</span>
</span></span><span style=display:flex><span>print(financial_data<span style=color:#f92672>.</span>head())
</span></span></code></pre></div><h3 id=connecting-to-databases>Connecting to Databases<a hidden class=anchor aria-hidden=true href=#connecting-to-databases>#</a></h3><p>For more enterprise-level finance applications:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># pip install sqlalchemy</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pip install pymysql (or other database driver)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sqlalchemy <span style=color:#f92672>import</span> create_engine
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Connect to database (example with MySQL)</span>
</span></span><span style=display:flex><span>engine <span style=color:#f92672>=</span> create_engine(<span style=color:#e6db74>&#39;mysql+pymysql://username:password@localhost/finance_db&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Read data directly from SQL query</span>
</span></span><span style=display:flex><span>sql_query <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT * FROM general_ledger WHERE account_type = &#39;Asset&#39; AND transaction_date &gt; &#39;2023-01-01&#39;&#34;</span>
</span></span><span style=display:flex><span>gl_data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_sql(sql_query, engine)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(gl_data<span style=color:#f92672>.</span>head())
</span></span></code></pre></div><h2 id=inspecting-and-exploring-your-data>Inspecting and Exploring Your Data<a hidden class=anchor aria-hidden=true href=#inspecting-and-exploring-your-data>#</a></h2><p>When you receive a new financial dataset, your first step is usually to understand its structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Assuming we&#39;ve loaded our transactions data</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Data shape (rows, columns): </span><span style=color:#e6db74>{</span>transactions<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Column names:&#34;</span>)
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>columns<span style=color:#f92672>.</span>tolist())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Data types:&#34;</span>)
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>dtypes)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Summary statistics:&#34;</span>)
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>describe())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Missing values:&#34;</span>)
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>isnull()<span style=color:#f92672>.</span>sum())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check for duplicates</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Duplicate rows: </span><span style=color:#e6db74>{</span>transactions<span style=color:#f92672>.</span>duplicated()<span style=color:#f92672>.</span>sum()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=data-selection-and-filtering>Data Selection and Filtering<a hidden class=anchor aria-hidden=true href=#data-selection-and-filtering>#</a></h2><p>pandas offers powerful ways to select and filter data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Select specific columns</span>
</span></span><span style=display:flex><span>amounts_and_categories <span style=color:#f92672>=</span> transactions[[<span style=color:#e6db74>&#39;Category&#39;</span>, <span style=color:#e6db74>&#39;Amount&#39;</span>]]
</span></span><span style=display:flex><span>print(amounts_and_categories<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Filter rows based on conditions</span>
</span></span><span style=display:flex><span>expenses <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>income <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total expenses: $</span><span style=color:#e6db74>{</span>expenses[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total income: $</span><span style=color:#e6db74>{</span>income[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Filter with multiple conditions</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find large office expenses</span>
</span></span><span style=display:flex><span>large_office_expenses <span style=color:#f92672>=</span> transactions[
</span></span><span style=display:flex><span>    (transactions[<span style=color:#e6db74>&#39;Category&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Expense&#39;</span>) <span style=color:#f92672>&amp;</span> 
</span></span><span style=display:flex><span>    (transactions[<span style=color:#e6db74>&#39;Description&#39;</span>]<span style=color:#f92672>.</span>str<span style=color:#f92672>.</span>contains(<span style=color:#e6db74>&#39;Office&#39;</span>)) <span style=color:#f92672>&amp;</span> 
</span></span><span style=display:flex><span>    (transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>print(large_office_expenses)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Select data from a specific date range</span>
</span></span><span style=display:flex><span><span style=color:#75715e># First, ensure Date is a datetime type</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Date&#39;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(transactions[<span style=color:#e6db74>&#39;Date&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Filter for Q1 data</span>
</span></span><span style=display:flex><span>q1_data <span style=color:#f92672>=</span> transactions[(transactions[<span style=color:#e6db74>&#39;Date&#39;</span>] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;2023-01-01&#39;</span>) <span style=color:#f92672>&amp;</span> 
</span></span><span style=display:flex><span>                       (transactions[<span style=color:#e6db74>&#39;Date&#39;</span>] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;2023-03-31&#39;</span>)]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Q1 transaction count: </span><span style=color:#e6db74>{</span>len(q1_data)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=handling-missing-data>Handling Missing Data<a hidden class=anchor aria-hidden=true href=#handling-missing-data>#</a></h2><p>Missing data is a common challenge in financial datasets:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Check for missing values</span>
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>isnull()<span style=color:#f92672>.</span>sum())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fill missing values in Amount column with 0</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fill missing categories with &#39;Uncategorized&#39;</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Category&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Category&#39;</span>]<span style=color:#f92672>.</span>fillna(<span style=color:#e6db74>&#39;Uncategorized&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Drop rows with any remaining missing values</span>
</span></span><span style=display:flex><span>transactions_clean <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>dropna()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Alternative: Only drop rows where specific columns are missing</span>
</span></span><span style=display:flex><span>transactions_essential <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>dropna(subset<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Amount&#39;</span>])
</span></span></code></pre></div><h2 id=data-transformation-and-feature-engineering>Data Transformation and Feature Engineering<a hidden class=anchor aria-hidden=true href=#data-transformation-and-feature-engineering>#</a></h2><p>Often, you&rsquo;ll need to create new calculated fields for financial analysis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Add a Month column for easier grouping</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Month&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add an Absolute Amount column for analysis</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Abs_Amount&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>abs()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Categorize transactions by size</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>categorize_amount</span>(amount):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> abs(amount) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>100</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;Small&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> abs(amount) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1000</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;Medium&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;Large&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Size_Category&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>apply(categorize_amount)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a new column indicating if it&#39;s end of quarter</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Is_Quarter_End&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>is_quarter_end
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add a calculated running balance</span>
</span></span><span style=display:flex><span>transactions <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>sort_values(<span style=color:#e6db74>&#39;Date&#39;</span>)
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Running_Balance&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>cumsum()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(transactions<span style=color:#f92672>.</span>head())
</span></span></code></pre></div><h2 id=grouping-and-aggregation-the-heart-of-financial-analysis>Grouping and Aggregation: The Heart of Financial Analysis<a hidden class=anchor aria-hidden=true href=#grouping-and-aggregation-the-heart-of-financial-analysis>#</a></h2><p>Grouping operations are similar to Excel&rsquo;s pivot tables and are perfect for financial reporting:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Group by Category and calculate sum, count, and average</span>
</span></span><span style=display:flex><span>category_summary <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Category&#39;</span>)<span style=color:#f92672>.</span>agg({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Amount&#39;</span>: [<span style=color:#e6db74>&#39;sum&#39;</span>, <span style=color:#e6db74>&#39;count&#39;</span>, <span style=color:#e6db74>&#39;mean&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Description&#39;</span>: <span style=color:#e6db74>&#39;count&#39;</span>  <span style=color:#75715e># count of transactions</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(category_summary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Group by Month and Category to see spending trends</span>
</span></span><span style=display:flex><span>monthly_by_category <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;Month&#39;</span>, <span style=color:#e6db74>&#39;Category&#39;</span>])[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>unstack()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(monthly_by_category)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate monthly totals</span>
</span></span><span style=display:flex><span>monthly_totals <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Month&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()
</span></span><span style=display:flex><span>print(monthly_totals)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find the month with the highest expenses</span>
</span></span><span style=display:flex><span>monthly_expenses <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Month&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()
</span></span><span style=display:flex><span>highest_expense_month <span style=color:#f92672>=</span> monthly_expenses<span style=color:#f92672>.</span>idxmin()  <span style=color:#75715e># min because expenses are negative</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Month with highest expenses: </span><span style=color:#e6db74>{</span>highest_expense_month<span style=color:#e6db74>}</span><span style=color:#e6db74>, Amount: $</span><span style=color:#e6db74>{</span>monthly_expenses<span style=color:#f92672>.</span>min()<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=advanced-financial-calculations>Advanced Financial Calculations<a hidden class=anchor aria-hidden=true href=#advanced-financial-calculations>#</a></h2><p>Let&rsquo;s implement some practical financial calculations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Monthly Profit and Loss Statement</span>
</span></span><span style=display:flex><span>monthly_pl <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>pivot_table(
</span></span><span style=display:flex><span>    index<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Month&#39;</span>,
</span></span><span style=display:flex><span>    columns<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Category&#39;</span>,
</span></span><span style=display:flex><span>    values<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Amount&#39;</span>,
</span></span><span style=display:flex><span>    aggfunc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;sum&#39;</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add a Profit column</span>
</span></span><span style=display:flex><span>monthly_pl[<span style=color:#e6db74>&#39;Profit&#39;</span>] <span style=color:#f92672>=</span> monthly_pl[<span style=color:#e6db74>&#39;Income&#39;</span>] <span style=color:#f92672>+</span> monthly_pl[<span style=color:#e6db74>&#39;Expense&#39;</span>]  <span style=color:#75715e># Adding because expenses are negative</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(monthly_pl)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate running cash balance by date</span>
</span></span><span style=display:flex><span>daily_net <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Date&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>reset_index()
</span></span><span style=display:flex><span>daily_net[<span style=color:#e6db74>&#39;Running_Balance&#39;</span>] <span style=color:#f92672>=</span> daily_net[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>cumsum()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(daily_net<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate 30-day moving average of daily transaction amounts</span>
</span></span><span style=display:flex><span>transactions_by_date <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Date&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()
</span></span><span style=display:flex><span>moving_avg_30d <span style=color:#f92672>=</span> transactions_by_date<span style=color:#f92672>.</span>rolling(window<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>)<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(moving_avg_30d<span style=color:#f92672>.</span>tail())
</span></span></code></pre></div><h2 id=merging-and-joining-datasets>Merging and Joining Datasets<a hidden class=anchor aria-hidden=true href=#merging-and-joining-datasets>#</a></h2><p>In finance, we often need to combine data from multiple sources:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Create a sample budget DataFrame</span>
</span></span><span style=display:flex><span>budget <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Category&#39;</span>: [<span style=color:#e6db74>&#39;Rent&#39;</span>, <span style=color:#e6db74>&#39;Utilities&#39;</span>, <span style=color:#e6db74>&#39;Payroll&#39;</span>, <span style=color:#e6db74>&#39;Marketing&#39;</span>, <span style=color:#e6db74>&#39;Software&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Budgeted_Amount&#39;</span>: [<span style=color:#ae81ff>1200</span>, <span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>5000</span>, <span style=color:#ae81ff>1000</span>, <span style=color:#ae81ff>500</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Group actual expenses by category</span>
</span></span><span style=display:flex><span>actual_expenses <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Category&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>abs()<span style=color:#f92672>.</span>reset_index()
</span></span><span style=display:flex><span>actual_expenses<span style=color:#f92672>.</span>columns <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Category&#39;</span>, <span style=color:#e6db74>&#39;Actual_Amount&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Merge the budget with actual expenses</span>
</span></span><span style=display:flex><span>budget_vs_actual <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>merge(budget, actual_expenses, on<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Category&#39;</span>, how<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;outer&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate variance (negative means over budget)</span>
</span></span><span style=display:flex><span>budget_vs_actual[<span style=color:#e6db74>&#39;Variance&#39;</span>] <span style=color:#f92672>=</span> budget_vs_actual[<span style=color:#e6db74>&#39;Budgeted_Amount&#39;</span>] <span style=color:#f92672>-</span> budget_vs_actual[<span style=color:#e6db74>&#39;Actual_Amount&#39;</span>]
</span></span><span style=display:flex><span>budget_vs_actual[<span style=color:#e6db74>&#39;Variance_Percent&#39;</span>] <span style=color:#f92672>=</span> (budget_vs_actual[<span style=color:#e6db74>&#39;Variance&#39;</span>] <span style=color:#f92672>/</span> budget_vs_actual[<span style=color:#e6db74>&#39;Budgeted_Amount&#39;</span>]) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(budget_vs_actual)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find categories that are over budget</span>
</span></span><span style=display:flex><span>over_budget <span style=color:#f92672>=</span> budget_vs_actual[budget_vs_actual[<span style=color:#e6db74>&#39;Variance&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Categories over budget:&#34;</span>)
</span></span><span style=display:flex><span>print(over_budget)
</span></span></code></pre></div><h2 id=time-series-analysis-perfect-for-financial-data>Time Series Analysis: Perfect for Financial Data<a hidden class=anchor aria-hidden=true href=#time-series-analysis-perfect-for-financial-data>#</a></h2><p>pandas has exceptional support for time series data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Convert Date to datetime if not already</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Date&#39;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(transactions[<span style=color:#e6db74>&#39;Date&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set Date as index for time series analysis</span>
</span></span><span style=display:flex><span>ts_data <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#39;Date&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Resample to get monthly totals</span>
</span></span><span style=display:flex><span>monthly_data <span style=color:#f92672>=</span> ts_data[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>resample(<span style=color:#e6db74>&#39;M&#39;</span>)<span style=color:#f92672>.</span>sum()
</span></span><span style=display:flex><span>print(monthly_data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Compute rolling average (e.g., 3-month rolling revenue)</span>
</span></span><span style=display:flex><span>income_only <span style=color:#f92672>=</span> ts_data[ts_data[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>rolling_3m_revenue <span style=color:#f92672>=</span> income_only[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>resample(<span style=color:#e6db74>&#39;M&#39;</span>)<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>rolling(window<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>print(rolling_3m_revenue)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate percent change period-over-period</span>
</span></span><span style=display:flex><span>monthly_growth <span style=color:#f92672>=</span> monthly_data<span style=color:#f92672>.</span>pct_change() <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Monthly growth rates (%):</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>monthly_growth<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Seasonal decomposition</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> statsmodels.tsa.seasonal <span style=color:#f92672>import</span> seasonal_decompose
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Need 2+ years of data for proper decomposition, but here&#39;s the concept:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Assuming we have enough data:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># decomposition = seasonal_decompose(monthly_data, model=&#39;additive&#39;, period=12)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># fig = decomposition.plot()</span>
</span></span></code></pre></div><h2 id=handling-excel-like-functionality-with-pandas>Handling Excel-Like Functionality with pandas<a hidden class=anchor aria-hidden=true href=#handling-excel-like-functionality-with-pandas>#</a></h2><p>If you&rsquo;re transitioning from Excel, pandas offers similar functionality with more power:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># VLOOKUP equivalent</span>
</span></span><span style=display:flex><span>product_info <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Product_ID&#39;</span>: [<span style=color:#e6db74>&#39;A001&#39;</span>, <span style=color:#e6db74>&#39;B002&#39;</span>, <span style=color:#e6db74>&#39;C003&#39;</span>, <span style=color:#e6db74>&#39;D004&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Product_Name&#39;</span>: [<span style=color:#e6db74>&#39;Laptop&#39;</span>, <span style=color:#e6db74>&#39;Monitor&#39;</span>, <span style=color:#e6db74>&#39;Keyboard&#39;</span>, <span style=color:#e6db74>&#39;Mouse&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Unit_Cost&#39;</span>: [<span style=color:#ae81ff>1200</span>, <span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>25</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sales <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Date&#39;</span>: [<span style=color:#e6db74>&#39;2023-01-15&#39;</span>, <span style=color:#e6db74>&#39;2023-01-20&#39;</span>, <span style=color:#e6db74>&#39;2023-01-22&#39;</span>, <span style=color:#e6db74>&#39;2023-01-25&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Product_ID&#39;</span>: [<span style=color:#e6db74>&#39;A001&#39;</span>, <span style=color:#e6db74>&#39;C003&#39;</span>, <span style=color:#e6db74>&#39;A001&#39;</span>, <span style=color:#e6db74>&#39;B002&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Quantity&#39;</span>: [<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Merge sales with product info (like VLOOKUP)</span>
</span></span><span style=display:flex><span>sales_with_info <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>merge(sales, product_info, on<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Product_ID&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate total sales amount</span>
</span></span><span style=display:flex><span>sales_with_info[<span style=color:#e6db74>&#39;Total_Cost&#39;</span>] <span style=color:#f92672>=</span> sales_with_info[<span style=color:#e6db74>&#39;Quantity&#39;</span>] <span style=color:#f92672>*</span> sales_with_info[<span style=color:#e6db74>&#39;Unit_Cost&#39;</span>]
</span></span><span style=display:flex><span>print(sales_with_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Pivot tables</span>
</span></span><span style=display:flex><span>pivot_sales <span style=color:#f92672>=</span> sales_with_info<span style=color:#f92672>.</span>pivot_table(
</span></span><span style=display:flex><span>    index<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Product_Name&#39;</span>,
</span></span><span style=display:flex><span>    values<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Quantity&#39;</span>, <span style=color:#e6db74>&#39;Total_Cost&#39;</span>],
</span></span><span style=display:flex><span>    aggfunc<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;Quantity&#39;</span>: <span style=color:#e6db74>&#39;sum&#39;</span>, <span style=color:#e6db74>&#39;Total_Cost&#39;</span>: <span style=color:#e6db74>&#39;sum&#39;</span>}
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(pivot_sales)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Sort by total cost (descending)</span>
</span></span><span style=display:flex><span>print(pivot_sales<span style=color:#f92672>.</span>sort_values(<span style=color:#e6db74>&#39;Total_Cost&#39;</span>, ascending<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>))
</span></span></code></pre></div><h2 id=exporting-and-saving-your-analysis>Exporting and Saving Your Analysis<a hidden class=anchor aria-hidden=true href=#exporting-and-saving-your-analysis>#</a></h2><p>Once your analysis is complete, you&rsquo;ll often need to export the results:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Export as CSV</span>
</span></span><span style=display:flex><span>budget_vs_actual<span style=color:#f92672>.</span>to_csv(<span style=color:#e6db74>&#39;budget_analysis.csv&#39;</span>, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Export to Excel</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> pd<span style=color:#f92672>.</span>ExcelWriter(<span style=color:#e6db74>&#39;financial_analysis.xlsx&#39;</span>) <span style=color:#66d9ef>as</span> writer:
</span></span><span style=display:flex><span>    budget_vs_actual<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Budget Analysis&#39;</span>, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    pivot_sales<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Sales by Product&#39;</span>)
</span></span><span style=display:flex><span>    monthly_pl<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Monthly P&amp;L&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e># Export specific results to JSON (useful for web applications)</span>
</span></span><span style=display:flex><span>over_budget<span style=color:#f92672>.</span>to_json(<span style=color:#e6db74>&#39;over_budget_alert.json&#39;</span>, orient<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;records&#39;</span>)
</span></span></code></pre></div><h2 id=case-study-comprehensive-financial-analysis>Case Study: Comprehensive Financial Analysis<a hidden class=anchor aria-hidden=true href=#case-study-comprehensive-financial-analysis>#</a></h2><p>Let&rsquo;s pull everything together in a finance-focused case study:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 1. Load and prepare data</span>
</span></span><span style=display:flex><span>transactions <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#39;transactions.csv&#39;</span>)
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Date&#39;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(transactions[<span style=color:#e6db74>&#39;Date&#39;</span>])
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Month&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m&#39;</span>)
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Quarter&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>to_period(<span style=color:#e6db74>&#39;Q&#39;</span>)<span style=color:#f92672>.</span>astype(str)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Clean data</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Category&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Category&#39;</span>]<span style=color:#f92672>.</span>fillna(<span style=color:#e6db74>&#39;Uncategorized&#39;</span>)
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. Create income and expense dataframes</span>
</span></span><span style=display:flex><span>income <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>expenses <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>expenses[<span style=color:#e6db74>&#39;Abs_Amount&#39;</span>] <span style=color:#f92672>=</span> expenses[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>abs()  <span style=color:#75715e># Make expenses positive for easier calculations</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. Quarterly Financial Reports</span>
</span></span><span style=display:flex><span>quarterly_summary <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Total_Income&#39;</span>: income<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Quarter&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Total_Expenses&#39;</span>: expenses<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Quarter&#39;</span>)[<span style=color:#e6db74>&#39;Abs_Amount&#39;</span>]<span style=color:#f92672>.</span>sum(),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>quarterly_summary[<span style=color:#e6db74>&#39;Net_Profit&#39;</span>] <span style=color:#f92672>=</span> quarterly_summary[<span style=color:#e6db74>&#39;Total_Income&#39;</span>] <span style=color:#f92672>-</span> quarterly_summary[<span style=color:#e6db74>&#39;Total_Expenses&#39;</span>]
</span></span><span style=display:flex><span>quarterly_summary[<span style=color:#e6db74>&#39;Profit_Margin&#39;</span>] <span style=color:#f92672>=</span> quarterly_summary[<span style=color:#e6db74>&#39;Net_Profit&#39;</span>] <span style=color:#f92672>/</span> quarterly_summary[<span style=color:#e6db74>&#39;Total_Income&#39;</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Quarterly Financial Summary:&#34;</span>)
</span></span><span style=display:flex><span>print(quarterly_summary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. Top 5 expense categories</span>
</span></span><span style=display:flex><span>top_expenses <span style=color:#f92672>=</span> expenses<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Category&#39;</span>)[<span style=color:#e6db74>&#39;Abs_Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>sort_values(ascending<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)<span style=color:#f92672>.</span>head(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Top 5 Expense Categories:&#34;</span>)
</span></span><span style=display:flex><span>print(top_expenses)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. Monthly trend analysis</span>
</span></span><span style=display:flex><span>monthly_net <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Income&#39;</span>: income<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Month&#39;</span>)[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Expenses&#39;</span>: expenses<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Month&#39;</span>)[<span style=color:#e6db74>&#39;Abs_Amount&#39;</span>]<span style=color:#f92672>.</span>sum() <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>  <span style=color:#75715e># Make expenses negative again</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>monthly_net[<span style=color:#e6db74>&#39;Net&#39;</span>] <span style=color:#f92672>=</span> monthly_net[<span style=color:#e6db74>&#39;Income&#39;</span>] <span style=color:#f92672>+</span> monthly_net[<span style=color:#e6db74>&#39;Expenses&#39;</span>]  <span style=color:#75715e># Net will be positive or negative</span>
</span></span><span style=display:flex><span>monthly_net[<span style=color:#e6db74>&#39;3M_Rolling_Avg&#39;</span>] <span style=color:#f92672>=</span> monthly_net[<span style=color:#e6db74>&#39;Net&#39;</span>]<span style=color:#f92672>.</span>rolling(window<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Monthly Trend Analysis:&#34;</span>)
</span></span><span style=display:flex><span>print(monthly_net)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 7. Cash flow analysis</span>
</span></span><span style=display:flex><span>transactions <span style=color:#f92672>=</span> transactions<span style=color:#f92672>.</span>sort_values(<span style=color:#e6db74>&#39;Date&#39;</span>)
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Running_Balance&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>cumsum()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Find any days where cash balance went negative</span>
</span></span><span style=display:flex><span>cash_issues <span style=color:#f92672>=</span> transactions[transactions[<span style=color:#e6db74>&#39;Running_Balance&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> cash_issues<span style=color:#f92672>.</span>empty:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Cash Flow Alert - Negative Balance Detected:&#34;</span>)
</span></span><span style=display:flex><span>    print(cash_issues[[<span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Running_Balance&#39;</span>]]<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 8. Year-over-year comparison (assuming we have multiple years of data)</span>
</span></span><span style=display:flex><span>transactions[<span style=color:#e6db74>&#39;Year&#39;</span>] <span style=color:#f92672>=</span> transactions[<span style=color:#e6db74>&#39;Date&#39;</span>]<span style=color:#f92672>.</span>dt<span style=color:#f92672>.</span>year
</span></span><span style=display:flex><span>yoy_income <span style=color:#f92672>=</span> income<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;Year&#39;</span>, <span style=color:#e6db74>&#39;Quarter&#39;</span>])[<span style=color:#e6db74>&#39;Amount&#39;</span>]<span style=color:#f92672>.</span>sum()<span style=color:#f92672>.</span>unstack()
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Year-over-Year Quarterly Income:&#34;</span>)
</span></span><span style=display:flex><span>print(yoy_income)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 9. Export key insights to Excel</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> pd<span style=color:#f92672>.</span>ExcelWriter(<span style=color:#e6db74>&#39;financial_insights.xlsx&#39;</span>) <span style=color:#66d9ef>as</span> writer:
</span></span><span style=display:flex><span>    quarterly_summary<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Quarterly Summary&#39;</span>)
</span></span><span style=display:flex><span>    top_expenses<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Top Expenses&#39;</span>)
</span></span><span style=display:flex><span>    monthly_net<span style=color:#f92672>.</span>to_excel(writer, sheet_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Monthly Trends&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Financial analysis complete! Results exported to &#39;financial_insights.xlsx&#39;&#34;</span>)
</span></span></code></pre></div><h2 id=key-takeaways-from-pandas-for-finance-professionals>Key Takeaways from pandas for Finance Professionals<a hidden class=anchor aria-hidden=true href=#key-takeaways-from-pandas-for-finance-professionals>#</a></h2><p>For finance and accounting professionals, pandas offers several key advantages:</p><ol><li><strong>Automation</strong>: Automate repetitive data tasks that would take hours in Excel</li><li><strong>Scale</strong>: Handle much larger datasets than Excel can manage</li><li><strong>Reproducibility</strong>: Document your analysis as code for future reference or audit</li><li><strong>Flexibility</strong>: Customize your analysis beyond what Excel templates allow</li><li><strong>Integration</strong>: Connect directly to databases, APIs, and other data sources</li><li><strong>Analysis Power</strong>: Perform complex statistical operations with minimal code</li></ol><h2 id=next-steps>Next Steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h2><p>Now that you understand the basics of pandas for financial data analysis, you&rsquo;re ready to move on to data visualization in our next post. We&rsquo;ll explore how to transform these financial insights into compelling visualizations using Matplotlib and Seaborn!</p><h2 id=exercise-financial-data-analysis>Exercise: Financial Data Analysis<a hidden class=anchor aria-hidden=true href=#exercise-financial-data-analysis>#</a></h2><p>Before you go, try this exercise to practice your pandas skills:</p><p>You have a CSV file of transactions with columns for Date, Description, Category, and Amount. Using pandas:</p><ol><li>Calculate the monthly income, expenses, and net profit</li><li>Find the top 3 expense categories by total amount</li><li>Create a month-over-month percentage change analysis of your net profit</li><li>Identify any expense categories that show an increasing trend over time</li></ol><p>Good luck, and feel free to share your solutions in the comments!</p><hr><p><em>This post is part of my journey learning Python. I&rsquo;m a chartered accountant exploring programming to enhance my financial analysis toolkit. Follow along as we discover together how Python can transform our work in finance and accounting!</em></p></div><div class=related-posts><h2>Related Posts</h2><div class=related-posts-grid><article class=related-post><a href=https://michaelbrunger.com/python-next-steps-advanced-topics/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 17: Next Steps & Advanced Python Topics</h3><p class=related-post-description>Explore advanced Python topics including concurrency, asyncio, and complete an end-to-end project. Discover resources for further learning and tips for continuing your Python journey.</p><div class=related-post-meta><time datetime=2025-08-21>August 21, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=https://michaelbrunger.com/simple-gui-applications-tkinter/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 16: Building Simple GUI Applications with Tkinter</h3><p class=related-post-description>Create desktop applications with Python's built-in Tkinter library. Learn about widgets, layout managers, and build a practical mini-project with a graphical user interface.</p><div class=related-post-meta><time datetime=2025-08-14>August 14, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=https://michaelbrunger.com/python-web-development-foundations/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 15: Web Development Foundations with Python</h3><p class=related-post-description>Explore web development options in Python. Learn Flask for lightweight applications, Django for full-featured sites, or web scraping with requests and BeautifulSoup. Deploy your first web app.</p><div class=related-post-meta><time datetime=2025-08-07>August 7, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://michaelbrunger.com/tags/python>python</a></li><li><a href=https://michaelbrunger.com/tags/pandas>pandas</a></li><li><a href=https://michaelbrunger.com/tags/data-analysis>data analysis</a></li><li><a href=https://michaelbrunger.com/tags/dataframe>dataframe</a></li><li><a href=https://michaelbrunger.com/tags/csv>csv</a></li><li><a href=https://michaelbrunger.com/tags/excel>excel</a></li><li><a href=https://michaelbrunger.com/tags/data-manipulation>data manipulation</a></li><li><a href=https://michaelbrunger.com/tags/data-cleaning>data cleaning</a></li></ul><div class=share-buttons><a href="https://twitter.com/intent/tweet?text=Part%2012%3a%20Data%20Analysis%20with%20pandas&url=https%3a%2f%2fmichaelbrunger.com%2fdata-analysis-with-pandas%2f" target=_blank rel=noopener aria-label="Share on Twitter"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fmichaelbrunger.com%2fdata-analysis-with-pandas%2f" target=_blank rel=noopener aria-label="Share on LinkedIn"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmichaelbrunger.com%2fdata-analysis-with-pandas%2f" target=_blank rel=noopener aria-label="Share on Facebook"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</a><a href="https://wa.me/?text=Part%2012%3a%20Data%20Analysis%20with%20pandas%20https%3a%2f%2fmichaelbrunger.com%2fdata-analysis-with-pandas%2f" target=_blank rel=noopener aria-label="Share on WhatsApp"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17.498 14.382c-.301-.15-1.767-.867-2.04-.966-.273-.101-.473-.15-.673.15-.197.295-.771.964-.944 1.162-.175.195-.349.21-.646.075-.3-.15-1.263-.465-2.403-1.485-.888-.795-1.484-1.77-1.66-2.07-.174-.3-.019-.465.13-.615.136-.135.301-.345.451-.523.146-.181.194-.301.297-.496.1-.21.049-.375-.025-.524-.075-.15-.672-1.62-.922-2.206-.24-.584-.487-.51-.672-.51-.172-.015-.371-.015-.571-.015-.2.0-.523.074-.797.359-.273.3-1.045 1.02-1.045 2.475s1.07 2.865 1.219 3.075c.149.195 2.105 3.195 5.1 4.485.714.3 1.27.48 1.704.629.714.227 1.365.195 1.88.121.574-.091 1.767-.721 2.016-1.426.255-.705.255-1.29.18-1.425-.074-.135-.27-.21-.57-.345m-5.446 7.443h-.016c-1.77.0-3.524-.48-5.055-1.38l-.36-.214-3.75.975 1.005-3.645-.239-.375c-.99-1.576-1.516-3.391-1.516-5.26.0-5.445 4.455-9.885 9.942-9.885a9.865 9.865.0 017.021 2.91 9.788 9.788.0 012.909 6.99c-.004 5.444-4.46 9.885-9.935 9.885M20.52 3.449C18.24 1.245 15.24.0 12.045.0 5.463.0.104 5.334.101 11.893c0 2.096.549 4.14 1.595 5.945L0 24l6.335-1.652a12.062 12.062.0 005.71 1.447h.006c6.585.0 11.946-5.336 11.949-11.896.0-3.176-1.24-6.165-3.495-8.411"/></svg>
</a><a href="mailto:?subject=Part%2012%3a%20Data%20Analysis%20with%20pandas&body=https%3a%2f%2fmichaelbrunger.com%2fdata-analysis-with-pandas%2f" aria-label="Share via Email"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://michaelbrunger.com/>Michael Brunger</a> |</span>
<span class=footer-links><a href=mailto:michaelbrunger@gmail.com rel="me noopener" target=_blank>Email</a> |
<a href=https://linkedin.com/in/michael-brunger rel="me noopener" target=_blank>LinkedIn</a> |
<a href=https://michaelbrunger.com/terms/ rel=noopener>Terms</a> |
<a href=https://michaelbrunger.com/privacy/ rel=noopener>Privacy</a></span></footer><div id=back-to-top-container><button id=back-to-top class=back-to-top aria-label="Back to top"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg></button></div><script language=javascript type=text/javascript src=https://michaelbrunger.com/menu-trigger.min.1fdaaaa006c69ae56d0620f2af3adf4d9e797e66d323215185b85818508bac37.js></script><script language=javascript type=text/javascript src=https://michaelbrunger.com/theme.min.dbdbacb710c4de0f72c6167f93e19c4d262f7533c0490e320235feb1955f570d.js></script></body></html>