<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Part 5: Functions, Modules & File I/O in Python | Michael Brunger</title>
<meta name=keywords content="python,functions,modules,packages,standard library,file io,file handling"><meta name=description content="Learn how to define and use functions, organize code into modules, leverage Python's Standard Library, and perform file operations for reading and writing data."><meta name=author content="Michael Brunger"><link rel=canonical href=https://michaelbrunger.com/python-functions-modules-file-io/><link crossorigin=anonymous href=https://michaelbrunger.com/assets/css/stylesheet.fe6c761872462f9cd1981cfb6f465116b134fa108e39a30a712e4999193453db.css integrity="sha256-/mx2GHJGL5zRmBz7b0ZRFrE0+hCOOaMKcS5JmRk0U9s=" rel="preload stylesheet" as=style><link rel=icon href=https://michaelbrunger.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michaelbrunger.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michaelbrunger.com/favicon-32x32.png><link rel=apple-touch-icon href=https://michaelbrunger.com/apple-touch-icon.png><link rel=mask-icon href=https://michaelbrunger.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://michaelbrunger.com/python-functions-modules-file-io/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=icon href=https://michaelbrunger.com/assets/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://michaelbrunger.com/assets/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://michaelbrunger.com/assets/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://michaelbrunger.com/assets/apple-touch-icon.png><link rel=manifest href=https://michaelbrunger.com/site.webmanifest><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><script type=text/javascript src='https://app.cookieyes.com/mAsBCNFb37oPK_4XJgj7kpxbljvjKgiPcLeSeiRyslQSWcJQA0P7w_nb-e_NfuwZCdsSDi_gh_1zVLQNUSNV8A=='></script><script id=cookieyes type=text/javascript src=https://cdn-cookieyes.com/client_data/8dbaf9037ea60d809e6f1613/script.js></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Orbitron:wght@400..900&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-XJJLP6S9JL" data-cookieyes=cookieyes-analytics></script><script data-cookieyes=cookieyes-analytics>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XJJLP6S9JL")</script><script src=https://michaelbrunger.com/js/extended/back-to-top.min.js defer></script><script src=https://michaelbrunger.com/js/extended/sticky-header.min.js defer></script><script src=https://michaelbrunger.com/js/extended/menu-trigger.min.js defer></script><meta property="og:url" content="https://michaelbrunger.com/python-functions-modules-file-io/"><meta property="og:site_name" content="Michael Brunger"><meta property="og:title" content="Part 5: Functions, Modules & File I/O in Python"><meta property="og:description" content="Learn how to define and use functions, organize code into modules, leverage Python's Standard Library, and perform file operations for reading and writing data."><meta property="og:locale" content="en-GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-30T22:23:23+01:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Functions"><meta property="article:tag" content="Modules"><meta property="article:tag" content="Packages"><meta property="article:tag" content="Standard Library"><meta property="article:tag" content="File Io"><meta property="og:image" content="https://michaelbrunger.com/site-feature-image.jpg"><meta property="og:see_also" content="https://michaelbrunger.com/python-core-data-structures/"><meta property="og:see_also" content="https://michaelbrunger.com/python-syntax-fundamentals/"><meta property="og:see_also" content="https://michaelbrunger.com/python-foundations-editors-ides/"><meta property="og:see_also" content="https://michaelbrunger.com/python-foundations-getting-started/"><meta property="og:see_also" content="https://michaelbrunger.com/python-learning-path/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://michaelbrunger.com/site-feature-image.jpg"><meta name=twitter:title content="Part 5: Functions, Modules & File I/O in Python"><meta name=twitter:description content="Learn how to define and use functions, organize code into modules, leverage Python's Standard Library, and perform file operations for reading and writing data."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michaelbrunger.com/posts/"},{"@type":"ListItem","position":2,"name":"Python Series","item":"https://michaelbrunger.com/posts/python-series/"},{"@type":"ListItem","position":3,"name":"Part 5: Functions, Modules \u0026 File I/O in Python","item":"https://michaelbrunger.com/python-functions-modules-file-io/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Part 5: Functions, Modules \u0026 File I/O in Python","name":"Part 5: Functions, Modules \u0026 File I\/O in Python","description":"Learn how to define and use functions, organize code into modules, leverage Python's Standard Library, and perform file operations for reading and writing data.","keywords":["python","functions","modules","packages","standard library","file io","file handling"],"articleBody":"Functions, Modules \u0026 File I/O in Python These next concepts incredibly useful for organising code and working with external data. Let’s explore how Python handles functions, modules, and file operations - all essential skills for financial analysis and reporting.\nDefining and Calling Functions Functions are reusable blocks of code that perform specific tasks. They help keep your code DRY (Don’t Repeat Yourself) and make it more maintainable.\nBasic Function Syntax def function_name(parameters): \"\"\"Docstring explaining what the function does.\"\"\" # Function body return result # Optional Here’s a simple function that calculates compound interest:\ndef calculate_compound_interest(principal, rate, time, compounds_per_year=1): \"\"\" Calculate compound interest. Args: principal: Initial investment amount rate: Annual interest rate (as decimal, e.g., 0.05 for 5%) time: Time period in years compounds_per_year: Number of times interest compounds per year (default=1) Returns: The final amount after compound interest \"\"\" return principal * (1 + rate/compounds_per_year)**(compounds_per_year*time) Let’s call this function:\n# Calculate investment growth at 5% interest, compounded quarterly for 10 years initial_investment = 10000 final_amount = calculate_compound_interest( principal=initial_investment, rate=0.05, time=10, compounds_per_year=4 ) print(f\"${initial_investment} will grow to ${final_amount:.2f} after 10 years\") Output:\n$10000 will grow to $16470.09 after 10 years Function Arguments Python offers flexible ways to handle function arguments:\nPositional vs. Keyword Arguments # Positional arguments (order matters) result1 = calculate_compound_interest(10000, 0.05, 10, 4) # Keyword arguments (order doesn't matter) result2 = calculate_compound_interest( rate=0.05, principal=10000, compounds_per_year=4, time=10 ) Default Parameter Values In our function, compounds_per_year=1 provides a default value if not specified:\n# Using the default compounds_per_year (annual compounding) annual_result = calculate_compound_interest(10000, 0.05, 10) print(f\"With annual compounding: ${annual_result:.2f}\") Variable Number of Arguments For functions that need to accept varying numbers of arguments:\n# *args collects extra positional arguments as a tuple def sum_all_values(*args): \"\"\"Sum any number of values.\"\"\" return sum(args) # **kwargs collects extra keyword arguments as a dictionary def create_financial_report(report_date, **kwargs): \"\"\"Create a financial report with flexible data points.\"\"\" report = {\"date\": report_date} report.update(kwargs) return report # Example usage total = sum_all_values(100, 250, 300, 75) print(f\"Total: ${total}\") report = create_financial_report( \"2025-04-28\", revenue=150000, expenses=95000, net_profit=55000, profit_margin=0.37 ) print(report) Variable Scope and Namespaces Understanding scope is crucial for debugging and writing clean code.\nLocal vs. Global Scope total_assets = 1000000 # Global variable def calculate_roi(profit): investment = 100000 # Local variable return profit / investment * 100 # investment is not accessible here print(f\"Total assets: ${total_assets}\") roi = calculate_roi(25000) print(f\"ROI: {roi}%\") Local variables exist only within their function. Global variables can be accessed inside functions, but to modify them, you need the global keyword:\nbalance = 5000 # Global variable def deposit(amount): global balance # Tell Python we want to modify the global variable balance += amount return balance def withdraw(amount): global balance if balance \u003e= amount: balance -= amount return balance else: return \"Insufficient funds\" print(f\"Initial balance: ${balance}\") deposit(1000) print(f\"After deposit: ${balance}\") withdraw(2000) print(f\"After withdrawal: ${balance}\") Namespaces Python uses namespaces to organise names and avoid conflicts. Each module, function, and class has its own namespace.\nOrganising Code into Modules and Packages As your financial scripts grow, organising code becomes essential.\nModules A module is simply a .py file containing code. Let’s create a financial utilities module:\n# financial_utils.py def calculate_roi(profit, investment): \"\"\"Calculate Return on Investment as a percentage.\"\"\" return (profit / investment) * 100 def calculate_npv(cash_flows, discount_rate): \"\"\" Calculate Net Present Value of a series of cash flows. Args: cash_flows: List of cash flows, where index 0 is the initial investment (negative) discount_rate: Discount rate as decimal (e.g., 0.1 for 10%) \"\"\" npv = 0 for t, cash_flow in enumerate(cash_flows): npv += cash_flow / (1 + discount_rate) ** t return npv To use this module:\n# main.py import financial_utils # Calculate ROI investment = 50000 profit = 12500 roi = financial_utils.calculate_roi(profit, investment) print(f\"ROI: {roi}%\") # Calculate NPV of a project cash_flows = [-100000, 30000, 35000, 45000, 50000] # Initial investment + 4 years of returns npv = financial_utils.calculate_npv(cash_flows, 0.08) print(f\"NPV: ${npv:.2f}\") You can also import specific functions:\nfrom financial_utils import calculate_roi, calculate_npv # Now use without the module prefix roi = calculate_roi(12500, 50000) Packages Packages are directories containing multiple modules. They require an __init__.py file (which can be empty) to be recognised as packages.\nfinance_package/\r├── __init__.py\r├── analysis.py\r├── reporting.py\r└── utils.py Using packages:\n# Import specific modules from a package from finance_package import analysis, reporting # Import specific functions from a module in a package from finance_package.utils import calculate_roi Exploring the Standard Library Python comes with a rich standard library. Here are some modules particularly useful for financial applications:\nMath Module import math # Calculate loan payment using the PMT formula principal = 250000 annual_rate = 0.04 # 4% years = 30 monthly_rate = annual_rate / 12 num_payments = years * 12 # Monthly payment formula payment = principal * (monthly_rate * math.pow(1 + monthly_rate, num_payments)) / (math.pow(1 + monthly_rate, num_payments) - 1) print(f\"Monthly mortgage payment: ${payment:.2f}\") Random Module import random # Simulate stock price movements (very simplified) starting_price = 100 daily_volatility = 0.015 # 1.5% prices = [starting_price] for day in range(30): change = random.normalvariate(0, daily_volatility) new_price = prices[-1] * (1 + change) prices.append(new_price) print(f\"Starting price: ${starting_price:.2f}\") print(f\"Ending price: ${prices[-1]:.2f}\") print(f\"30-day return: {(prices[-1]/prices[0] - 1) * 100:.2f}%\") Datetime Module from datetime import datetime, timedelta # Calculate business days between dates def business_days_between(start_date, end_date): \"\"\"Count business days between two dates (excluding weekends).\"\"\" days = 0 current_date = start_date while current_date \u003c= end_date: # Monday = 0, Sunday = 6 if current_date.weekday() \u003c 5: # Only count weekdays (0-4) days += 1 current_date += timedelta(days=1) return days # Calculate days until fiscal year end today = datetime.now() fiscal_year_end = datetime(today.year, 12, 31) if today \u003e fiscal_year_end: fiscal_year_end = datetime(today.year + 1, 12, 31) business_days = business_days_between(today, fiscal_year_end) print(f\"Business days until fiscal year end: {business_days}\") OS and Sys Modules import os import sys # Get the current working directory (useful for file paths) current_dir = os.getcwd() print(f\"Current directory: {current_dir}\") # List all Excel files in the current directory excel_files = [file for file in os.listdir() if file.endswith(('.xlsx', '.xls'))] print(\"Excel files found:\") for file in excel_files: print(f\"- {file}\") # Get Python version and platform information print(f\"Python version: {sys.version}\") print(f\"Platform: {sys.platform}\") Reading from/Writing to Text Files File operations are essential for financial data analysis, reporting, and automation.\nOpening and Closing Files The basic pattern is:\n# Open a file in read mode file = open('data.txt', 'r') # Do something with the file content = file.read() # Close the file file.close() However, this approach has problems if an error occurs before close(). The preferred way is using the with statement:\nThe with Statement # Automatically handles proper closing of the file with open('data.txt', 'r') as file: content = file.read() # File processing here # File is automatically closed when the block ends Reading Text Files Let’s work with a sample CSV file containing financial transactions:\n# Sample contents of transactions.csv: # date,description,amount # 2025-01-15,Office supplies,-129.99 # 2025-01-18,Client payment,1500.00 # 2025-01-22,Software subscription,-49.99 # 2025-01-30,Consulting fees,2750.00 with open('transactions.csv', 'r') as file: # Read the entire file as a single string content = file.read() print(\"File contents:\") print(content) Reading line by line:\nwith open('transactions.csv', 'r') as file: # Skip header header = file.readline() # Initialise counters total_income = 0 total_expenses = 0 # Process each transaction for line in file: # Remove whitespace and split by comma date, description, amount = line.strip().split(',') # Convert amount to float amount = float(amount) if amount \u003e= 0: total_income += amount else: total_expenses += amount print(f\"Total income: ${total_income:.2f}\") print(f\"Total expenses: ${total_expenses:.2f}\") print(f\"Net cash flow: ${total_income + total_expenses:.2f}\") Writing to Text Files Let’s create a simple financial report:\n# Sample transaction data transactions = [ {\"date\": \"2025-01-15\", \"description\": \"Office supplies\", \"amount\": -129.99}, {\"date\": \"2025-01-18\", \"description\": \"Client payment\", \"amount\": 1500.00}, {\"date\": \"2025-01-22\", \"description\": \"Software subscription\", \"amount\": -49.99}, {\"date\": \"2025-01-30\", \"description\": \"Consulting fees\", \"amount\": 2750.00} ] # Calculate summary statistics total_income = sum(t[\"amount\"] for t in transactions if t[\"amount\"] \u003e 0) total_expenses = sum(t[\"amount\"] for t in transactions if t[\"amount\"] \u003c 0) net_cash_flow = total_income + total_expenses # Write the report to a file with open('financial_report.txt', 'w') as report_file: report_file.write(\"MONTHLY FINANCIAL REPORT\\n\") report_file.write(\"======================\\n\\n\") report_file.write(\"TRANSACTION DETAILS:\\n\") report_file.write(\"-----------------\\n\") for t in transactions: amount_str = f\"${abs(t['amount']):.2f}\" if t[\"amount\"] \u003c 0: amount_str = f\"-{amount_str}\" report_file.write(f\"{t['date']} | {t['description'].ljust(20)} | {amount_str}\\n\") report_file.write(\"\\nSUMMARY:\\n\") report_file.write(\"--------\\n\") report_file.write(f\"Total Income: ${total_income:.2f}\\n\") report_file.write(f\"Total Expenses: ${total_expenses:.2f}\\n\") report_file.write(f\"Net Cash Flow: ${net_cash_flow:.2f}\\n\") print(\"Financial report generated: financial_report.txt\") Handling Different File Modes 'r': Read (default) 'w': Write (creates new file or truncates existing) 'a': Append (adds to end of file) 'r+': Read and write 'b': Binary mode (used with other modes, e.g., 'rb') Working with CSV Files While you can process CSV files manually as shown above, Python’s csv module makes it easier:\nimport csv # Reading CSV with open('transactions.csv', 'r') as file: csv_reader = csv.DictReader(file) # Process each row as a dictionary transactions = [] for row in csv_reader: # Convert amount from string to float row['amount'] = float(row['amount']) transactions.append(row) print(f\"Loaded {len(transactions)} transactions\") # Writing CSV with open('budget_forecast.csv', 'w', newline='') as file: # Define column headers fieldnames = ['month', 'revenue', 'expenses', 'profit'] # Create CSV writer csv_writer = csv.DictWriter(file, fieldnames=fieldnames) # Write header row csv_writer.writeheader() # Write data rows for month in range(1, 13): # Simple forecast model (for demonstration) revenue = 15000 + (month * 500) # Increasing monthly expenses = 10000 + (month * 200) # Increasing but slower profit = revenue - expenses csv_writer.writerow({ 'month': f\"2025-{month:02d}\", 'revenue': revenue, 'expenses': expenses, 'profit': profit }) print(\"Budget forecast generated: budget_forecast.csv\") Practical Example: Expense Analyser Let’s combine everything we’ve learned into a practical financial tool that:\nReads expense data from a CSV file Categorises and analyses expenses Generates a report with summary statistics import csv from datetime import datetime import os def load_expenses(filename): \"\"\"Load expense data from a CSV file.\"\"\" expenses = [] with open(filename, 'r') as file: reader = csv.DictReader(file) for row in reader: # Convert amount to float and date to datetime row['amount'] = float(row['amount']) row['date'] = datetime.strptime(row['date'], '%Y-%m-%d') expenses.append(row) return expenses def categorize_expenses(expenses): \"\"\"Group expenses by category.\"\"\" categories = {} for expense in expenses: category = expense['category'] if category not in categories: categories[category] = [] categories[category].append(expense) return categories def calculate_category_totals(categories): \"\"\"Calculate total amount for each expense category.\"\"\" totals = {} for category, expenses in categories.items(): totals[category] = sum(expense['amount'] for expense in expenses) return totals def generate_expense_report(expenses, categories, totals, output_file): \"\"\"Generate a detailed expense report.\"\"\" total_expenses = sum(totals.values()) with open(output_file, 'w') as file: # Write header file.write(\"EXPENSE ANALYSIS REPORT\\n\") file.write(\"======================\\n\\n\") # Write summary file.write(f\"Total Expenses: ${total_expenses:.2f}\\n\") file.write(f\"Number of Transactions: {len(expenses)}\\n\") file.write(f\"Date Range: {min(e['date'] for e in expenses).strftime('%Y-%m-%d')} to {max(e['date'] for e in expenses).strftime('%Y-%m-%d')}\\n\\n\") # Write category breakdown file.write(\"EXPENSE BREAKDOWN BY CATEGORY\\n\") file.write(\"----------------------------\\n\") # Sort categories by total amount (descending) sorted_categories = sorted(totals.items(), key=lambda x: x[1], reverse=True) for category, amount in sorted_categories: percentage = (amount / total_expenses) * 100 file.write(f\"{category.ljust(20)} ${amount:.2f} ({percentage:.1f}%)\\n\") # Write transaction details for each category file.write(\"\\nDETAILED TRANSACTIONS BY CATEGORY\\n\") file.write(\"--------------------------------\\n\\n\") for category, amount in sorted_categories: file.write(f\"{category.upper()}\\n\") file.write(f\"{'-' * len(category)}\\n\") # Sort expenses by date sorted_expenses = sorted(categories[category], key=lambda x: x['date']) for expense in sorted_expenses: date_str = expense['date'].strftime('%Y-%m-%d') file.write(f\"{date_str} | {expense['description'].ljust(30)} | ${expense['amount']:.2f}\\n\") # Add category subtotal file.write(f\"{'SUBTOTAL:'.ljust(41)} ${amount:.2f}\\n\\n\") # Usage example (assuming we have an expenses.csv file) def main(): # Check if the input file exists input_file = 'expenses.csv' if not os.path.exists(input_file): print(f\"Error: File '{input_file}' not found.\") print(\"Creating a sample expense file for demonstration...\") # Create a sample file for demonstration with open(input_file, 'w', newline='') as file: writer = csv.writer(file) writer.writerow(['date', 'category', 'description', 'amount']) writer.writerow(['2025-01-05', 'Office', 'Printer paper', 24.99]) writer.writerow(['2025-01-10', 'Software', 'Accounting software', 89.99]) writer.writerow(['2025-01-15', 'Office', 'Desk organiser', 32.50]) writer.writerow(['2025-01-18', 'Travel', 'Client meeting transportation', 45.75]) writer.writerow(['2025-01-22', 'Software', 'Cloud storage subscription', 9.99]) writer.writerow(['2025-01-25', 'Meals', 'Team lunch', 87.50]) writer.writerow(['2025-01-29', 'Office', 'Printer ink', 65.85]) writer.writerow(['2025-02-03', 'Travel', 'Conference registration', 299.00]) writer.writerow(['2025-02-07', 'Meals', 'Client dinner', 125.40]) writer.writerow(['2025-02-15', 'Software', 'Data analysis tool', 149.99]) print(f\"Sample file '{input_file}' created.\") # Process the expense data expenses = load_expenses(input_file) categories = categorize_expenses(expenses) totals = calculate_category_totals(categories) # Generate the report output_file = 'expense_report.txt' generate_expense_report(expenses, categories, totals, output_file) print(f\"Expense report generated: {output_file}\") if __name__ == \"__main__\": main() This script demonstrates:\nFunction definitions with docstrings File I/O with the with statement CSV processing Module imports and usage Error handling Conclusion Functions, modules, and file I/O form the backbone of most Python applications, especially for financial tasks. By mastering these concepts, you’ll be well-equipped to build tools for financial analysis, reporting, and automation.\nIn the next post, we’ll explore virtual environments and package management, which will help you manage dependencies for larger projects.\nPractice Exercise: Try extending the expense analyser to calculate monthly trends or generate a simple visualisation of spending by category. This will help reinforce the concepts we’ve covered while building something useful for your financial toolkit.\n","wordCount":"2079","inLanguage":"en","image":"https://michaelbrunger.com/site-feature-image.jpg","datePublished":"2025-05-30T00:00:00Z","dateModified":"2025-05-30T22:23:23+01:00","author":{"@type":"Person","name":"Michael Brunger"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michaelbrunger.com/python-functions-modules-file-io/"},"publisher":{"@type":"Organization","name":"Michael Brunger","logo":{"@type":"ImageObject","url":"https://michaelbrunger.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michaelbrunger.com/ accesskey=h title="Michael Brunger (Alt + H)">Michael Brunger</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul class="menu desktop-menu"><li><a href=https://michaelbrunger.com/ title=Home><span>Home</span></a></li><li><a href=https://michaelbrunger.com/briefs/ title="Daily Briefs"><span>Daily Briefs</span></a></li><li><a href=https://michaelbrunger.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://michaelbrunger.com/about/ title=About><span>About</span></a></li><li><a href=https://michaelbrunger.com/links/ title=Links><span>Links</span></a></li><li><a href=https://michaelbrunger.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://michaelbrunger.com/contact/ title=Contact><span>Contact</span></a></li></ul><button id=menu-trigger class=hamburger-menu aria-haspopup=menu aria-label="Menu Button"><div class=hamburger-icon><span></span>
<span></span>
<span></span>
<span></span></div></button></nav></header><div class=mobile-menu-overlay><ul class=mobile-menu><li><a href=https://michaelbrunger.com/>Home</a></li><li><a href=https://michaelbrunger.com/briefs/>Daily Briefs</a></li><li><a href=https://michaelbrunger.com/posts/>Posts</a></li><li><a href=https://michaelbrunger.com/about/>About</a></li><li><a href=https://michaelbrunger.com/links/>Links</a></li><li><a href=https://michaelbrunger.com/search/>Search</a></li><li><a href=https://michaelbrunger.com/contact/>Contact</a></li></ul></div><main class=main><div class=reading-progress-container><div class=reading-progress-bar></div></div><script>console.log("Reading progress script loaded"),document.addEventListener("DOMContentLoaded",function(){console.log("DOM Content Loaded");const e=document.querySelector(".reading-progress-bar");if(console.log("Progress bar element:",e),!e){console.log("No progress bar found");return}window.addEventListener("scroll",function(){const n=window.innerHeight,s=document.documentElement.scrollHeight-n,o=window.scrollY,t=o/s*100;e.style.width=t+"%",console.log("Progress:",t+"%")})})</script><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Part 5: Functions, Modules & File I/O in Python</h1><div class=post-description>Learn how to define and use functions, organize code into modules, leverage Python&rsquo;s Standard Library, and perform file operations for reading and writing data.</div><div class=post-meta><span class=post-date><i class="far fa-calendar-alt"></i>
May 30, 2025
</span><span class=post-lastmod><i class="fas fa-edit"></i>
Last modified: May 30, 2025
</span><span class=post-reading-time><i class="far fa-clock"></i>
10 min read</span></div></header><div class=toc><details><summary>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#defining-and-calling-functions>Defining and Calling Functions</a><ul><li><a href=#basic-function-syntax>Basic Function Syntax</a></li><li><a href=#function-arguments>Function Arguments</a></li></ul></li><li><a href=#variable-scope-and-namespaces>Variable Scope and Namespaces</a><ul><li><a href=#local-vs-global-scope>Local vs. Global Scope</a></li><li><a href=#namespaces>Namespaces</a></li></ul></li><li><a href=#organising-code-into-modules-and-packages>Organising Code into Modules and Packages</a><ul><li><a href=#modules>Modules</a></li><li><a href=#packages>Packages</a></li></ul></li><li><a href=#exploring-the-standard-library>Exploring the Standard Library</a><ul><li><a href=#math-module>Math Module</a></li><li><a href=#random-module>Random Module</a></li><li><a href=#datetime-module>Datetime Module</a></li><li><a href=#os-and-sys-modules>OS and Sys Modules</a></li></ul></li><li><a href=#reading-fromwriting-to-text-files>Reading from/Writing to Text Files</a><ul><li><a href=#opening-and-closing-files>Opening and Closing Files</a></li><li><a href=#the-with-statement>The with Statement</a></li><li><a href=#reading-text-files>Reading Text Files</a></li><li><a href=#writing-to-text-files>Writing to Text Files</a></li><li><a href=#handling-different-file-modes>Handling Different File Modes</a></li></ul></li><li><a href=#working-with-csv-files>Working with CSV Files</a></li><li><a href=#practical-example-expense-analyser>Practical Example: Expense Analyser</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></details></div><div class=post-content><h1 id=functions-modules--file-io-in-python>Functions, Modules & File I/O in Python<a hidden class=anchor aria-hidden=true href=#functions-modules--file-io-in-python>#</a></h1><p>These next concepts incredibly useful for organising code and working with external data. Let&rsquo;s explore how Python handles functions, modules, and file operations - all essential skills for financial analysis and reporting.</p><h2 id=defining-and-calling-functions>Defining and Calling Functions<a hidden class=anchor aria-hidden=true href=#defining-and-calling-functions>#</a></h2><p>Functions are reusable blocks of code that perform specific tasks. They help keep your code DRY (Don&rsquo;t Repeat Yourself) and make it more maintainable.</p><h3 id=basic-function-syntax>Basic Function Syntax<a hidden class=anchor aria-hidden=true href=#basic-function-syntax>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>function_name</span>(parameters):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Docstring explaining what the function does.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Function body</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result  <span style=color:#75715e># Optional</span>
</span></span></code></pre></div><p>Here&rsquo;s a simple function that calculates compound interest:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_compound_interest</span>(principal, rate, time, compounds_per_year<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Calculate compound interest.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Args:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        principal: Initial investment amount
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        rate: Annual interest rate (as decimal, e.g., 0.05 for 5%)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        time: Time period in years
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        compounds_per_year: Number of times interest compounds per year (default=1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        The final amount after compound interest
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> principal <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> rate<span style=color:#f92672>/</span>compounds_per_year)<span style=color:#f92672>**</span>(compounds_per_year<span style=color:#f92672>*</span>time)
</span></span></code></pre></div><p>Let&rsquo;s call this function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Calculate investment growth at 5% interest, compounded quarterly for 10 years</span>
</span></span><span style=display:flex><span>initial_investment <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span>
</span></span><span style=display:flex><span>final_amount <span style=color:#f92672>=</span> calculate_compound_interest(
</span></span><span style=display:flex><span>    principal<span style=color:#f92672>=</span>initial_investment, 
</span></span><span style=display:flex><span>    rate<span style=color:#f92672>=</span><span style=color:#ae81ff>0.05</span>, 
</span></span><span style=display:flex><span>    time<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>, 
</span></span><span style=display:flex><span>    compounds_per_year<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;$</span><span style=color:#e6db74>{</span>initial_investment<span style=color:#e6db74>}</span><span style=color:#e6db74> will grow to $</span><span style=color:#e6db74>{</span>final_amount<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> after 10 years&#34;</span>)
</span></span></code></pre></div><p><strong>Output:</strong></p><pre tabindex=0><code>$10000 will grow to $16470.09 after 10 years
</code></pre><h3 id=function-arguments>Function Arguments<a hidden class=anchor aria-hidden=true href=#function-arguments>#</a></h3><p>Python offers flexible ways to handle function arguments:</p><h4 id=positional-vs-keyword-arguments>Positional vs. Keyword Arguments<a hidden class=anchor aria-hidden=true href=#positional-vs-keyword-arguments>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Positional arguments (order matters)</span>
</span></span><span style=display:flex><span>result1 <span style=color:#f92672>=</span> calculate_compound_interest(<span style=color:#ae81ff>10000</span>, <span style=color:#ae81ff>0.05</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Keyword arguments (order doesn&#39;t matter)</span>
</span></span><span style=display:flex><span>result2 <span style=color:#f92672>=</span> calculate_compound_interest(
</span></span><span style=display:flex><span>    rate<span style=color:#f92672>=</span><span style=color:#ae81ff>0.05</span>,
</span></span><span style=display:flex><span>    principal<span style=color:#f92672>=</span><span style=color:#ae81ff>10000</span>,
</span></span><span style=display:flex><span>    compounds_per_year<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>    time<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=default-parameter-values>Default Parameter Values<a hidden class=anchor aria-hidden=true href=#default-parameter-values>#</a></h4><p>In our function, <code>compounds_per_year=1</code> provides a default value if not specified:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Using the default compounds_per_year (annual compounding)</span>
</span></span><span style=display:flex><span>annual_result <span style=color:#f92672>=</span> calculate_compound_interest(<span style=color:#ae81ff>10000</span>, <span style=color:#ae81ff>0.05</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;With annual compounding: $</span><span style=color:#e6db74>{</span>annual_result<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h4 id=variable-number-of-arguments>Variable Number of Arguments<a hidden class=anchor aria-hidden=true href=#variable-number-of-arguments>#</a></h4><p>For functions that need to accept varying numbers of arguments:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># *args collects extra positional arguments as a tuple</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>sum_all_values</span>(<span style=color:#f92672>*</span>args):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Sum any number of values.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum(args)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># **kwargs collects extra keyword arguments as a dictionary</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_financial_report</span>(report_date, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Create a financial report with flexible data points.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    report <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;date&#34;</span>: report_date}
</span></span><span style=display:flex><span>    report<span style=color:#f92672>.</span>update(kwargs)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> report
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example usage</span>
</span></span><span style=display:flex><span>total <span style=color:#f92672>=</span> sum_all_values(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>75</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total: $</span><span style=color:#e6db74>{</span>total<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>report <span style=color:#f92672>=</span> create_financial_report(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;2025-04-28&#34;</span>,
</span></span><span style=display:flex><span>    revenue<span style=color:#f92672>=</span><span style=color:#ae81ff>150000</span>,
</span></span><span style=display:flex><span>    expenses<span style=color:#f92672>=</span><span style=color:#ae81ff>95000</span>,
</span></span><span style=display:flex><span>    net_profit<span style=color:#f92672>=</span><span style=color:#ae81ff>55000</span>,
</span></span><span style=display:flex><span>    profit_margin<span style=color:#f92672>=</span><span style=color:#ae81ff>0.37</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>print(report)
</span></span></code></pre></div><h2 id=variable-scope-and-namespaces>Variable Scope and Namespaces<a hidden class=anchor aria-hidden=true href=#variable-scope-and-namespaces>#</a></h2><p>Understanding scope is crucial for debugging and writing clean code.</p><h3 id=local-vs-global-scope>Local vs. Global Scope<a hidden class=anchor aria-hidden=true href=#local-vs-global-scope>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>total_assets <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000000</span>  <span style=color:#75715e># Global variable</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_roi</span>(profit):
</span></span><span style=display:flex><span>    investment <span style=color:#f92672>=</span> <span style=color:#ae81ff>100000</span>  <span style=color:#75715e># Local variable</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> profit <span style=color:#f92672>/</span> investment <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># investment is not accessible here</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total assets: $</span><span style=color:#e6db74>{</span>total_assets<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>roi <span style=color:#f92672>=</span> calculate_roi(<span style=color:#ae81ff>25000</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ROI: </span><span style=color:#e6db74>{</span>roi<span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span></code></pre></div><p>Local variables exist only within their function. Global variables can be accessed inside functions, but to modify them, you need the <code>global</code> keyword:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>balance <span style=color:#f92672>=</span> <span style=color:#ae81ff>5000</span>  <span style=color:#75715e># Global variable</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>deposit</span>(amount):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> balance  <span style=color:#75715e># Tell Python we want to modify the global variable</span>
</span></span><span style=display:flex><span>    balance <span style=color:#f92672>+=</span> amount
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> balance
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>withdraw</span>(amount):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> balance
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> balance <span style=color:#f92672>&gt;=</span> amount:
</span></span><span style=display:flex><span>        balance <span style=color:#f92672>-=</span> amount
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> balance
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;Insufficient funds&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Initial balance: $</span><span style=color:#e6db74>{</span>balance<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>deposit(<span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;After deposit: $</span><span style=color:#e6db74>{</span>balance<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>withdraw(<span style=color:#ae81ff>2000</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;After withdrawal: $</span><span style=color:#e6db74>{</span>balance<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3 id=namespaces>Namespaces<a hidden class=anchor aria-hidden=true href=#namespaces>#</a></h3><p>Python uses namespaces to organise names and avoid conflicts. Each module, function, and class has its own namespace.</p><h2 id=organising-code-into-modules-and-packages>Organising Code into Modules and Packages<a hidden class=anchor aria-hidden=true href=#organising-code-into-modules-and-packages>#</a></h2><p>As your financial scripts grow, organising code becomes essential.</p><h3 id=modules>Modules<a hidden class=anchor aria-hidden=true href=#modules>#</a></h3><p>A module is simply a <code>.py</code> file containing code. Let&rsquo;s create a financial utilities module:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># financial_utils.py</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_roi</span>(profit, investment):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Calculate Return on Investment as a percentage.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (profit <span style=color:#f92672>/</span> investment) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_npv</span>(cash_flows, discount_rate):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Calculate Net Present Value of a series of cash flows.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Args:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        cash_flows: List of cash flows, where index 0 is the initial investment (negative)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        discount_rate: Discount rate as decimal (e.g., 0.1 for 10%)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    npv <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t, cash_flow <span style=color:#f92672>in</span> enumerate(cash_flows):
</span></span><span style=display:flex><span>        npv <span style=color:#f92672>+=</span> cash_flow <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> discount_rate) <span style=color:#f92672>**</span> t
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> npv
</span></span></code></pre></div><p>To use this module:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># main.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> financial_utils
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate ROI</span>
</span></span><span style=display:flex><span>investment <span style=color:#f92672>=</span> <span style=color:#ae81ff>50000</span>
</span></span><span style=display:flex><span>profit <span style=color:#f92672>=</span> <span style=color:#ae81ff>12500</span>
</span></span><span style=display:flex><span>roi <span style=color:#f92672>=</span> financial_utils<span style=color:#f92672>.</span>calculate_roi(profit, investment)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ROI: </span><span style=color:#e6db74>{</span>roi<span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate NPV of a project</span>
</span></span><span style=display:flex><span>cash_flows <span style=color:#f92672>=</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>100000</span>, <span style=color:#ae81ff>30000</span>, <span style=color:#ae81ff>35000</span>, <span style=color:#ae81ff>45000</span>, <span style=color:#ae81ff>50000</span>]  <span style=color:#75715e># Initial investment + 4 years of returns</span>
</span></span><span style=display:flex><span>npv <span style=color:#f92672>=</span> financial_utils<span style=color:#f92672>.</span>calculate_npv(cash_flows, <span style=color:#ae81ff>0.08</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;NPV: $</span><span style=color:#e6db74>{</span>npv<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>You can also import specific functions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> financial_utils <span style=color:#f92672>import</span> calculate_roi, calculate_npv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Now use without the module prefix</span>
</span></span><span style=display:flex><span>roi <span style=color:#f92672>=</span> calculate_roi(<span style=color:#ae81ff>12500</span>, <span style=color:#ae81ff>50000</span>)
</span></span></code></pre></div><h3 id=packages>Packages<a hidden class=anchor aria-hidden=true href=#packages>#</a></h3><p>Packages are directories containing multiple modules. They require an <code>__init__.py</code> file (which can be empty) to be recognised as packages.</p><pre tabindex=0><code>finance_package/
├── __init__.py
├── analysis.py
├── reporting.py
└── utils.py
</code></pre><p>Using packages:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Import specific modules from a package</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> finance_package <span style=color:#f92672>import</span> analysis, reporting
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Import specific functions from a module in a package</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> finance_package.utils <span style=color:#f92672>import</span> calculate_roi
</span></span></code></pre></div><h2 id=exploring-the-standard-library>Exploring the Standard Library<a hidden class=anchor aria-hidden=true href=#exploring-the-standard-library>#</a></h2><p>Python comes with a rich standard library. Here are some modules particularly useful for financial applications:</p><h3 id=math-module>Math Module<a hidden class=anchor aria-hidden=true href=#math-module>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> math
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate loan payment using the PMT formula</span>
</span></span><span style=display:flex><span>principal <span style=color:#f92672>=</span> <span style=color:#ae81ff>250000</span>
</span></span><span style=display:flex><span>annual_rate <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.04</span>  <span style=color:#75715e># 4%</span>
</span></span><span style=display:flex><span>years <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>monthly_rate <span style=color:#f92672>=</span> annual_rate <span style=color:#f92672>/</span> <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>num_payments <span style=color:#f92672>=</span> years <span style=color:#f92672>*</span> <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Monthly payment formula</span>
</span></span><span style=display:flex><span>payment <span style=color:#f92672>=</span> principal <span style=color:#f92672>*</span> (monthly_rate <span style=color:#f92672>*</span> math<span style=color:#f92672>.</span>pow(<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> monthly_rate, num_payments)) <span style=color:#f92672>/</span> (math<span style=color:#f92672>.</span>pow(<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> monthly_rate, num_payments) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Monthly mortgage payment: $</span><span style=color:#e6db74>{</span>payment<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3 id=random-module>Random Module<a hidden class=anchor aria-hidden=true href=#random-module>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Simulate stock price movements (very simplified)</span>
</span></span><span style=display:flex><span>starting_price <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>daily_volatility <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.015</span>  <span style=color:#75715e># 1.5%</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prices <span style=color:#f92672>=</span> [starting_price]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> day <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>30</span>):
</span></span><span style=display:flex><span>    change <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>normalvariate(<span style=color:#ae81ff>0</span>, daily_volatility)
</span></span><span style=display:flex><span>    new_price <span style=color:#f92672>=</span> prices[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> change)
</span></span><span style=display:flex><span>    prices<span style=color:#f92672>.</span>append(new_price)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Starting price: $</span><span style=color:#e6db74>{</span>starting_price<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Ending price: $</span><span style=color:#e6db74>{</span>prices[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;30-day return: </span><span style=color:#e6db74>{</span>(prices[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#f92672>/</span>prices[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span><span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%&#34;</span>)
</span></span></code></pre></div><h3 id=datetime-module>Datetime Module<a hidden class=anchor aria-hidden=true href=#datetime-module>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime, timedelta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate business days between dates</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>business_days_between</span>(start_date, end_date):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Count business days between two dates (excluding weekends).&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    days <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    current_date <span style=color:#f92672>=</span> start_date
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> current_date <span style=color:#f92672>&lt;=</span> end_date:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Monday = 0, Sunday = 6</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> current_date<span style=color:#f92672>.</span>weekday() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>:  <span style=color:#75715e># Only count weekdays (0-4)</span>
</span></span><span style=display:flex><span>            days <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        current_date <span style=color:#f92672>+=</span> timedelta(days<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> days
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate days until fiscal year end</span>
</span></span><span style=display:flex><span>today <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>now()
</span></span><span style=display:flex><span>fiscal_year_end <span style=color:#f92672>=</span> datetime(today<span style=color:#f92672>.</span>year, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>31</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> today <span style=color:#f92672>&gt;</span> fiscal_year_end:
</span></span><span style=display:flex><span>    fiscal_year_end <span style=color:#f92672>=</span> datetime(today<span style=color:#f92672>.</span>year <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>31</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>business_days <span style=color:#f92672>=</span> business_days_between(today, fiscal_year_end)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Business days until fiscal year end: </span><span style=color:#e6db74>{</span>business_days<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3 id=os-and-sys-modules>OS and Sys Modules<a hidden class=anchor aria-hidden=true href=#os-and-sys-modules>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get the current working directory (useful for file paths)</span>
</span></span><span style=display:flex><span>current_dir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Current directory: </span><span style=color:#e6db74>{</span>current_dir<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># List all Excel files in the current directory</span>
</span></span><span style=display:flex><span>excel_files <span style=color:#f92672>=</span> [file <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir() <span style=color:#66d9ef>if</span> file<span style=color:#f92672>.</span>endswith((<span style=color:#e6db74>&#39;.xlsx&#39;</span>, <span style=color:#e6db74>&#39;.xls&#39;</span>))]
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Excel files found:&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> excel_files:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;- </span><span style=color:#e6db74>{</span>file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get Python version and platform information</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Python version: </span><span style=color:#e6db74>{</span>sys<span style=color:#f92672>.</span>version<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Platform: </span><span style=color:#e6db74>{</span>sys<span style=color:#f92672>.</span>platform<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h2 id=reading-fromwriting-to-text-files>Reading from/Writing to Text Files<a hidden class=anchor aria-hidden=true href=#reading-fromwriting-to-text-files>#</a></h2><p>File operations are essential for financial data analysis, reporting, and automation.</p><h3 id=opening-and-closing-files>Opening and Closing Files<a hidden class=anchor aria-hidden=true href=#opening-and-closing-files>#</a></h3><p>The basic pattern is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Open a file in read mode</span>
</span></span><span style=display:flex><span>file <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;data.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Do something with the file</span>
</span></span><span style=display:flex><span>content <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span><span style=color:#75715e># Close the file</span>
</span></span><span style=display:flex><span>file<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><p>However, this approach has problems if an error occurs before <code>close()</code>. The preferred way is using the <code>with</code> statement:</p><h3 id=the-with-statement>The with Statement<a hidden class=anchor aria-hidden=true href=#the-with-statement>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Automatically handles proper closing of the file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;data.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    <span style=color:#75715e># File processing here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># File is automatically closed when the block ends</span>
</span></span></code></pre></div><h3 id=reading-text-files>Reading Text Files<a hidden class=anchor aria-hidden=true href=#reading-text-files>#</a></h3><p>Let&rsquo;s work with a sample CSV file containing financial transactions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Sample contents of transactions.csv:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># date,description,amount</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2025-01-15,Office supplies,-129.99</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2025-01-18,Client payment,1500.00</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2025-01-22,Software subscription,-49.99</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2025-01-30,Consulting fees,2750.00</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;transactions.csv&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Read the entire file as a single string</span>
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;File contents:&#34;</span>)
</span></span><span style=display:flex><span>    print(content)
</span></span></code></pre></div><p>Reading line by line:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;transactions.csv&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Skip header</span>
</span></span><span style=display:flex><span>    header <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Initialise counters</span>
</span></span><span style=display:flex><span>    total_income <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    total_expenses <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process each transaction</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> file:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Remove whitespace and split by comma</span>
</span></span><span style=display:flex><span>        date, description, amount <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;,&#39;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Convert amount to float</span>
</span></span><span style=display:flex><span>        amount <span style=color:#f92672>=</span> float(amount)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> amount <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            total_income <span style=color:#f92672>+=</span> amount
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            total_expenses <span style=color:#f92672>+=</span> amount
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total income: $</span><span style=color:#e6db74>{</span>total_income<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total expenses: $</span><span style=color:#e6db74>{</span>total_expenses<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Net cash flow: $</span><span style=color:#e6db74>{</span>total_income <span style=color:#f92672>+</span> total_expenses<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3 id=writing-to-text-files>Writing to Text Files<a hidden class=anchor aria-hidden=true href=#writing-to-text-files>#</a></h3><p>Let&rsquo;s create a simple financial report:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Sample transaction data</span>
</span></span><span style=display:flex><span>transactions <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#34;date&#34;</span>: <span style=color:#e6db74>&#34;2025-01-15&#34;</span>, <span style=color:#e6db74>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Office supplies&#34;</span>, <span style=color:#e6db74>&#34;amount&#34;</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>129.99</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#34;date&#34;</span>: <span style=color:#e6db74>&#34;2025-01-18&#34;</span>, <span style=color:#e6db74>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Client payment&#34;</span>, <span style=color:#e6db74>&#34;amount&#34;</span>: <span style=color:#ae81ff>1500.00</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#34;date&#34;</span>: <span style=color:#e6db74>&#34;2025-01-22&#34;</span>, <span style=color:#e6db74>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Software subscription&#34;</span>, <span style=color:#e6db74>&#34;amount&#34;</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>49.99</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#34;date&#34;</span>: <span style=color:#e6db74>&#34;2025-01-30&#34;</span>, <span style=color:#e6db74>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Consulting fees&#34;</span>, <span style=color:#e6db74>&#34;amount&#34;</span>: <span style=color:#ae81ff>2750.00</span>}
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate summary statistics</span>
</span></span><span style=display:flex><span>total_income <span style=color:#f92672>=</span> sum(t[<span style=color:#e6db74>&#34;amount&#34;</span>] <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> transactions <span style=color:#66d9ef>if</span> t[<span style=color:#e6db74>&#34;amount&#34;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>total_expenses <span style=color:#f92672>=</span> sum(t[<span style=color:#e6db74>&#34;amount&#34;</span>] <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> transactions <span style=color:#66d9ef>if</span> t[<span style=color:#e6db74>&#34;amount&#34;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>net_cash_flow <span style=color:#f92672>=</span> total_income <span style=color:#f92672>+</span> total_expenses
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write the report to a file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;financial_report.txt&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> report_file:
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;MONTHLY FINANCIAL REPORT</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;======================</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;TRANSACTION DETAILS:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;-----------------</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> transactions:
</span></span><span style=display:flex><span>        amount_str <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;$</span><span style=color:#e6db74>{</span>abs(t[<span style=color:#e6db74>&#39;amount&#39;</span>])<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> t[<span style=color:#e6db74>&#34;amount&#34;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            amount_str <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;-</span><span style=color:#e6db74>{</span>amount_str<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>t[<span style=color:#e6db74>&#39;date&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span>t[<span style=color:#e6db74>&#39;description&#39;</span>]<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>20</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span>amount_str<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>SUMMARY:</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;--------</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total Income:    $</span><span style=color:#e6db74>{</span>total_income<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total Expenses:  $</span><span style=color:#e6db74>{</span>total_expenses<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    report_file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Net Cash Flow:   $</span><span style=color:#e6db74>{</span>net_cash_flow<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Financial report generated: financial_report.txt&#34;</span>)
</span></span></code></pre></div><h3 id=handling-different-file-modes>Handling Different File Modes<a hidden class=anchor aria-hidden=true href=#handling-different-file-modes>#</a></h3><ul><li><code>'r'</code>: Read (default)</li><li><code>'w'</code>: Write (creates new file or truncates existing)</li><li><code>'a'</code>: Append (adds to end of file)</li><li><code>'r+'</code>: Read and write</li><li><code>'b'</code>: Binary mode (used with other modes, e.g., <code>'rb'</code>)</li></ul><h2 id=working-with-csv-files>Working with CSV Files<a hidden class=anchor aria-hidden=true href=#working-with-csv-files>#</a></h2><p>While you can process CSV files manually as shown above, Python&rsquo;s <code>csv</code> module makes it easier:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Reading CSV</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;transactions.csv&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    csv_reader <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictReader(file)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process each row as a dictionary</span>
</span></span><span style=display:flex><span>    transactions <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> csv_reader:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Convert amount from string to float</span>
</span></span><span style=display:flex><span>        row[<span style=color:#e6db74>&#39;amount&#39;</span>] <span style=color:#f92672>=</span> float(row[<span style=color:#e6db74>&#39;amount&#39;</span>])
</span></span><span style=display:flex><span>        transactions<span style=color:#f92672>.</span>append(row)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Loaded </span><span style=color:#e6db74>{</span>len(transactions)<span style=color:#e6db74>}</span><span style=color:#e6db74> transactions&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Writing CSV</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;budget_forecast.csv&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>, newline<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Define column headers</span>
</span></span><span style=display:flex><span>    fieldnames <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;month&#39;</span>, <span style=color:#e6db74>&#39;revenue&#39;</span>, <span style=color:#e6db74>&#39;expenses&#39;</span>, <span style=color:#e6db74>&#39;profit&#39;</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Create CSV writer</span>
</span></span><span style=display:flex><span>    csv_writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictWriter(file, fieldnames<span style=color:#f92672>=</span>fieldnames)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Write header row</span>
</span></span><span style=display:flex><span>    csv_writer<span style=color:#f92672>.</span>writeheader()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Write data rows</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> month <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>13</span>):
</span></span><span style=display:flex><span>        <span style=color:#75715e># Simple forecast model (for demonstration)</span>
</span></span><span style=display:flex><span>        revenue <span style=color:#f92672>=</span> <span style=color:#ae81ff>15000</span> <span style=color:#f92672>+</span> (month <span style=color:#f92672>*</span> <span style=color:#ae81ff>500</span>)  <span style=color:#75715e># Increasing monthly</span>
</span></span><span style=display:flex><span>        expenses <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span> <span style=color:#f92672>+</span> (month <span style=color:#f92672>*</span> <span style=color:#ae81ff>200</span>)  <span style=color:#75715e># Increasing but slower</span>
</span></span><span style=display:flex><span>        profit <span style=color:#f92672>=</span> revenue <span style=color:#f92672>-</span> expenses
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        csv_writer<span style=color:#f92672>.</span>writerow({
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;month&#39;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;2025-</span><span style=color:#e6db74>{</span>month<span style=color:#e6db74>:</span><span style=color:#e6db74>02d</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;revenue&#39;</span>: revenue,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;expenses&#39;</span>: expenses,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;profit&#39;</span>: profit
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Budget forecast generated: budget_forecast.csv&#34;</span>)
</span></span></code></pre></div><h2 id=practical-example-expense-analyser>Practical Example: Expense Analyser<a hidden class=anchor aria-hidden=true href=#practical-example-expense-analyser>#</a></h2><p>Let&rsquo;s combine everything we&rsquo;ve learned into a practical financial tool that:</p><ol><li>Reads expense data from a CSV file</li><li>Categorises and analyses expenses</li><li>Generates a report with summary statistics</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_expenses</span>(filename):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Load expense data from a CSV file.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    expenses <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        reader <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictReader(file)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> reader:
</span></span><span style=display:flex><span>            <span style=color:#75715e># Convert amount to float and date to datetime</span>
</span></span><span style=display:flex><span>            row[<span style=color:#e6db74>&#39;amount&#39;</span>] <span style=color:#f92672>=</span> float(row[<span style=color:#e6db74>&#39;amount&#39;</span>])
</span></span><span style=display:flex><span>            row[<span style=color:#e6db74>&#39;date&#39;</span>] <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>strptime(row[<span style=color:#e6db74>&#39;date&#39;</span>], <span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>            expenses<span style=color:#f92672>.</span>append(row)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> expenses
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>categorize_expenses</span>(expenses):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Group expenses by category.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    categories <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> expense <span style=color:#f92672>in</span> expenses:
</span></span><span style=display:flex><span>        category <span style=color:#f92672>=</span> expense[<span style=color:#e6db74>&#39;category&#39;</span>]
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> category <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> categories:
</span></span><span style=display:flex><span>            categories[category] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        categories[category]<span style=color:#f92672>.</span>append(expense)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> categories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_category_totals</span>(categories):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Calculate total amount for each expense category.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    totals <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> category, expenses <span style=color:#f92672>in</span> categories<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>        totals[category] <span style=color:#f92672>=</span> sum(expense[<span style=color:#e6db74>&#39;amount&#39;</span>] <span style=color:#66d9ef>for</span> expense <span style=color:#f92672>in</span> expenses)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> totals
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_expense_report</span>(expenses, categories, totals, output_file):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Generate a detailed expense report.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    total_expenses <span style=color:#f92672>=</span> sum(totals<span style=color:#f92672>.</span>values())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(output_file, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Write header</span>
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;EXPENSE ANALYSIS REPORT</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;======================</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Write summary</span>
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Total Expenses: $</span><span style=color:#e6db74>{</span>total_expenses<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Number of Transactions: </span><span style=color:#e6db74>{</span>len(expenses)<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Date Range: </span><span style=color:#e6db74>{</span>min(e[<span style=color:#e6db74>&#39;date&#39;</span>] <span style=color:#66d9ef>for</span> e <span style=color:#f92672>in</span> expenses)<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74> to </span><span style=color:#e6db74>{</span>max(e[<span style=color:#e6db74>&#39;date&#39;</span>] <span style=color:#66d9ef>for</span> e <span style=color:#f92672>in</span> expenses)<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Write category breakdown</span>
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;EXPENSE BREAKDOWN BY CATEGORY</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;----------------------------</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Sort categories by total amount (descending)</span>
</span></span><span style=display:flex><span>        sorted_categories <span style=color:#f92672>=</span> sorted(totals<span style=color:#f92672>.</span>items(), key<span style=color:#f92672>=</span><span style=color:#66d9ef>lambda</span> x: x[<span style=color:#ae81ff>1</span>], reverse<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> category, amount <span style=color:#f92672>in</span> sorted_categories:
</span></span><span style=display:flex><span>            percentage <span style=color:#f92672>=</span> (amount <span style=color:#f92672>/</span> total_expenses) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>            file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>category<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>20</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74> $</span><span style=color:#e6db74>{</span>amount<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#e6db74> (</span><span style=color:#e6db74>{</span>percentage<span style=color:#e6db74>:</span><span style=color:#e6db74>.1f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>%)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Write transaction details for each category</span>
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>DETAILED TRANSACTIONS BY CATEGORY</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;--------------------------------</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> category, amount <span style=color:#f92672>in</span> sorted_categories:
</span></span><span style=display:flex><span>            file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>category<span style=color:#f92672>.</span>upper()<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;-&#39;</span> <span style=color:#f92672>*</span> len(category)<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Sort expenses by date</span>
</span></span><span style=display:flex><span>            sorted_expenses <span style=color:#f92672>=</span> sorted(categories[category], key<span style=color:#f92672>=</span><span style=color:#66d9ef>lambda</span> x: x[<span style=color:#e6db74>&#39;date&#39;</span>])
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> expense <span style=color:#f92672>in</span> sorted_expenses:
</span></span><span style=display:flex><span>                date_str <span style=color:#f92672>=</span> expense[<span style=color:#e6db74>&#39;date&#39;</span>]<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>                file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>date_str<span style=color:#e6db74>}</span><span style=color:#e6db74> | </span><span style=color:#e6db74>{</span>expense[<span style=color:#e6db74>&#39;description&#39;</span>]<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>30</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74> | $</span><span style=color:#e6db74>{</span>expense[<span style=color:#e6db74>&#39;amount&#39;</span>]<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># Add category subtotal</span>
</span></span><span style=display:flex><span>            file<span style=color:#f92672>.</span>write(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span><span style=color:#e6db74>&#39;SUBTOTAL:&#39;</span><span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>41</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74> $</span><span style=color:#e6db74>{</span>amount<span style=color:#e6db74>:</span><span style=color:#e6db74>.2f</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Usage example (assuming we have an expenses.csv file)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># Check if the input file exists</span>
</span></span><span style=display:flex><span>    input_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;expenses.csv&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(input_file):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error: File &#39;</span><span style=color:#e6db74>{</span>input_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; not found.&#34;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Creating a sample expense file for demonstration...&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># Create a sample file for demonstration</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(input_file, <span style=color:#e6db74>&#39;w&#39;</span>, newline<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>            writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>writer(file)
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;date&#39;</span>, <span style=color:#e6db74>&#39;category&#39;</span>, <span style=color:#e6db74>&#39;description&#39;</span>, <span style=color:#e6db74>&#39;amount&#39;</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-05&#39;</span>, <span style=color:#e6db74>&#39;Office&#39;</span>, <span style=color:#e6db74>&#39;Printer paper&#39;</span>, <span style=color:#ae81ff>24.99</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-10&#39;</span>, <span style=color:#e6db74>&#39;Software&#39;</span>, <span style=color:#e6db74>&#39;Accounting software&#39;</span>, <span style=color:#ae81ff>89.99</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-15&#39;</span>, <span style=color:#e6db74>&#39;Office&#39;</span>, <span style=color:#e6db74>&#39;Desk organiser&#39;</span>, <span style=color:#ae81ff>32.50</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-18&#39;</span>, <span style=color:#e6db74>&#39;Travel&#39;</span>, <span style=color:#e6db74>&#39;Client meeting transportation&#39;</span>, <span style=color:#ae81ff>45.75</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-22&#39;</span>, <span style=color:#e6db74>&#39;Software&#39;</span>, <span style=color:#e6db74>&#39;Cloud storage subscription&#39;</span>, <span style=color:#ae81ff>9.99</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-25&#39;</span>, <span style=color:#e6db74>&#39;Meals&#39;</span>, <span style=color:#e6db74>&#39;Team lunch&#39;</span>, <span style=color:#ae81ff>87.50</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-01-29&#39;</span>, <span style=color:#e6db74>&#39;Office&#39;</span>, <span style=color:#e6db74>&#39;Printer ink&#39;</span>, <span style=color:#ae81ff>65.85</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-02-03&#39;</span>, <span style=color:#e6db74>&#39;Travel&#39;</span>, <span style=color:#e6db74>&#39;Conference registration&#39;</span>, <span style=color:#ae81ff>299.00</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-02-07&#39;</span>, <span style=color:#e6db74>&#39;Meals&#39;</span>, <span style=color:#e6db74>&#39;Client dinner&#39;</span>, <span style=color:#ae81ff>125.40</span>])
</span></span><span style=display:flex><span>            writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#39;2025-02-15&#39;</span>, <span style=color:#e6db74>&#39;Software&#39;</span>, <span style=color:#e6db74>&#39;Data analysis tool&#39;</span>, <span style=color:#ae81ff>149.99</span>])
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Sample file &#39;</span><span style=color:#e6db74>{</span>input_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39; created.&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Process the expense data</span>
</span></span><span style=display:flex><span>    expenses <span style=color:#f92672>=</span> load_expenses(input_file)
</span></span><span style=display:flex><span>    categories <span style=color:#f92672>=</span> categorize_expenses(expenses)
</span></span><span style=display:flex><span>    totals <span style=color:#f92672>=</span> calculate_category_totals(categories)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Generate the report</span>
</span></span><span style=display:flex><span>    output_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;expense_report.txt&#39;</span>
</span></span><span style=display:flex><span>    generate_expense_report(expenses, categories, totals, output_file)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Expense report generated: </span><span style=color:#e6db74>{</span>output_file<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>This script demonstrates:</p><ul><li>Function definitions with docstrings</li><li>File I/O with the <code>with</code> statement</li><li>CSV processing</li><li>Module imports and usage</li><li>Error handling</li></ul><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Functions, modules, and file I/O form the backbone of most Python applications, especially for financial tasks. By mastering these concepts, you&rsquo;ll be well-equipped to build tools for financial analysis, reporting, and automation.</p><p>In the next post, we&rsquo;ll explore virtual environments and package management, which will help you manage dependencies for larger projects.</p><p><strong>Practice Exercise:</strong> Try extending the expense analyser to calculate monthly trends or generate a simple visualisation of spending by category. This will help reinforce the concepts we&rsquo;ve covered while building something useful for your financial toolkit.</p></div><div class=related-posts><h2>Related Posts</h2><div class=related-posts-grid><article class=related-post><a href=https://michaelbrunger.com/python-core-data-structures/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 4: Core Data Structures in Python</h3><p class=related-post-description>Explore Python's essential data structures: lists, tuples, dictionaries, and sets. Learn creation methods, manipulation techniques, and guidelines for choosing the right structure for your tasks.</p><div class=related-post-meta><time datetime=2025-05-20>May 20, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=https://michaelbrunger.com/python-syntax-fundamentals/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 3: Python Syntax Fundamentals & Language Features</h3><p class=related-post-description>Master Python's core syntax including variables, data types, control flow, comprehensions, lambdas, iterators, generators, and basic error handling mechanisms.</p><div class=related-post-meta><time datetime=2025-05-09>May 9, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article><article class=related-post><a href=https://michaelbrunger.com/python-foundations-editors-ides/ class=related-post-link><div class=related-post-content><h3 class=related-post-title>Part 2: Text Editors vs. IDEs for Python Development</h3><p class=related-post-description>Compare lightweight text editors to full-featured IDEs for Python development. Learn how to set up VS Code with essential Python extensions and discover effective debugging techniques.</p><div class=related-post-meta><time datetime=2025-05-01>May 1, 2025</time><span class=related-post-tags><span class=tag>python</span></span></div></div></a></article></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://michaelbrunger.com/tags/python>python</a></li><li><a href=https://michaelbrunger.com/tags/functions>functions</a></li><li><a href=https://michaelbrunger.com/tags/modules>modules</a></li><li><a href=https://michaelbrunger.com/tags/packages>packages</a></li><li><a href=https://michaelbrunger.com/tags/standard-library>standard library</a></li><li><a href=https://michaelbrunger.com/tags/file-io>file io</a></li><li><a href=https://michaelbrunger.com/tags/file-handling>file handling</a></li></ul><div class=share-buttons><a href="https://twitter.com/intent/tweet?text=Part%205%3a%20Functions%2c%20Modules%20%26%20File%20I%2fO%20in%20Python&url=https%3a%2f%2fmichaelbrunger.com%2fpython-functions-modules-file-io%2f" target=_blank rel=noopener aria-label="Share on Twitter"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fmichaelbrunger.com%2fpython-functions-modules-file-io%2f" target=_blank rel=noopener aria-label="Share on LinkedIn"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmichaelbrunger.com%2fpython-functions-modules-file-io%2f" target=_blank rel=noopener aria-label="Share on Facebook"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</a><a href="https://wa.me/?text=Part%205%3a%20Functions%2c%20Modules%20%26%20File%20I%2fO%20in%20Python%20https%3a%2f%2fmichaelbrunger.com%2fpython-functions-modules-file-io%2f" target=_blank rel=noopener aria-label="Share on WhatsApp"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17.498 14.382c-.301-.15-1.767-.867-2.04-.966-.273-.101-.473-.15-.673.15-.197.295-.771.964-.944 1.162-.175.195-.349.21-.646.075-.3-.15-1.263-.465-2.403-1.485-.888-.795-1.484-1.77-1.66-2.07-.174-.3-.019-.465.13-.615.136-.135.301-.345.451-.523.146-.181.194-.301.297-.496.1-.21.049-.375-.025-.524-.075-.15-.672-1.62-.922-2.206-.24-.584-.487-.51-.672-.51-.172-.015-.371-.015-.571-.015-.2.0-.523.074-.797.359-.273.3-1.045 1.02-1.045 2.475s1.07 2.865 1.219 3.075c.149.195 2.105 3.195 5.1 4.485.714.3 1.27.48 1.704.629.714.227 1.365.195 1.88.121.574-.091 1.767-.721 2.016-1.426.255-.705.255-1.29.18-1.425-.074-.135-.27-.21-.57-.345m-5.446 7.443h-.016c-1.77.0-3.524-.48-5.055-1.38l-.36-.214-3.75.975 1.005-3.645-.239-.375c-.99-1.576-1.516-3.391-1.516-5.26.0-5.445 4.455-9.885 9.942-9.885a9.865 9.865.0 017.021 2.91 9.788 9.788.0 012.909 6.99c-.004 5.444-4.46 9.885-9.935 9.885M20.52 3.449C18.24 1.245 15.24.0 12.045.0 5.463.0.104 5.334.101 11.893c0 2.096.549 4.14 1.595 5.945L0 24l6.335-1.652a12.062 12.062.0 005.71 1.447h.006c6.585.0 11.946-5.336 11.949-11.896.0-3.176-1.24-6.165-3.495-8.411"/></svg>
</a><a href="mailto:?subject=Part%205%3a%20Functions%2c%20Modules%20%26%20File%20I%2fO%20in%20Python&body=https%3a%2f%2fmichaelbrunger.com%2fpython-functions-modules-file-io%2f" aria-label="Share via Email"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://michaelbrunger.com/>Michael Brunger</a> |</span>
<span class=footer-links><a href=mailto:michaelbrunger@gmail.com rel="me noopener" target=_blank>Email</a> |
<a href=https://linkedin.com/in/michael-brunger rel="me noopener" target=_blank>LinkedIn</a> |
<a href=https://michaelbrunger.com/terms/ rel=noopener>Terms</a> |
<a href=https://michaelbrunger.com/privacy/ rel=noopener>Privacy</a></span></footer><div id=back-to-top-container><button id=back-to-top class=back-to-top aria-label="Back to top"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg></button></div><script language=javascript type=text/javascript src=https://michaelbrunger.com/menu-trigger.min.1fdaaaa006c69ae56d0620f2af3adf4d9e797e66d323215185b85818508bac37.js></script><script language=javascript type=text/javascript src=https://michaelbrunger.com/theme.min.dbdbacb710c4de0f72c6167f93e19c4d262f7533c0490e320235feb1955f570d.js></script></body></html>