<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Packages on Michael Brunger</title><link>https://michaelbrunger.com/tags/packages/</link><description>Recent content in Packages on Michael Brunger</description><image><title>Michael Brunger</title><url>https://michaelbrunger.com/site-feature-image.jpg</url><link>https://michaelbrunger.com/site-feature-image.jpg</link></image><generator>Hugo -- 0.146.7</generator><language>en-GB</language><lastBuildDate>Fri, 30 May 2025 22:23:23 +0100</lastBuildDate><atom:link href="https://michaelbrunger.com/tags/packages/index.xml" rel="self" type="application/rss+xml"/><item><title>Part 5: Functions, Modules &amp; File I/O in Python</title><link>https://michaelbrunger.com/python-functions-modules-file-io/</link><pubDate>Fri, 30 May 2025 00:00:00 +0000</pubDate><guid>https://michaelbrunger.com/python-functions-modules-file-io/</guid><description>Learn how to define and use functions, organize code into modules, leverage Python&amp;#39;s Standard Library, and perform file operations for reading and writing data.</description><content:encoded><![CDATA[<h1 id="functions-modules--file-io-in-python">Functions, Modules &amp; File I/O in Python</h1>
<p>These next concepts incredibly useful for organising code and working with external data. Let&rsquo;s explore how Python handles functions, modules, and file operations - all essential skills for financial analysis and reporting.</p>
<h2 id="defining-and-calling-functions">Defining and Calling Functions</h2>
<p>Functions are reusable blocks of code that perform specific tasks. They help keep your code DRY (Don&rsquo;t Repeat Yourself) and make it more maintainable.</p>
<h3 id="basic-function-syntax">Basic Function Syntax</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">function_name</span>(parameters):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Docstring explaining what the function does.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Function body</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result  <span style="color:#75715e"># Optional</span>
</span></span></code></pre></div><p>Here&rsquo;s a simple function that calculates compound interest:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_compound_interest</span>(principal, rate, time, compounds_per_year<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Calculate compound interest.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        principal: Initial investment amount
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        rate: Annual interest rate (as decimal, e.g., 0.05 for 5%)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        time: Time period in years
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        compounds_per_year: Number of times interest compounds per year (default=1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        The final amount after compound interest
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> principal <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> rate<span style="color:#f92672">/</span>compounds_per_year)<span style="color:#f92672">**</span>(compounds_per_year<span style="color:#f92672">*</span>time)
</span></span></code></pre></div><p>Let&rsquo;s call this function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Calculate investment growth at 5% interest, compounded quarterly for 10 years</span>
</span></span><span style="display:flex;"><span>initial_investment <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>final_amount <span style="color:#f92672">=</span> calculate_compound_interest(
</span></span><span style="display:flex;"><span>    principal<span style="color:#f92672">=</span>initial_investment, 
</span></span><span style="display:flex;"><span>    rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.05</span>, 
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, 
</span></span><span style="display:flex;"><span>    compounds_per_year<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;$</span><span style="color:#e6db74">{</span>initial_investment<span style="color:#e6db74">}</span><span style="color:#e6db74"> will grow to $</span><span style="color:#e6db74">{</span>final_amount<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> after 10 years&#34;</span>)
</span></span></code></pre></div><p><strong>Output:</strong></p>
<pre tabindex="0"><code>$10000 will grow to $16470.09 after 10 years
</code></pre><h3 id="function-arguments">Function Arguments</h3>
<p>Python offers flexible ways to handle function arguments:</p>
<h4 id="positional-vs-keyword-arguments">Positional vs. Keyword Arguments</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Positional arguments (order matters)</span>
</span></span><span style="display:flex;"><span>result1 <span style="color:#f92672">=</span> calculate_compound_interest(<span style="color:#ae81ff">10000</span>, <span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keyword arguments (order doesn&#39;t matter)</span>
</span></span><span style="display:flex;"><span>result2 <span style="color:#f92672">=</span> calculate_compound_interest(
</span></span><span style="display:flex;"><span>    rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.05</span>,
</span></span><span style="display:flex;"><span>    principal<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>    compounds_per_year<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>    time<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h4 id="default-parameter-values">Default Parameter Values</h4>
<p>In our function, <code>compounds_per_year=1</code> provides a default value if not specified:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Using the default compounds_per_year (annual compounding)</span>
</span></span><span style="display:flex;"><span>annual_result <span style="color:#f92672">=</span> calculate_compound_interest(<span style="color:#ae81ff">10000</span>, <span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;With annual compounding: $</span><span style="color:#e6db74">{</span>annual_result<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h4 id="variable-number-of-arguments">Variable Number of Arguments</h4>
<p>For functions that need to accept varying numbers of arguments:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># *args collects extra positional arguments as a tuple</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sum_all_values</span>(<span style="color:#f92672">*</span>args):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Sum any number of values.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sum(args)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># **kwargs collects extra keyword arguments as a dictionary</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_financial_report</span>(report_date, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Create a financial report with flexible data points.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    report <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;date&#34;</span>: report_date}
</span></span><span style="display:flex;"><span>    report<span style="color:#f92672">.</span>update(kwargs)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> report
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Example usage</span>
</span></span><span style="display:flex;"><span>total <span style="color:#f92672">=</span> sum_all_values(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">75</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total: $</span><span style="color:#e6db74">{</span>total<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>report <span style="color:#f92672">=</span> create_financial_report(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;2025-04-28&#34;</span>,
</span></span><span style="display:flex;"><span>    revenue<span style="color:#f92672">=</span><span style="color:#ae81ff">150000</span>,
</span></span><span style="display:flex;"><span>    expenses<span style="color:#f92672">=</span><span style="color:#ae81ff">95000</span>,
</span></span><span style="display:flex;"><span>    net_profit<span style="color:#f92672">=</span><span style="color:#ae81ff">55000</span>,
</span></span><span style="display:flex;"><span>    profit_margin<span style="color:#f92672">=</span><span style="color:#ae81ff">0.37</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>print(report)
</span></span></code></pre></div><h2 id="variable-scope-and-namespaces">Variable Scope and Namespaces</h2>
<p>Understanding scope is crucial for debugging and writing clean code.</p>
<h3 id="local-vs-global-scope">Local vs. Global Scope</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>total_assets <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000000</span>  <span style="color:#75715e"># Global variable</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_roi</span>(profit):
</span></span><span style="display:flex;"><span>    investment <span style="color:#f92672">=</span> <span style="color:#ae81ff">100000</span>  <span style="color:#75715e"># Local variable</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> profit <span style="color:#f92672">/</span> investment <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># investment is not accessible here</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total assets: $</span><span style="color:#e6db74">{</span>total_assets<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>roi <span style="color:#f92672">=</span> calculate_roi(<span style="color:#ae81ff">25000</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ROI: </span><span style="color:#e6db74">{</span>roi<span style="color:#e6db74">}</span><span style="color:#e6db74">%&#34;</span>)
</span></span></code></pre></div><p>Local variables exist only within their function. Global variables can be accessed inside functions, but to modify them, you need the <code>global</code> keyword:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>balance <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>  <span style="color:#75715e"># Global variable</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">deposit</span>(amount):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> balance  <span style="color:#75715e"># Tell Python we want to modify the global variable</span>
</span></span><span style="display:flex;"><span>    balance <span style="color:#f92672">+=</span> amount
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> balance
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">withdraw</span>(amount):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> balance
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> balance <span style="color:#f92672">&gt;=</span> amount:
</span></span><span style="display:flex;"><span>        balance <span style="color:#f92672">-=</span> amount
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> balance
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Insufficient funds&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Initial balance: $</span><span style="color:#e6db74">{</span>balance<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>deposit(<span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;After deposit: $</span><span style="color:#e6db74">{</span>balance<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>withdraw(<span style="color:#ae81ff">2000</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;After withdrawal: $</span><span style="color:#e6db74">{</span>balance<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="namespaces">Namespaces</h3>
<p>Python uses namespaces to organise names and avoid conflicts. Each module, function, and class has its own namespace.</p>
<h2 id="organising-code-into-modules-and-packages">Organising Code into Modules and Packages</h2>
<p>As your financial scripts grow, organising code becomes essential.</p>
<h3 id="modules">Modules</h3>
<p>A module is simply a <code>.py</code> file containing code. Let&rsquo;s create a financial utilities module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># financial_utils.py</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_roi</span>(profit, investment):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Calculate Return on Investment as a percentage.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (profit <span style="color:#f92672">/</span> investment) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_npv</span>(cash_flows, discount_rate):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Calculate Net Present Value of a series of cash flows.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        cash_flows: List of cash flows, where index 0 is the initial investment (negative)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        discount_rate: Discount rate as decimal (e.g., 0.1 for 10%)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    npv <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> t, cash_flow <span style="color:#f92672">in</span> enumerate(cash_flows):
</span></span><span style="display:flex;"><span>        npv <span style="color:#f92672">+=</span> cash_flow <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> discount_rate) <span style="color:#f92672">**</span> t
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> npv
</span></span></code></pre></div><p>To use this module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># main.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> financial_utils
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate ROI</span>
</span></span><span style="display:flex;"><span>investment <span style="color:#f92672">=</span> <span style="color:#ae81ff">50000</span>
</span></span><span style="display:flex;"><span>profit <span style="color:#f92672">=</span> <span style="color:#ae81ff">12500</span>
</span></span><span style="display:flex;"><span>roi <span style="color:#f92672">=</span> financial_utils<span style="color:#f92672">.</span>calculate_roi(profit, investment)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ROI: </span><span style="color:#e6db74">{</span>roi<span style="color:#e6db74">}</span><span style="color:#e6db74">%&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate NPV of a project</span>
</span></span><span style="display:flex;"><span>cash_flows <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">100000</span>, <span style="color:#ae81ff">30000</span>, <span style="color:#ae81ff">35000</span>, <span style="color:#ae81ff">45000</span>, <span style="color:#ae81ff">50000</span>]  <span style="color:#75715e"># Initial investment + 4 years of returns</span>
</span></span><span style="display:flex;"><span>npv <span style="color:#f92672">=</span> financial_utils<span style="color:#f92672">.</span>calculate_npv(cash_flows, <span style="color:#ae81ff">0.08</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;NPV: $</span><span style="color:#e6db74">{</span>npv<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>You can also import specific functions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> financial_utils <span style="color:#f92672">import</span> calculate_roi, calculate_npv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Now use without the module prefix</span>
</span></span><span style="display:flex;"><span>roi <span style="color:#f92672">=</span> calculate_roi(<span style="color:#ae81ff">12500</span>, <span style="color:#ae81ff">50000</span>)
</span></span></code></pre></div><h3 id="packages">Packages</h3>
<p>Packages are directories containing multiple modules. They require an <code>__init__.py</code> file (which can be empty) to be recognised as packages.</p>
<pre tabindex="0"><code>finance_package/
├── __init__.py
├── analysis.py
├── reporting.py
└── utils.py
</code></pre><p>Using packages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Import specific modules from a package</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> finance_package <span style="color:#f92672">import</span> analysis, reporting
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Import specific functions from a module in a package</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> finance_package.utils <span style="color:#f92672">import</span> calculate_roi
</span></span></code></pre></div><h2 id="exploring-the-standard-library">Exploring the Standard Library</h2>
<p>Python comes with a rich standard library. Here are some modules particularly useful for financial applications:</p>
<h3 id="math-module">Math Module</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate loan payment using the PMT formula</span>
</span></span><span style="display:flex;"><span>principal <span style="color:#f92672">=</span> <span style="color:#ae81ff">250000</span>
</span></span><span style="display:flex;"><span>annual_rate <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.04</span>  <span style="color:#75715e"># 4%</span>
</span></span><span style="display:flex;"><span>years <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>monthly_rate <span style="color:#f92672">=</span> annual_rate <span style="color:#f92672">/</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>num_payments <span style="color:#f92672">=</span> years <span style="color:#f92672">*</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Monthly payment formula</span>
</span></span><span style="display:flex;"><span>payment <span style="color:#f92672">=</span> principal <span style="color:#f92672">*</span> (monthly_rate <span style="color:#f92672">*</span> math<span style="color:#f92672">.</span>pow(<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> monthly_rate, num_payments)) <span style="color:#f92672">/</span> (math<span style="color:#f92672">.</span>pow(<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> monthly_rate, num_payments) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Monthly mortgage payment: $</span><span style="color:#e6db74">{</span>payment<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="random-module">Random Module</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Simulate stock price movements (very simplified)</span>
</span></span><span style="display:flex;"><span>starting_price <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>daily_volatility <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.015</span>  <span style="color:#75715e"># 1.5%</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prices <span style="color:#f92672">=</span> [starting_price]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> day <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">30</span>):
</span></span><span style="display:flex;"><span>    change <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>normalvariate(<span style="color:#ae81ff">0</span>, daily_volatility)
</span></span><span style="display:flex;"><span>    new_price <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> change)
</span></span><span style="display:flex;"><span>    prices<span style="color:#f92672">.</span>append(new_price)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Starting price: $</span><span style="color:#e6db74">{</span>starting_price<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Ending price: $</span><span style="color:#e6db74">{</span>prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;30-day return: </span><span style="color:#e6db74">{</span>(prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">/</span>prices[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span><span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">%&#34;</span>)
</span></span></code></pre></div><h3 id="datetime-module">Datetime Module</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, timedelta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate business days between dates</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">business_days_between</span>(start_date, end_date):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Count business days between two dates (excluding weekends).&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    days <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    current_date <span style="color:#f92672">=</span> start_date
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> current_date <span style="color:#f92672">&lt;=</span> end_date:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Monday = 0, Sunday = 6</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> current_date<span style="color:#f92672">.</span>weekday() <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">5</span>:  <span style="color:#75715e"># Only count weekdays (0-4)</span>
</span></span><span style="display:flex;"><span>            days <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        current_date <span style="color:#f92672">+=</span> timedelta(days<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> days
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate days until fiscal year end</span>
</span></span><span style="display:flex;"><span>today <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
</span></span><span style="display:flex;"><span>fiscal_year_end <span style="color:#f92672">=</span> datetime(today<span style="color:#f92672">.</span>year, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> today <span style="color:#f92672">&gt;</span> fiscal_year_end:
</span></span><span style="display:flex;"><span>    fiscal_year_end <span style="color:#f92672">=</span> datetime(today<span style="color:#f92672">.</span>year <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>business_days <span style="color:#f92672">=</span> business_days_between(today, fiscal_year_end)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Business days until fiscal year end: </span><span style="color:#e6db74">{</span>business_days<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="os-and-sys-modules">OS and Sys Modules</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the current working directory (useful for file paths)</span>
</span></span><span style="display:flex;"><span>current_dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getcwd()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Current directory: </span><span style="color:#e6db74">{</span>current_dir<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># List all Excel files in the current directory</span>
</span></span><span style="display:flex;"><span>excel_files <span style="color:#f92672">=</span> [file <span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir() <span style="color:#66d9ef">if</span> file<span style="color:#f92672">.</span>endswith((<span style="color:#e6db74">&#39;.xlsx&#39;</span>, <span style="color:#e6db74">&#39;.xls&#39;</span>))]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Excel files found:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> excel_files:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;- </span><span style="color:#e6db74">{</span>file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get Python version and platform information</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Python version: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>version<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Platform: </span><span style="color:#e6db74">{</span>sys<span style="color:#f92672">.</span>platform<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="reading-fromwriting-to-text-files">Reading from/Writing to Text Files</h2>
<p>File operations are essential for financial data analysis, reporting, and automation.</p>
<h3 id="opening-and-closing-files">Opening and Closing Files</h3>
<p>The basic pattern is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Open a file in read mode</span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;data.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Do something with the file</span>
</span></span><span style="display:flex;"><span>content <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Close the file</span>
</span></span><span style="display:flex;"><span>file<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><p>However, this approach has problems if an error occurs before <code>close()</code>. The preferred way is using the <code>with</code> statement:</p>
<h3 id="the-with-statement">The with Statement</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Automatically handles proper closing of the file</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;data.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    content <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># File processing here</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># File is automatically closed when the block ends</span>
</span></span></code></pre></div><h3 id="reading-text-files">Reading Text Files</h3>
<p>Let&rsquo;s work with a sample CSV file containing financial transactions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Sample contents of transactions.csv:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># date,description,amount</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2025-01-15,Office supplies,-129.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2025-01-18,Client payment,1500.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2025-01-22,Software subscription,-49.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2025-01-30,Consulting fees,2750.00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;transactions.csv&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Read the entire file as a single string</span>
</span></span><span style="display:flex;"><span>    content <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;File contents:&#34;</span>)
</span></span><span style="display:flex;"><span>    print(content)
</span></span></code></pre></div><p>Reading line by line:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;transactions.csv&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Skip header</span>
</span></span><span style="display:flex;"><span>    header <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>readline()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Initialise counters</span>
</span></span><span style="display:flex;"><span>    total_income <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    total_expenses <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Process each transaction</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> file:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Remove whitespace and split by comma</span>
</span></span><span style="display:flex;"><span>        date, description, amount <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Convert amount to float</span>
</span></span><span style="display:flex;"><span>        amount <span style="color:#f92672">=</span> float(amount)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> amount <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            total_income <span style="color:#f92672">+=</span> amount
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            total_expenses <span style="color:#f92672">+=</span> amount
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total income: $</span><span style="color:#e6db74">{</span>total_income<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total expenses: $</span><span style="color:#e6db74">{</span>total_expenses<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Net cash flow: $</span><span style="color:#e6db74">{</span>total_income <span style="color:#f92672">+</span> total_expenses<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="writing-to-text-files">Writing to Text Files</h3>
<p>Let&rsquo;s create a simple financial report:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Sample transaction data</span>
</span></span><span style="display:flex;"><span>transactions <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;2025-01-15&#34;</span>, <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Office supplies&#34;</span>, <span style="color:#e6db74">&#34;amount&#34;</span>: <span style="color:#f92672">-</span><span style="color:#ae81ff">129.99</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;2025-01-18&#34;</span>, <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Client payment&#34;</span>, <span style="color:#e6db74">&#34;amount&#34;</span>: <span style="color:#ae81ff">1500.00</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;2025-01-22&#34;</span>, <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Software subscription&#34;</span>, <span style="color:#e6db74">&#34;amount&#34;</span>: <span style="color:#f92672">-</span><span style="color:#ae81ff">49.99</span>},
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#34;date&#34;</span>: <span style="color:#e6db74">&#34;2025-01-30&#34;</span>, <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Consulting fees&#34;</span>, <span style="color:#e6db74">&#34;amount&#34;</span>: <span style="color:#ae81ff">2750.00</span>}
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate summary statistics</span>
</span></span><span style="display:flex;"><span>total_income <span style="color:#f92672">=</span> sum(t[<span style="color:#e6db74">&#34;amount&#34;</span>] <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> transactions <span style="color:#66d9ef">if</span> t[<span style="color:#e6db74">&#34;amount&#34;</span>] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>total_expenses <span style="color:#f92672">=</span> sum(t[<span style="color:#e6db74">&#34;amount&#34;</span>] <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> transactions <span style="color:#66d9ef">if</span> t[<span style="color:#e6db74">&#34;amount&#34;</span>] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>net_cash_flow <span style="color:#f92672">=</span> total_income <span style="color:#f92672">+</span> total_expenses
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Write the report to a file</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;financial_report.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> report_file:
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;MONTHLY FINANCIAL REPORT</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;======================</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;TRANSACTION DETAILS:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;-----------------</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> transactions:
</span></span><span style="display:flex;"><span>        amount_str <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;$</span><span style="color:#e6db74">{</span>abs(t[<span style="color:#e6db74">&#39;amount&#39;</span>])<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> t[<span style="color:#e6db74">&#34;amount&#34;</span>] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            amount_str <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;-</span><span style="color:#e6db74">{</span>amount_str<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>t[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> | </span><span style="color:#e6db74">{</span>t[<span style="color:#e6db74">&#39;description&#39;</span>]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">20</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> | </span><span style="color:#e6db74">{</span>amount_str<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">SUMMARY:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;--------</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total Income:    $</span><span style="color:#e6db74">{</span>total_income<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total Expenses:  $</span><span style="color:#e6db74">{</span>total_expenses<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    report_file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Net Cash Flow:   $</span><span style="color:#e6db74">{</span>net_cash_flow<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Financial report generated: financial_report.txt&#34;</span>)
</span></span></code></pre></div><h3 id="handling-different-file-modes">Handling Different File Modes</h3>
<ul>
<li><code>'r'</code>: Read (default)</li>
<li><code>'w'</code>: Write (creates new file or truncates existing)</li>
<li><code>'a'</code>: Append (adds to end of file)</li>
<li><code>'r+'</code>: Read and write</li>
<li><code>'b'</code>: Binary mode (used with other modes, e.g., <code>'rb'</code>)</li>
</ul>
<h2 id="working-with-csv-files">Working with CSV Files</h2>
<p>While you can process CSV files manually as shown above, Python&rsquo;s <code>csv</code> module makes it easier:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> csv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reading CSV</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;transactions.csv&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    csv_reader <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>DictReader(file)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Process each row as a dictionary</span>
</span></span><span style="display:flex;"><span>    transactions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> csv_reader:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Convert amount from string to float</span>
</span></span><span style="display:flex;"><span>        row[<span style="color:#e6db74">&#39;amount&#39;</span>] <span style="color:#f92672">=</span> float(row[<span style="color:#e6db74">&#39;amount&#39;</span>])
</span></span><span style="display:flex;"><span>        transactions<span style="color:#f92672">.</span>append(row)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Loaded </span><span style="color:#e6db74">{</span>len(transactions)<span style="color:#e6db74">}</span><span style="color:#e6db74"> transactions&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Writing CSV</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;budget_forecast.csv&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>, newline<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Define column headers</span>
</span></span><span style="display:flex;"><span>    fieldnames <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;month&#39;</span>, <span style="color:#e6db74">&#39;revenue&#39;</span>, <span style="color:#e6db74">&#39;expenses&#39;</span>, <span style="color:#e6db74">&#39;profit&#39;</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create CSV writer</span>
</span></span><span style="display:flex;"><span>    csv_writer <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>DictWriter(file, fieldnames<span style="color:#f92672">=</span>fieldnames)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Write header row</span>
</span></span><span style="display:flex;"><span>    csv_writer<span style="color:#f92672">.</span>writeheader()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Write data rows</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> month <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Simple forecast model (for demonstration)</span>
</span></span><span style="display:flex;"><span>        revenue <span style="color:#f92672">=</span> <span style="color:#ae81ff">15000</span> <span style="color:#f92672">+</span> (month <span style="color:#f92672">*</span> <span style="color:#ae81ff">500</span>)  <span style="color:#75715e"># Increasing monthly</span>
</span></span><span style="display:flex;"><span>        expenses <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span> <span style="color:#f92672">+</span> (month <span style="color:#f92672">*</span> <span style="color:#ae81ff">200</span>)  <span style="color:#75715e"># Increasing but slower</span>
</span></span><span style="display:flex;"><span>        profit <span style="color:#f92672">=</span> revenue <span style="color:#f92672">-</span> expenses
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        csv_writer<span style="color:#f92672">.</span>writerow({
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;month&#39;</span>: <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;2025-</span><span style="color:#e6db74">{</span>month<span style="color:#e6db74">:</span><span style="color:#e6db74">02d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;revenue&#39;</span>: revenue,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;expenses&#39;</span>: expenses,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;profit&#39;</span>: profit
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Budget forecast generated: budget_forecast.csv&#34;</span>)
</span></span></code></pre></div><h2 id="practical-example-expense-analyser">Practical Example: Expense Analyser</h2>
<p>Let&rsquo;s combine everything we&rsquo;ve learned into a practical financial tool that:</p>
<ol>
<li>Reads expense data from a CSV file</li>
<li>Categorises and analyses expenses</li>
<li>Generates a report with summary statistics</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> csv
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_expenses</span>(filename):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Load expense data from a CSV file.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    expenses <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>        reader <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>DictReader(file)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> reader:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Convert amount to float and date to datetime</span>
</span></span><span style="display:flex;"><span>            row[<span style="color:#e6db74">&#39;amount&#39;</span>] <span style="color:#f92672">=</span> float(row[<span style="color:#e6db74">&#39;amount&#39;</span>])
</span></span><span style="display:flex;"><span>            row[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>strptime(row[<span style="color:#e6db74">&#39;date&#39;</span>], <span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            expenses<span style="color:#f92672">.</span>append(row)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> expenses
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">categorize_expenses</span>(expenses):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Group expenses by category.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    categories <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> expense <span style="color:#f92672">in</span> expenses:
</span></span><span style="display:flex;"><span>        category <span style="color:#f92672">=</span> expense[<span style="color:#e6db74">&#39;category&#39;</span>]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> category <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> categories:
</span></span><span style="display:flex;"><span>            categories[category] <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        categories[category]<span style="color:#f92672">.</span>append(expense)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> categories
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculate_category_totals</span>(categories):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Calculate total amount for each expense category.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    totals <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> category, expenses <span style="color:#f92672">in</span> categories<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>        totals[category] <span style="color:#f92672">=</span> sum(expense[<span style="color:#e6db74">&#39;amount&#39;</span>] <span style="color:#66d9ef">for</span> expense <span style="color:#f92672">in</span> expenses)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> totals
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_expense_report</span>(expenses, categories, totals, output_file):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Generate a detailed expense report.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    total_expenses <span style="color:#f92672">=</span> sum(totals<span style="color:#f92672">.</span>values())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(output_file, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write header</span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;EXPENSE ANALYSIS REPORT</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;======================</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write summary</span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Total Expenses: $</span><span style="color:#e6db74">{</span>total_expenses<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Number of Transactions: </span><span style="color:#e6db74">{</span>len(expenses)<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Date Range: </span><span style="color:#e6db74">{</span>min(e[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> expenses)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> to </span><span style="color:#e6db74">{</span>max(e[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#66d9ef">for</span> e <span style="color:#f92672">in</span> expenses)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write category breakdown</span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;EXPENSE BREAKDOWN BY CATEGORY</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;----------------------------</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Sort categories by total amount (descending)</span>
</span></span><span style="display:flex;"><span>        sorted_categories <span style="color:#f92672">=</span> sorted(totals<span style="color:#f92672">.</span>items(), key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">1</span>], reverse<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> category, amount <span style="color:#f92672">in</span> sorted_categories:
</span></span><span style="display:flex;"><span>            percentage <span style="color:#f92672">=</span> (amount <span style="color:#f92672">/</span> total_expenses) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>            file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>category<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">20</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> $</span><span style="color:#e6db74">{</span>amount<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">{</span>percentage<span style="color:#e6db74">:</span><span style="color:#e6db74">.1f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">%)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Write transaction details for each category</span>
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">DETAILED TRANSACTIONS BY CATEGORY</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;--------------------------------</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> category, amount <span style="color:#f92672">in</span> sorted_categories:
</span></span><span style="display:flex;"><span>            file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>category<span style="color:#f92672">.</span>upper()<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;-&#39;</span> <span style="color:#f92672">*</span> len(category)<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Sort expenses by date</span>
</span></span><span style="display:flex;"><span>            sorted_expenses <span style="color:#f92672">=</span> sorted(categories[category], key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> x: x[<span style="color:#e6db74">&#39;date&#39;</span>])
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> expense <span style="color:#f92672">in</span> sorted_expenses:
</span></span><span style="display:flex;"><span>                date_str <span style="color:#f92672">=</span> expense[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>                file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>date_str<span style="color:#e6db74">}</span><span style="color:#e6db74"> | </span><span style="color:#e6db74">{</span>expense[<span style="color:#e6db74">&#39;description&#39;</span>]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">30</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> | $</span><span style="color:#e6db74">{</span>expense[<span style="color:#e6db74">&#39;amount&#39;</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Add category subtotal</span>
</span></span><span style="display:flex;"><span>            file<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;SUBTOTAL:&#39;</span><span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">41</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> $</span><span style="color:#e6db74">{</span>amount<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Usage example (assuming we have an expenses.csv file)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the input file exists</span>
</span></span><span style="display:flex;"><span>    input_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;expenses.csv&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>exists(input_file):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Error: File &#39;</span><span style="color:#e6db74">{</span>input_file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; not found.&#34;</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Creating a sample expense file for demonstration...&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create a sample file for demonstration</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(input_file, <span style="color:#e6db74">&#39;w&#39;</span>, newline<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>            writer <span style="color:#f92672">=</span> csv<span style="color:#f92672">.</span>writer(file)
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;date&#39;</span>, <span style="color:#e6db74">&#39;category&#39;</span>, <span style="color:#e6db74">&#39;description&#39;</span>, <span style="color:#e6db74">&#39;amount&#39;</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-05&#39;</span>, <span style="color:#e6db74">&#39;Office&#39;</span>, <span style="color:#e6db74">&#39;Printer paper&#39;</span>, <span style="color:#ae81ff">24.99</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-10&#39;</span>, <span style="color:#e6db74">&#39;Software&#39;</span>, <span style="color:#e6db74">&#39;Accounting software&#39;</span>, <span style="color:#ae81ff">89.99</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-15&#39;</span>, <span style="color:#e6db74">&#39;Office&#39;</span>, <span style="color:#e6db74">&#39;Desk organiser&#39;</span>, <span style="color:#ae81ff">32.50</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-18&#39;</span>, <span style="color:#e6db74">&#39;Travel&#39;</span>, <span style="color:#e6db74">&#39;Client meeting transportation&#39;</span>, <span style="color:#ae81ff">45.75</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-22&#39;</span>, <span style="color:#e6db74">&#39;Software&#39;</span>, <span style="color:#e6db74">&#39;Cloud storage subscription&#39;</span>, <span style="color:#ae81ff">9.99</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-25&#39;</span>, <span style="color:#e6db74">&#39;Meals&#39;</span>, <span style="color:#e6db74">&#39;Team lunch&#39;</span>, <span style="color:#ae81ff">87.50</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-01-29&#39;</span>, <span style="color:#e6db74">&#39;Office&#39;</span>, <span style="color:#e6db74">&#39;Printer ink&#39;</span>, <span style="color:#ae81ff">65.85</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-02-03&#39;</span>, <span style="color:#e6db74">&#39;Travel&#39;</span>, <span style="color:#e6db74">&#39;Conference registration&#39;</span>, <span style="color:#ae81ff">299.00</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-02-07&#39;</span>, <span style="color:#e6db74">&#39;Meals&#39;</span>, <span style="color:#e6db74">&#39;Client dinner&#39;</span>, <span style="color:#ae81ff">125.40</span>])
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>writerow([<span style="color:#e6db74">&#39;2025-02-15&#39;</span>, <span style="color:#e6db74">&#39;Software&#39;</span>, <span style="color:#e6db74">&#39;Data analysis tool&#39;</span>, <span style="color:#ae81ff">149.99</span>])
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Sample file &#39;</span><span style="color:#e6db74">{</span>input_file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; created.&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Process the expense data</span>
</span></span><span style="display:flex;"><span>    expenses <span style="color:#f92672">=</span> load_expenses(input_file)
</span></span><span style="display:flex;"><span>    categories <span style="color:#f92672">=</span> categorize_expenses(expenses)
</span></span><span style="display:flex;"><span>    totals <span style="color:#f92672">=</span> calculate_category_totals(categories)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Generate the report</span>
</span></span><span style="display:flex;"><span>    output_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;expense_report.txt&#39;</span>
</span></span><span style="display:flex;"><span>    generate_expense_report(expenses, categories, totals, output_file)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Expense report generated: </span><span style="color:#e6db74">{</span>output_file<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>This script demonstrates:</p>
<ul>
<li>Function definitions with docstrings</li>
<li>File I/O with the <code>with</code> statement</li>
<li>CSV processing</li>
<li>Module imports and usage</li>
<li>Error handling</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Functions, modules, and file I/O form the backbone of most Python applications, especially for financial tasks. By mastering these concepts, you&rsquo;ll be well-equipped to build tools for financial analysis, reporting, and automation.</p>
<p>In the next post, we&rsquo;ll explore virtual environments and package management, which will help you manage dependencies for larger projects.</p>
<p><strong>Practice Exercise:</strong> Try extending the expense analyser to calculate monthly trends or generate a simple visualisation of spending by category. This will help reinforce the concepts we&rsquo;ve covered while building something useful for your financial toolkit.</p>
]]></content:encoded></item></channel></rss>